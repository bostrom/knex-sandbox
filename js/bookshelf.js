!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Bookshelf=t()}}(function(){var t,e,r;return function n(t,e,r){function i(s,a){if(!e[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=e[s]={exports:{}};t[s][0].call(c.exports,function(e){var r=t[s][1][e];return i(r?r:e)},c,c.exports,n,t,e,r)}return e[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e){var r=function(){return r.initialize.apply(null,arguments)};r.initialize=function(e){function r(){c.apply(this,arguments)}var n={VERSION:"0.7.9"},i=t("lodash"),o=t("inherits"),s=t("semver"),a=t("./lib/base/events"),u=t("./lib/model"),l=t("./lib/collection"),c=t("./lib/relation"),h=t("./lib/errors");i.isPlainObject(e)&&(console.warn("Initializing Bookshelf with a config object is deprecated, please pass an initialized knex.js instance."),e=t("knex")(e));var f=">=0.6.10";if(!s.satisfies(e.VERSION,f))throw new Error("The knex version is "+e.VERSION+" which does not satisfy the Bookshelf's requirement "+f);var p=n.Model=function(){u.apply(this,arguments)},d=n.Collection=function(){l.apply(this,arguments)};return o(p,u),o(d,l),i.extend(p,u),i.extend(d,l),p.prototype._builder=d.prototype._builder=function(t){var r=e(t),n=this;return r.on("query",function(t){n.trigger("query",t)})},d.prototype.model=p,p.prototype.Collection=d,o(r,c),r.prototype.Model=p,r.prototype.Collection=d,p.prototype._relation=function(t,e,n){if("morphTo"!==t&&!i.isFunction(e))throw new Error("A valid target model must be defined for the "+i.result(this,"tableName")+" "+t+" relation");return new r(t,e,n)},p.collection=function(t,e){return new d(t||[],i.extend({},e,{model:this}))},i.extend(n,a,h,{transaction:function(){return this.knex.transaction.apply(this,arguments)},plugin:function(e,r){if(i.isString(e))try{t("./plugins/"+e)(this,r)}catch(n){t(e)(this,r)}else i.isArray(e)?i.each(e,function(t){this.plugin(t,r)},this):e(this,r);return this}}),n.knex=e,p.forge=d.forge=function(){var t=Object.create(this.prototype),e=this.apply(t,arguments);return Object(e)===e?e:t},["where","query"].forEach(function(t){p[t]=d[t]=function(){var e=this.forge();return e[t].apply(e,arguments)}}),p.fetchAll=function(t){return this.forge().fetchAll(t)},p.extend=d.extend=t("simple-extend"),n},e.exports=r},{"./lib/base/events":4,"./lib/collection":8,"./lib/errors":10,"./lib/model":12,"./lib/relation":13,inherits:76,knex:77,lodash:130,semver:131,"simple-extend":132}],2:[function(t,e){var r=t("lodash"),n=t("backbone"),i=t("./events"),o=t("./promise"),s=t("./model"),a=[],u=a.splice,l=function(t,e){if(e&&r.extend(this,r.pick(e,c)),this._reset(),this.initialize.apply(this,arguments),!r.isFunction(this.model))throw new Error("A valid `model` constructor must be defined for all collections.");t&&this.reset(t,r.extend({silent:!0},e))},c=["model","comparator"],h=["model","fetch","url","sync","create"],f={add:!0,remove:!0,merge:!0};r.extend(l.prototype,r.omit(n.Collection.prototype,h),i,{tableName:function(){return r.result(this.model.prototype,"tableName")},idAttribute:function(){return this.model.prototype.idAttribute},set:function(t,e){e=r.defaults({},e,f),e.parse&&(t=this.parse(t,e)),r.isArray(t)||(t=t?[t]:[]);var n,i,o,a,l,c,h=e.at,p=this.model,d=[],g=[],m={},v=e.add,y=e.merge,_=e.remove,b=v&&_?[]:!1;for(n=0,i=t.length;i>n;n++){if(l=t[n],o=l instanceof s?a=l:l[p.prototype.idAttribute],c=this.get(o))_&&(m[c.cid]=!0),y&&(l=l===a?a.attributes:l,e.parse&&(l=c.parse(l,e)),c.set(l,e));else if(v){if(!(a=this._prepareModel(l,e)))continue;d.push(a),a.on("all",this._onModelEvent,this),this._byId[a.cid]=a,null!=a.id&&(this._byId[a.id]=a)}b&&b.push(c||a)}if(_){for(n=0,i=this.length;i>n;++n)m[(a=this.models[n]).cid]||g.push(a);g.length&&this.remove(g,e)}if(d.length||b&&b.length)if(this.length+=d.length,null!=h)u.apply(this.models,[h,0].concat(d));else for(b?this.models.length=0:b=d,n=0,i=b.length;i>n;++n)this.models.push(b[n]);if(e.silent)return this;for(n=0,i=d.length;i>n;n++)(a=d[n]).trigger("add",a,this,e);return this},_prepareModel:function(t,e){return t instanceof s?t:new this.model(t,e)},mapThen:function(t,e){return o.bind(e).thenReturn(this.models).map(t)},invokeThen:function(){return o.all(this.invoke.apply(this,arguments))},reduceThen:function(t,e,r){return o.bind(r).thenReturn(this.models).reduce(t,e).bind()},fetch:function(){return o.rejected("The fetch method has not been implemented")}});l.extend=t("simple-extend"),e.exports=l},{"./events":4,"./model":5,"./promise":6,backbone:15,lodash:130,"simple-extend":132}],3:[function(t,e){function r(t,e,r){this.parent=t,this.parentResponse=e,this.target=r}var n=t("lodash"),i=(t("backbone"),t("./promise"));n.extend(r.prototype,{fetch:i.method(function(t){var e,r,s,a=this.target,u=this.handled={},l=this.prepWithRelated(t.withRelated),c={};a._isEager=!0;for(var h in l){if(r=h.split("."),e=r[0],r.length>1){var f={};c[e]||(c[e]=[]),f[r.slice(1).join(".")]=l[h],c[e].push(f)}if(!u[e]){if(s=a[e](),!s)throw new Error(e+" is not defined on the model.");u[e]=s}}delete a._isEager;var p=[];for(e in u)p.push(this.eagerFetch(e,u[e],n.extend({},t,{isEager:!0,withRelated:c[e],_beforeFn:l[e]||o})));return i.all(p).yield(this.parentResponse)}),prepWithRelated:function(t){n.isArray(t)||(t=[t]);for(var e={},r=0,i=t.length;i>r;r++){var s=t[r];n.isString(s)?e[s]=o:n.extend(e,s)}return e},pushModels:function(t,e,r){for(var n=this.parent,i=e.relatedData,o=[],s=0,a=r.length;a>s;s++)o.push(i.createModel(r[s]));return i.eagerPair(t,o,n)}});var o=function(){};e.exports=r},{"./promise":6,backbone:15,lodash:130}],4:[function(t,e){var r=t("./promise"),n=t("backbone"),i=t("trigger-then"),o=t("lodash");n.Events.once=function(t,e,r){var n=this,i=o.once(function(){return n.off(t,i),e.apply(this,arguments)});return i._callback=e,this.on(t,i,r)},i(n,r),e.exports=n.Events},{"./promise":6,backbone:15,lodash:130,"trigger-then":133}],5:[function(t,e){var r=t("lodash"),n=t("backbone"),i=t("./events"),o=t("./promise"),s=["changedAttributes","isValid","validationError","save","sync","fetch","destroy","url","urlRoot","_validate"],a=["tableName","hasTimestamps"],u=function(t,e){var n=t||{};e||(e={}),this.attributes=Object.create(null),this._reset(),this.relations={},this.cid=r.uniqueId("c"),e&&(r.extend(this,r.pick(e,a)),e.parse&&(n=this.parse(n,e)||{})),this.set(n,e),this.initialize.apply(this,arguments)};r.extend(u.prototype,r.omit(n.Model.prototype,s),i,{set:function(t,e,n){if(null==t)return this;var i;"object"==typeof t?(i=t,n=e):(i={})[t]=e,n||(n={});var o=!1,s=n.unset,a=this.attributes,u=this._previousAttributes;this.idAttribute in i&&(this.id=i[this.idAttribute]);for(var l in i)e=i[l],r.isEqual(u[l],e)?delete this.changed[l]:(this.changed[l]=e,r.isEqual(a[l],e)||(o=!0)),s?delete a[l]:a[l]=e;return o&&!n.silent&&this.trigger("change",this,n),this},toJSON:function(t){var e=r.extend({},this.attributes);if(t&&t.shallow)return e;var n=this.relations;for(var i in n){var o=n[i];e[i]=o.toJSON?o.toJSON(t):o}if(t&&t.omitPivot)return e;if(this.pivot){var s=this.pivot.attributes;for(i in s)e["_pivot_"+i]=s[i]}return e},parse:function(t){return t},format:function(t){return t},related:function(t){return this.relations[t]||(this[t]?this.relations[t]=this[t]():void 0)},clone:function(){var t=new this.constructor(this.attributes),e=this.relations;for(var n in e)t.relations[n]=e[n].clone();return t._previousAttributes=r.clone(this._previousAttributes),t.changed=r.clone(this.changed),t},timestamp:function(t){var e=new Date,n=r.isArray(this.hasTimestamps)?this.hasTimestamps:["created_at","updated_at"],i={};return n[0]&&(this.isNew(t)?t&&"update"===t.method||(i[n[0]]=e):t&&"insert"===t.method&&(i[n[0]]=e)),n[1]&&(i[n[1]]=e),i},_reset:function(){return this._previousAttributes=r.extend(Object.create(null),this.attributes),this.changed=Object.create(null),this},fetch:function(){},save:function(){},destroy:o.method(function(t){t=t?r.clone(t):{};var e=this.sync(t);return t.query=e.query,o.bind(this).then(function(){return this.triggerThen("destroying",this,t)}).then(function(){return e.del()}).then(function(e){return this.clear(),this.triggerThen("destroyed",this,e,t)}).then(this._reset)})}),u.extend=t("simple-extend"),e.exports=u},{"./events":4,"./promise":6,backbone:15,lodash:130,"simple-extend":132}],6:[function(t,e){var r=t("bluebird/js/main/promise")();r.prototype.yield=r.prototype.return,r.prototype.ensure=r.prototype.lastly,r.prototype.otherwise=r.prototype.caught,r.prototype.exec=r.prototype.nodeify,r.resolve=r.fulfilled,r.reject=r.rejected,e.exports=r},{"bluebird/js/main/promise":35}],7:[function(t,e){function r(t,e,r){this.type=t,(this.target=e)&&(this.targetTableName=n.result(e.prototype,"tableName"),this.targetIdAttribute=n.result(e.prototype,"idAttribute")),n.extend(this,r)}var n=t("lodash"),i=t("backbone"),o=t("./collection");n.extend(r.prototype,{instance:function(t,e,r){return new this.constructor(t,e,r)},createModel:function(t){return this.target.prototype instanceof o?new this.target.prototype.model(t)._reset():new this.target(t)._reset()},eagerPair:function(){}}),r.extend=i.Model.extend,e.exports=r},{"./collection":2,backbone:15,lodash:130}],8:[function(t,e){function r(){l.apply(this,arguments)}var n=t("lodash"),i=t("inherits"),o=t("./sync"),s=t("./helpers"),a=t("./eager"),u=t("./errors"),l=t("./base/collection"),c=t("./base/promise");i(r,l),r.EmptyError=u.EmptyError,n.extend(r.prototype,{through:function(t,e,r){return this.relatedData.through(this,t,{throughForeignKey:e,otherKey:r})},fetch:c.method(function(t){return t=t?n.clone(t):{},this.sync(t).select().bind(this).tap(function(e){if(!e||0===e.length){if(t.require)throw new u.EmptyError("EmptyResponse");return c.reject(null)}}).tap(this._handleResponse).tap(function(e){return t.withRelated?this._handleEager(e,n.omit(t,"columns")):void 0}).tap(function(e){return this.triggerThen("fetched",this,e,t)}).catch(function(t){if(null!==t)throw t;this.reset([],{silent:!0})}).return(this)}),fetchOne:c.method(function(t){var e=new this.model;return e._knex=this.query().clone(),this.resetQuery(),this.relatedData&&(e.relatedData=this.relatedData),e.fetch(t)}),load:c.method(function(t,e){return n.isArray(t)||(t=[t]),e=n.extend({},e,{shallow:!0,withRelated:t}),new a(this.models,this.toJSON(e),new this.model).fetch(e).return(this)}),create:c.method(function(t,e){e=e?n.clone(e):{};var r=this.relatedData;return t=this._prepareModel(t,e),this._knex&&(t._knex=this._knex,this.resetQuery()),s.saveConstraints(t,r).save(null,e).bind(this).then(function(){return r&&("belongsToMany"===r.type||r.isThrough())?this.attach(t,n.omit(e,"query")):void 0}).then(function(){this.add(t,e)}).return(t)}),resetQuery:function(){return this._knex=null,this},query:function(){return s.query(this,n.toArray(arguments))},sync:function(t){return new o(this,t)},_handleResponse:function(t){var e=this.relatedData;this.set(t,{silent:!0,parse:!0}).invoke("_reset"),e&&e.isJoined()&&e.parsePivot(this.models)},_handleEager:function(t,e){return new a(this.models,t,new this.model).fetch(e)}}),e.exports=r},{"./base/collection":2,"./base/promise":6,"./eager":9,"./errors":10,"./helpers":11,"./sync":14,inherits:76,lodash:130}],9:[function(t,e){function r(){a.apply(this,arguments)}var n=t("lodash"),i=t("inherits"),o=t("./helpers"),s=t("./base/promise"),a=t("./base/eager");i(r,a),n.extend(r.prototype,{eagerFetch:s.method(function(t,e,r){var i=e.relatedData;if(null!==i.parentFk)return"morphTo"===i.type?this.morphToFetch(t,i,r):e.sync(n.extend(r,{parentResponse:this.parentResponse})).select().bind(this).tap(function(i){return this._eagerLoadHelper(i,t,e,n.omit(r,"parentResponse"))})}),morphToFetch:s.method(function(t,e,r){var i=n.groupBy(this.parent,function(t){var r=e.columnNames&&e.columnNames[0]?e.columnNames[0]:e.morphName+"_type";return t.get(r)}),a=n.reduce(i,function(s,a,u){var l=o.morphCandidate(e.candidates,u),c=new l,h=e.columnNames&&e.columnNames[1]?e.columnNames[1]:e.morphName+"_id";return s.push(c.query("whereIn",n.result(c,"idAttribute"),n.uniq(n.invoke(i[u],"get",h))).sync(r).select().bind(this).tap(function(n){return this._eagerLoadHelper(n,t,{relatedData:e.instance("morphTo",l,{morphName:e.morphName,columnNames:e.columnNames})},r)})),s},[],this);return s.all(a).then(function(t){return n.flatten(t)})}),_eagerLoadHelper:function(t,e,i,o){var s=this.pushModels(e,i,t),a=i.relatedData;if(t.length>0&&o.withRelated){var u=a.createModel();if("morphTo"===a.type){var l=this._filterRelated(u,o);if(0===l.length)return;o=n.extend({},o,{withRelated:l})}return new r(s,t,u).fetch(o).return(t)}},_filterRelated:function(t,e){return n.reduce(e.withRelated,function(e,r){for(var i in r){var o=i.split(".")[0];n.isFunction(t[o])&&e.push(r)}return e},[])}}),e.exports=r},{"./base/eager":3,"./base/promise":6,"./helpers":11,inherits:76,lodash:130}],10:[function(t,e){var r=t("create-error");e.exports={NotFoundError:r("NotFoundError"),EmptyError:r("EmptyError")}},{"create-error":74}],11:[function(t,e){var r=t("lodash");e.exports={saveConstraints:function(t,e){var r={};return e&&e.type&&"belongsToMany"!==e.type&&"belongsTo"!==e.type&&(r[e.key("foreignKey")]=e.parentFk||t.get(e.key("foreignKey")),e.isMorph()&&(r[e.key("morphKey")]=e.key("morphValue"))),t.set(r)},morphCandidate:function(t,e){var n=r.find(t,function(t){return r.result(t.prototype,"tableName")===e});if(!n)throw new Error("The target polymorphic model was not found");return n},query:function(t,e){if(t._knex=t._knex||t._builder(r.result(t,"tableName")),0===e.length)return t._knex;var n=e[0];if(r.isFunction(n))n.call(t._knex,t._knex);else if(r.isObject(n))for(var i in n){var o=r.isArray(n[i])?n[i]:[n[i]];t._knex[i].apply(t._knex,o)}else t._knex[n].apply(t._knex,e.slice(1));return t}}},{lodash:130}],12:[function(t,e){function r(){l.apply(this,arguments)}var n=t("lodash"),i=t("inherits"),o=t("./sync"),s=t("./helpers"),a=t("./eager"),u=t("./errors"),l=t("./base/model"),c=t("./base/promise");i(r,l),r.NotFoundError=u.NotFoundError,n.extend(r.prototype,{hasOne:function(t,e){return this._relation("hasOne",t,{foreignKey:e}).init(this)},hasMany:function(t,e){return this._relation("hasMany",t,{foreignKey:e}).init(this)},belongsTo:function(t,e){return this._relation("belongsTo",t,{foreignKey:e}).init(this)},belongsToMany:function(t,e,r,n){return this._relation("belongsToMany",t,{joinTableName:e,foreignKey:r,otherKey:n}).init(this)},morphOne:function(t,e,r,n){return this._morphOneOrMany(t,e,r,n,"morphOne")},morphMany:function(t,e,r,n){return this._morphOneOrMany(t,e,r,n,"morphMany")},morphTo:function(t){var e,r;if(!n.isString(t))throw new Error("The `morphTo` name must be specified.");return n.isArray(arguments[1])?(e=arguments[1],r=n.rest(arguments,2)):(e=null,r=n.rest(arguments)),this._relation("morphTo",null,{morphName:t,columnNames:e,candidates:r}).init(this)},through:function(t,e,r){return this.relatedData.through(this,t,{throughForeignKey:e,otherKey:r})},fetch:c.method(function(t){return t=t?n.clone(t):{},this.sync(t).first().bind(this).tap(function(e){if(!e||0===e.length){if(t.require)throw new u.NotFoundError("EmptyResponse");return c.reject(null)}}).tap(this._handleResponse).tap(function(e){return t.withRelated?this._handleEager(e,n.omit(t,"columns")):void 0}).tap(function(e){return this.triggerThen("fetched",this,e,t)}).return(this).catch(function(t){if(null===t)return t;throw t})}),fetchAll:function(t){var e=this.constructor.collection();e._knex=this.query().clone(),this.resetQuery(),this.relatedData&&(e.relatedData=this.relatedData);var r=this;return e.on("fetching",function(t,e,n){return r.triggerThen("fetching:collection",t,e,n)}).on("fetched",function(t,e,n){return r.triggerThen("fetched:collection",t,e,n)}).fetch(t)},load:c.method(function(t,e){return c.bind(this).then(function(){return[this.format(n.extend(Object.create(null),this.attributes))]}).then(function(r){return this._handleEager(r,n.extend({},e,{shallow:!0,withRelated:n.isArray(t)?t:[t]}))}).return(this)}),save:c.method(function(t,e,r){var i;return null==t||"object"==typeof t?(i=t||{},r=n.clone(e)||{}):((i={})[t]=e,r=r?n.clone(r):{}),c.bind(this).then(function(){return this.isNew(r)}).then(function(t){this.hasTimestamps&&n.extend(i,this.timestamp(r)),r.method=(r.method||(t?"insert":"update")).toLowerCase();var e=r.method,o=i;if("insert"===e||r.defaults){var a=n.result(this,"defaults");a&&(o=n.extend({},a,this.attributes,o))}this.set(o,{silent:!0}),this.relatedData&&"morphTo"!==this.relatedData.type&&s.saveConstraints(this,this.relatedData);var u=this.sync(r);return r.query=u.query,this.triggerThen("insert"===e?"creating saving":"updating saving",this,i,r).bind(this).then(function(){return u[r.method]("update"===e&&r.patch?i:this.attributes)}).then(function(t){if("insert"===e&&null==this.id)this.attributes[this.idAttribute]=this.id=t[0];else if("update"===e&&0===t)throw new Error('No rows were affected in the update, did you mean to pass the {method: "insert"} option?');return r.previousAttributes=this._previousAttributes,this._reset(),this.triggerThen("insert"===e?"created saved":"updated saved",this,t,r)})}).return(this)}),resetQuery:function(){return this._knex=null,this},query:function(){return s.query(this,n.toArray(arguments))},where:function(){var t=n.toArray(arguments);return this.query.apply(this,["where"].concat(t))},sync:function(t){return new o(this,t)},_morphOneOrMany:function(t,e,r,i,o){if(n.isArray(r)||(i=r,r=null),!e||!t)throw new Error("The polymorphic `name` and `Target` are required.");return this._relation(o,t,{morphName:e,morphValue:i,columnNames:r}).init(this)},_handleResponse:function(t){var e=this.relatedData;this.set(this.parse(t[0]),{silent:!0})._reset(),e&&e.isJoined()&&e.parsePivot([this])},_handleEager:function(t,e){return new a([this],t,this).fetch(e)}}),e.exports=r},{"./base/model":5,"./base/promise":6,"./eager":9,"./errors":10,"./helpers":11,"./sync":14,inherits:76,lodash:130}],13:[function(t,e){function r(){u.apply(this,arguments)}var n=t("lodash"),i=t("inherits"),o=t("inflection"),s=t("./helpers"),a=t("./base/model"),u=t("./base/relation"),l=t("./base/promise"),c=[].push;i(r,u),n.extend(r.prototype,{init:function(t){if(this.parentId=t.id,this.parentTableName=n.result(t,"tableName"),this.parentIdAttribute=n.result(t,"idAttribute"),this.isInverse()){var e=t.format(n.clone(t.attributes));"morphTo"!==this.type||t._isEager||(this.target=s.morphCandidate(this.candidates,e[this.key("morphKey")]),this.targetTableName=n.result(this.target.prototype,"tableName"),this.targetIdAttribute=n.result(this.target.prototype,"idAttribute")),this.parentFk=e[this.key("foreignKey")]}else this.parentFk=t.id;var r=this.target?this.relatedInstance():{};return r.relatedData=this,"belongsToMany"===this.type&&n.extend(r,f),r},through:function(t,e,r){var i=this.type;if("hasOne"!==i&&"hasMany"!==i&&"belongsToMany"!==i&&"belongsTo"!==i)throw new Error("`through` is only chainable from `hasOne`, `belongsTo`, `hasMany`, or `belongsToMany`");return this.throughTarget=e,this.throughTableName=n.result(e.prototype,"tableName"),this.throughIdAttribute=n.result(e.prototype,"idAttribute"),"belongsTo"===this.type&&(this.parentFk=this.parentId),n.extend(this,r),n.extend(t,f),"belongsToMany"===this.type&&(this.foreignKey=this.throughForeignKey),t},key:function(t){var e;if(this[t])return this[t];if("otherKey"===t)return this[t]=h(this.targetTableName)+"_"+this.targetIdAttribute;if("throughForeignKey"===t)return this[t]=h(this.joinTable())+"_"+this.throughIdAttribute;if("foreignKey"===t)return"morphTo"===this.type?(e=this.columnNames&&this.columnNames[1]?this.columnNames[1]:this.morphName+"_id",this[t]=e):"belongsTo"===this.type?this[t]=h(this.targetTableName)+"_"+this.targetIdAttribute:this.isMorph()?(e=this.columnNames&&this.columnNames[1]?this.columnNames[1]:this.morphName+"_id",this[t]=e):this[t]=h(this.parentTableName)+"_"+this.parentIdAttribute;if("morphKey"===t){var r=this.columnNames&&this.columnNames[0]?this.columnNames[0]:this.morphName+"_type";return this[t]=r}return"morphValue"===t?this[t]=this.parentTableName||this.targetTableName:void 0},selectConstraints:function(t,e){var r=e.parentResponse;this.isJoined()&&this.joinClauses(t),e._beforeFn&&e._beforeFn.call(t,t),n.isArray(e.columns)&&t.columns(e.columns);var i=n.findWhere(t._statements,{grouping:"columns"});i&&0!==i.length||t.column(this.targetTableName+".*"),this.isJoined()&&this.joinColumns(t),this.isSingle()&&!r&&t.limit(1),this.whereClauses(t,r)},joinColumns:function(t){var e=[],r=this.joinTable();this.isThrough()&&e.push(this.throughIdAttribute),e.push(this.key("foreignKey")),"belongsToMany"===this.type&&e.push(this.key("otherKey")),c.apply(e,this.pivotColumns),t.columns(n.map(e,function(t){return r+"."+t+" as _pivot_"+t}))},joinClauses:function(t){var e=this.joinTable();if("belongsTo"===this.type||"belongsToMany"===this.type){var r=this.key("belongsTo"===this.type?"foreignKey":"otherKey");t.join(e,e+"."+r,"=",this.targetTableName+"."+this.targetIdAttribute),"belongsTo"===this.type&&t.join(this.parentTableName,e+"."+this.throughIdAttribute,"=",this.parentTableName+"."+this.key("throughForeignKey"))}else t.join(e,e+"."+this.throughIdAttribute,"=",this.targetTableName+"."+this.key("throughForeignKey"))},whereClauses:function(t,e){var r;if(this.isJoined()){var n="belongsTo"===this.type?this.parentTableName:this.joinTable();r=n+"."+("belongsTo"===this.type?this.parentIdAttribute:this.key("foreignKey"))}else r=this.targetTableName+"."+(this.isInverse()?this.targetIdAttribute:this.key("foreignKey"));t[e?"whereIn":"where"](r,e?this.eagerKeys(e):this.parentFk),this.isMorph()&&t.where(this.targetTableName+"."+this.key("morphKey"),this.key("morphValue"))},eagerKeys:function(t){var e=this.isInverse()&&!this.isThrough()?this.key("foreignKey"):this.parentIdAttribute;return n.uniq(n.pluck(t,e))},joinTable:function(){return this.isThrough()?this.throughTableName:this.joinTableName||[this.parentTableName,this.targetTableName].sort().join("_")},relatedInstance:function(t){t=t||[];var e=this.target;if(this.isSingle()){if(!(e.prototype instanceof a))throw new Error("The `"+this.type+"` related object must be a Bookshelf.Model");return t[0]||new e}return e.prototype instanceof a&&(e=this.Collection.extend({model:e})),new e(t,{parse:!0})},eagerPair:function(t,e,r){var i;"morphTo"===this.type&&(r=n.filter(r,function(t){return t.get(this.key("morphKey"))===this.key("morphValue")},this)),this.isJoined()&&(e=this.parsePivot(e));for(var o=n.groupBy(e,function(t){return t.pivot?this.isInverse()&&this.isThrough()?t.pivot.id:t.pivot.get(this.key("foreignKey")):this.isInverse()?t.id:t.get(this.key("foreignKey"))},this),s=0,a=r.length;a>s;s++){i=r[s];var u;if(this.isInverse()){var l=i.format(n.extend(Object.create(null),i.attributes));u=this.isThrough()?l[this.key("throughForeignKey")]:l[this.key("foreignKey")]}else u=i.id;var c=i.relations[t]=this.relatedInstance(o[u]);c.relatedData=this,this.isJoined()&&n.extend(c,f)}for(s=0,a=e.length;a>s;s++)i=e[s],i.attributes=i.parse(i.attributes);return e},parsePivot:function(t){var e=this.throughTarget;return n.map(t,function(t){var r,i={},o={},s=t.attributes;e&&(r=new e);for(var a in s)0===a.indexOf("_pivot_")?i[a.slice(7)]=s[a]:o[a]=s[a];return t.attributes=o,n.isEmpty(i)||(t.pivot=r?r.set(i,{silent:!0}):new this.Model(i,{tableName:this.joinTable()})),t},this)},isThrough:function(){return null!=this.throughTarget},isJoined:function(){return"belongsToMany"===this.type||this.isThrough()},isMorph:function(){return"morphOne"===this.type||"morphMany"===this.type},isSingle:function(){var t=this.type;return"hasOne"===t||"belongsTo"===t||"morphOne"===t||"morphTo"===t},isInverse:function(){return"belongsTo"===this.type||"morphTo"===this.type},withPivot:function(t){n.isArray(t)||(t=[t]),this.pivotColumns||(this.pivotColumns=[]),c.apply(this.pivotColumns,t)}});var h=function(){var t=Object.create(null);return function(e){return e in t?t[e]:t[e]=o.singularize(e)}}(),f={attach:function(t,e){return l.bind(this).then(function(){return this.triggerThen("attaching",this,t,e)}).then(function(){return this._handler("insert",t,e)}).then(function(t){return this.triggerThen("attached",this,t,e)})},detach:function(t,e){return l.bind(this).then(function(){return this.triggerThen("detaching",this,t,e)}).then(function(){return this._handler("delete",t,e)}).then(function(t){return this.triggerThen("detached",this,t,e)})},updatePivot:function(t,e){return this._handler("update",t,e)},withPivot:function(t){return this.relatedData.withPivot(t),this},_handler:l.method(function(t,e,r){var i=[];if(void 0==e){if("insert"===t)return l.resolve(this);"delete"===t&&i.push(this._processPivot(t,null,r))}n.isArray(e)||(e=e?[e]:[]);for(var o=0,s=e.length;s>o;o++)i.push(this._processPivot(t,e[o],r));return l.all(i).yield(this)}),_processPivot:l.method(function(t,e,r){var i={},o=this.relatedData,u=this._builder(o.joinTable());r&&r.query&&s.query.call(null,{_knex:u},[r.query]),i[o.key("foreignKey")]=o.parentFk,n.isObject(e)?e instanceof a?i[o.key("otherKey")]=e.id:"update"!==t&&n.extend(i,e):e&&(i[o.key("otherKey")]=e),r&&(r.transacting&&u.transacting(r.transacting),r.debug&&u.debug());var l=this;return"delete"===t?u.where(i).del().then(function(){var t;return e?void((t=l.get(i[o.key("otherKey")]))&&l.remove(t)):l.reset()}):"update"===t?u.where(i).update(e).then(function(t){if(r&&r.require===!0&&0===t)throw new Error("No rows were updated");return t}):u.insert(i).then(function(){l.add(e)})})};e.exports=r},{"./base/model":5,"./base/promise":6,"./base/relation":7,"./helpers":11,inflection:75,inherits:76,lodash:130}],14:[function(t,e){var r=t("lodash"),n=t("./base/promise"),i=function(t,e){e=e||{},this.query=t.query(),this.syncing=t.resetQuery(),this.options=e,e.debug&&this.query.debug(),e.transacting&&this.query.transacting(e.transacting)};r.extend(i.prototype,{prefixFields:function(t){var e=this.syncing.tableName,r={};for(var n in t)r[e+"."+n]=t[n];return r},first:n.method(function(){return this.query.where(this.prefixFields(this.syncing.format(r.extend(Object.create(null),this.syncing.attributes)))).limit(1),this.select()}),select:n.method(function(){var t,e=this.options,i=this.syncing.relatedData,o=this.query;return i?i.selectConstraints(o,e):(t=e.columns,e._beforeFn&&e._beforeFn.call(o,o),r.isArray(t)||(t=t?[t]:[r.result(this.syncing,"tableName")+".*"])),e.query=o,n.bind(this).then(function(){return this.syncing.triggerThen("fetching",this.syncing,t,e)}).then(function(){return o.select(t)})}),insert:n.method(function(){var t=this.syncing;return this.query.insert(t.format(r.extend(Object.create(null),t.attributes)),t.idAttribute)}),update:n.method(function(t){var e=this.syncing,n=this.query;if(null!=e.id&&n.where(e.idAttribute,e.id),0===r.where(n._statements,{grouping:"where"}).length)throw new Error('A model cannot be updated without a "where" clause or an idAttribute.');return n.update(e.format(r.extend(Object.create(null),t)))}),del:n.method(function(){var t=this.query,e=this.syncing;if(null!=e.id&&t.where(e.idAttribute,e.id),0===r.where(t._statements,{grouping:"where"}).length)throw new Error('A model cannot be destroyed without a "where" clause or an idAttribute.');return this.query.del()})}),e.exports=i},{"./base/promise":6,lodash:130}],15:[function(t,e,r){(function(){{var e,n=this,i=n.Backbone,o=[],s=(o.push,o.slice);o.splice}e="undefined"!=typeof r?r:n.Backbone={},e.VERSION="1.1.0";var a=n._;a||"undefined"==typeof t||(a=t("underscore")),e.$=n.jQuery||n.Zepto||n.ender||n.$,e.noConflict=function(){return n.Backbone=i,this},e.emulateHTTP=!1,e.emulateJSON=!1;var u=e.Events={on:function(t,e,r){if(!c(this,"on",t,[e,r])||!e)return this;this._events||(this._events={});var n=this._events[t]||(this._events[t]=[]);return n.push({callback:e,context:r,ctx:r||this}),this},once:function(t,e,r){if(!c(this,"once",t,[e,r])||!e)return this;var n=this,i=a.once(function(){n.off(t,i),e.apply(this,arguments)});return i._callback=e,this.on(t,i,r)},off:function(t,e,r){var n,i,o,s,u,l,h,f;if(!this._events||!c(this,"off",t,[e,r]))return this;if(!t&&!e&&!r)return this._events={},this;for(s=t?[t]:a.keys(this._events),u=0,l=s.length;l>u;u++)if(t=s[u],o=this._events[t]){if(this._events[t]=n=[],e||r)for(h=0,f=o.length;f>h;h++)i=o[h],(e&&e!==i.callback&&e!==i.callback._callback||r&&r!==i.context)&&n.push(i);n.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=s.call(arguments,1);if(!c(this,"trigger",t,e))return this;var r=this._events[t],n=this._events.all;return r&&h(r,e),n&&h(n,arguments),this},stopListening:function(t,e,r){var n=this._listeningTo;if(!n)return this;var i=!e&&!r;r||"object"!=typeof e||(r=this),t&&((n={})[t._listenId]=t);for(var o in n)t=n[o],t.off(e,r,this),(i||a.isEmpty(t._events))&&delete this._listeningTo[o];return this}},l=/\s+/,c=function(t,e,r,n){if(!r)return!0;if("object"==typeof r){for(var i in r)t[e].apply(t,[i,r[i]].concat(n));return!1}if(l.test(r)){for(var o=r.split(l),s=0,a=o.length;a>s;s++)t[e].apply(t,[o[s]].concat(n));return!1}return!0},h=function(t,e){var r,n=-1,i=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++n<i;)(r=t[n]).callback.call(r.ctx);return;case 1:for(;++n<i;)(r=t[n]).callback.call(r.ctx,o);return;case 2:for(;++n<i;)(r=t[n]).callback.call(r.ctx,o,s);return;case 3:for(;++n<i;)(r=t[n]).callback.call(r.ctx,o,s,a);return;default:for(;++n<i;)(r=t[n]).callback.apply(r.ctx,e)}},f={listenTo:"on",listenToOnce:"once"};a.each(f,function(t,e){u[e]=function(e,r,n){var i=this._listeningTo||(this._listeningTo={}),o=e._listenId||(e._listenId=a.uniqueId("l"));return i[o]=e,n||"object"!=typeof r||(n=this),e[t](r,n,this),this}}),u.bind=u.on,u.unbind=u.off,a.extend(e,u);var p=e.Model=function(t,e){var r=t||{};e||(e={}),this.cid=a.uniqueId("c"),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(r=this.parse(r,e)||{}),r=a.defaults({},r,a.result(this,"defaults")),this.set(r,e),this.changed={},this.initialize.apply(this,arguments)};a.extend(p.prototype,u,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return a.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return a.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,r){var n,i,o,s,u,l,c,h;if(null==t)return this;if("object"==typeof t?(i=t,r=e):(i={})[t]=e,r||(r={}),!this._validate(i,r))return!1;o=r.unset,u=r.silent,s=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=a.clone(this.attributes),this.changed={}),h=this.attributes,c=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]);for(n in i)e=i[n],a.isEqual(h[n],e)||s.push(n),a.isEqual(c[n],e)?delete this.changed[n]:this.changed[n]=e,o?delete h[n]:h[n]=e;if(!u){s.length&&(this._pending=!0);for(var f=0,p=s.length;p>f;f++)this.trigger("change:"+s[f],this,h[s[f]],r)}if(l)return this;if(!u)for(;this._pending;)this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,a.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var r in this.attributes)e[r]=void 0;return this.set(e,a.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!a.isEmpty(this.changed):a.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?a.clone(this.changed):!1;var e,r=!1,n=this._changing?this._previousAttributes:this.attributes;for(var i in t)a.isEqual(n[i],e=t[i])||((r||(r={}))[i]=e);return r},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return a.clone(this._previousAttributes)
},fetch:function(t){t=t?a.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,r=t.success;return t.success=function(n){return e.set(e.parse(n,t),t)?(r&&r(e,n,t),void e.trigger("sync",e,n,t)):!1},L(this,t),this.sync("read",this,t)},save:function(t,e,r){var n,i,o,s=this.attributes;if(null==t||"object"==typeof t?(n=t,r=e):(n={})[t]=e,r=a.extend({validate:!0},r),n&&!r.wait){if(!this.set(n,r))return!1}else if(!this._validate(n,r))return!1;n&&r.wait&&(this.attributes=a.extend({},s,n)),void 0===r.parse&&(r.parse=!0);var u=this,l=r.success;return r.success=function(t){u.attributes=s;var e=u.parse(t,r);return r.wait&&(e=a.extend(n||{},e)),a.isObject(e)&&!u.set(e,r)?!1:(l&&l(u,t,r),void u.trigger("sync",u,t,r))},L(this,r),i=this.isNew()?"create":r.patch?"patch":"update","patch"===i&&(r.attrs=n),o=this.sync(i,this,r),n&&r.wait&&(this.attributes=s),o},destroy:function(t){t=t?a.clone(t):{};var e=this,r=t.success,n=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(i){(t.wait||e.isNew())&&n(),r&&r(e,i,t),e.isNew()||e.trigger("sync",e,i,t)},this.isNew())return t.success(),!1;L(this,t);var i=this.sync("delete",this,t);return t.wait||n(),i},url:function(){var t=a.result(this,"urlRoot")||a.result(this.collection,"url")||M();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},a.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=a.extend({},this.attributes,t);var r=this.validationError=this.validate(t,e)||null;return r?(this.trigger("invalid",this,r,a.extend(e,{validationError:r})),!1):!0}});var d=["keys","values","pairs","invert","pick","omit"];a.each(d,function(t){p.prototype[t]=function(){var e=s.call(arguments);return e.unshift(this.attributes),a[t].apply(a,e)}});var g=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,a.extend({silent:!0},e))},m={add:!0,remove:!0,merge:!0},v={add:!0,remove:!1};a.extend(g.prototype,u,{model:p,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,a.extend({merge:!1},e,v))},remove:function(t,e){var r=!a.isArray(t);t=r?[t]:a.clone(t),e||(e={});var n,i,o,s;for(n=0,i=t.length;i>n;n++)s=t[n]=this.get(t[n]),s&&(delete this._byId[s.id],delete this._byId[s.cid],o=this.indexOf(s),this.models.splice(o,1),this.length--,e.silent||(e.index=o,s.trigger("remove",s,this,e)),this._removeReference(s));return r?t[0]:t},set:function(t,e){e=a.defaults({},e,m),e.parse&&(t=this.parse(t,e));var r=!a.isArray(t);t=r?t?[t]:[]:a.clone(t);var n,i,o,s,u,l,c,h=e.at,f=this.model,d=this.comparator&&null==h&&e.sort!==!1,g=a.isString(this.comparator)?this.comparator:null,v=[],y=[],_={},b=e.add,w=e.merge,j=e.remove,x=!d&&b&&j?[]:!1;for(n=0,i=t.length;i>n;n++){if(u=t[n],o=u instanceof p?s=u:u[f.prototype.idAttribute],l=this.get(o))j&&(_[l.cid]=!0),w&&(u=u===s?s.attributes:u,e.parse&&(u=l.parse(u,e)),l.set(u,e),d&&!c&&l.hasChanged(g)&&(c=!0)),t[n]=l;else if(b){if(s=t[n]=this._prepareModel(u,e),!s)continue;v.push(s),s.on("all",this._onModelEvent,this),this._byId[s.cid]=s,null!=s.id&&(this._byId[s.id]=s)}x&&x.push(l||s)}if(j){for(n=0,i=this.length;i>n;++n)_[(s=this.models[n]).cid]||y.push(s);y.length&&this.remove(y,e)}if(v.length||x&&x.length)if(d&&(c=!0),this.length+=v.length,null!=h)for(n=0,i=v.length;i>n;n++)this.models.splice(h+n,0,v[n]);else{x&&(this.models.length=0);var E=x||v;for(n=0,i=E.length;i>n;n++)this.models.push(E[n])}if(c&&this.sort({silent:!0}),!e.silent){for(n=0,i=v.length;i>n;n++)(s=v[n]).trigger("add",s,this,e);(c||x&&x.length)&&this.trigger("sort",this,e)}return r?t[0]:t},reset:function(t,e){e||(e={});for(var r=0,n=this.models.length;n>r;r++)this._removeReference(this.models[r]);return e.previousModels=this.models,this._reset(),t=this.add(t,a.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,a.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return this.add(t,a.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(){return s.apply(this.models,arguments)},get:function(t){return null==t?void 0:this._byId[t.id]||this._byId[t.cid]||this._byId[t]},at:function(t){return this.models[t]},where:function(t,e){return a.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var r in t)if(t[r]!==e.get(r))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),a.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(a.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return a.invoke(this.models,"get",t)},fetch:function(t){t=t?a.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,r=this;return t.success=function(n){var i=t.reset?"reset":"set";r[i](n,t),e&&e(r,n,t),r.trigger("sync",r,n,t)},L(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?a.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var r=this,n=e.success;return e.success=function(t,e,i){i.wait&&r.add(t,i),n&&n(t,e,i)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof p)return t.collection||(t.collection=this),t;e=e?a.clone(e):{},e.collection=this;var r=new this.model(t,e);return r.validationError?(this.trigger("invalid",this,r.validationError,e),!1):r},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,r,n){("add"!==t&&"remove"!==t||r===this)&&("destroy"===t&&this.remove(e,n),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];a.each(y,function(t){g.prototype[t]=function(){var e=s.call(arguments);return e.unshift(this.models),a[t].apply(a,e)}});var _=["groupBy","countBy","sortBy"];a.each(_,function(t){g.prototype[t]=function(e,r){var n=a.isFunction(e)?e:function(t){return t.get(e)};return a[t](this.models,n,r)}});var b=e.View=function(t){this.cid=a.uniqueId("view"),t||(t={}),a.extend(this,a.pick(t,j)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,j=["model","collection","el","id","attributes","className","tagName","events"];a.extend(b.prototype,u,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,r){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],r!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=a.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var r=t[e];if(a.isFunction(r)||(r=this[t[e]]),r){var n=e.match(w),i=n[1],o=n[2];r=a.bind(r,this),i+=".delegateEvents"+this.cid,""===o?this.$el.on(i,r):this.$el.on(i,o,r)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(a.result(this,"el"),!1);else{var t=a.extend({},a.result(this,"attributes"));this.id&&(t.id=a.result(this,"id")),this.className&&(t["class"]=a.result(this,"className"));var r=e.$("<"+a.result(this,"tagName")+">").attr(t);this.setElement(r,!1)}}}),e.sync=function(t,r,n){var i=E[t];a.defaults(n||(n={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var o={type:i,dataType:"json"};if(n.url||(o.url=a.result(r,"url")||M()),null!=n.data||!r||"create"!==t&&"update"!==t&&"patch"!==t||(o.contentType="application/json",o.data=JSON.stringify(n.attrs||r.toJSON(n))),n.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),n.emulateHTTP&&("PUT"===i||"DELETE"===i||"PATCH"===i)){o.type="POST",n.emulateJSON&&(o.data._method=i);var s=n.beforeSend;n.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",i),s?s.apply(this,arguments):void 0}}"GET"===o.type||n.emulateJSON||(o.processData=!1),"PATCH"===o.type&&x&&(o.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var u=n.xhr=e.ajax(a.extend(o,n));return r.trigger("request",r,u,n),u};var x=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),E={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var k=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},T=/\((.*?)\)/g,R=/(\(\?)?:\w+/g,A=/\*\w+/g,C=/[\-{}\[\]+?.,\\\^$|#\s]/g;a.extend(k.prototype,u,{initialize:function(){},route:function(t,r,n){a.isRegExp(t)||(t=this._routeToRegExp(t)),a.isFunction(r)&&(n=r,r=""),n||(n=this[r]);var i=this;return e.history.route(t,function(o){var s=i._extractParameters(t,o);n&&n.apply(i,s),i.trigger.apply(i,["route:"+r].concat(s)),i.trigger("route",r,s),e.history.trigger("route",i,r,s)}),this},navigate:function(t,r){return e.history.navigate(t,r),this},_bindRoutes:function(){if(this.routes){this.routes=a.result(this,"routes");for(var t,e=a.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(C,"\\$&").replace(T,"(?:$1)?").replace(R,function(t,e){return e?t:"([^/]+)"}).replace(A,"(.*?)"),new RegExp("^"+t+"$")},_extractParameters:function(t,e){var r=t.exec(e).slice(1);return a.map(r,function(t){return t?decodeURIComponent(t):null})}});var S=e.History=function(){this.handlers=[],a.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},F=/^[#\/]|\s+$/g,N=/^\/+|\/+$/g,O=/msie [\w.]+/,I=/\/$/,P=/[?#].*$/;S.started=!1,a.extend(S.prototype,u,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var r=this.root.replace(I,"");t.indexOf(r)||(t=t.slice(r.length))}else t=this.getHash();return t.replace(F,"")},start:function(t){if(S.started)throw new Error("Backbone.history has already been started");S.started=!0,this.options=a.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var r=this.getFragment(),n=document.documentMode,i=O.exec(navigator.userAgent.toLowerCase())&&(!n||7>=n);this.root=("/"+this.root+"/").replace(N,"/"),i&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(r)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!i?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=r;var o=this.location,s=o.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&s&&o.hash&&(this.fragment=this.getHash().replace(F,""),this.history.replaceState({},document.title,this.root+this.fragment+o.search))}return this.options.silent?void 0:this.loadUrl()},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),S.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(t){return t=this.fragment=this.getFragment(t),a.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})},navigate:function(t,e){if(!S.started)return!1;e&&e!==!0||(e={trigger:!!e});var r=this.root+(t=this.getFragment(t||""));if(t=t.replace(P,""),this.fragment!==t){if(this.fragment=t,""===t&&"/"!==r&&(r=r.slice(0,-1)),this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,r);else{if(!this._wantsHashChange)return this.location.assign(r);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,r){if(r){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),e.history=new S;var q=function(t,e){var r,n=this;r=t&&a.has(t,"constructor")?t.constructor:function(){return n.apply(this,arguments)},a.extend(r,n,e);var i=function(){this.constructor=r};return i.prototype=n.prototype,r.prototype=new i,t&&a.extend(r.prototype,t),r.__super__=n.prototype,r};p.extend=g.extend=k.extend=b.extend=S.extend=q;var M=function(){throw new Error('A "url" property or function must be specified')},L=function(t,e){var r=e.error;e.error=function(n){r&&r(t,n,e),t.trigger("error",t,n,e)}}}).call(this)},{underscore:16}],16:[function(e,r,n){(function(){var e=this,i=e._,o=Array.prototype,s=Object.prototype,a=Function.prototype,u=o.push,l=o.slice,c=o.concat,h=s.toString,f=s.hasOwnProperty,p=Array.isArray,d=Object.keys,g=a.bind,m=function(t){return t instanceof m?t:this instanceof m?void(this._wrapped=t):new m(t)};"undefined"!=typeof n?("undefined"!=typeof r&&r.exports&&(n=r.exports=m),n._=m):e._=m,m.VERSION="1.7.0";var v=function(t,e,r){if(void 0===e)return t;switch(null==r?3:r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)};case 4:return function(r,n,i,o){return t.call(e,r,n,i,o)}}return function(){return t.apply(e,arguments)}};m.iteratee=function(t,e,r){return null==t?m.identity:m.isFunction(t)?v(t,e,r):m.isObject(t)?m.matches(t):m.property(t)},m.each=m.forEach=function(t,e,r){if(null==t)return t;e=v(e,r);var n,i=t.length;if(i===+i)for(n=0;i>n;n++)e(t[n],n,t);else{var o=m.keys(t);for(n=0,i=o.length;i>n;n++)e(t[o[n]],o[n],t)}return t},m.map=m.collect=function(t,e,r){if(null==t)return[];e=m.iteratee(e,r);for(var n,i=t.length!==+t.length&&m.keys(t),o=(i||t).length,s=Array(o),a=0;o>a;a++)n=i?i[a]:a,s[a]=e(t[n],n,t);return s};var y="Reduce of empty array with no initial value";m.reduce=m.foldl=m.inject=function(t,e,r,n){null==t&&(t=[]),e=v(e,n,4);var i,o=t.length!==+t.length&&m.keys(t),s=(o||t).length,a=0;if(arguments.length<3){if(!s)throw new TypeError(y);r=t[o?o[a++]:a++]}for(;s>a;a++)i=o?o[a]:a,r=e(r,t[i],i,t);return r},m.reduceRight=m.foldr=function(t,e,r,n){null==t&&(t=[]),e=v(e,n,4);var i,o=t.length!==+t.length&&m.keys(t),s=(o||t).length;if(arguments.length<3){if(!s)throw new TypeError(y);r=t[o?o[--s]:--s]}for(;s--;)i=o?o[s]:s,r=e(r,t[i],i,t);return r},m.find=m.detect=function(t,e,r){var n;return e=m.iteratee(e,r),m.some(t,function(t,r,i){return e(t,r,i)?(n=t,!0):void 0}),n},m.filter=m.select=function(t,e,r){var n=[];return null==t?n:(e=m.iteratee(e,r),m.each(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n)},m.reject=function(t,e,r){return m.filter(t,m.negate(m.iteratee(e)),r)},m.every=m.all=function(t,e,r){if(null==t)return!0;e=m.iteratee(e,r);var n,i,o=t.length!==+t.length&&m.keys(t),s=(o||t).length;for(n=0;s>n;n++)if(i=o?o[n]:n,!e(t[i],i,t))return!1;return!0},m.some=m.any=function(t,e,r){if(null==t)return!1;e=m.iteratee(e,r);var n,i,o=t.length!==+t.length&&m.keys(t),s=(o||t).length;for(n=0;s>n;n++)if(i=o?o[n]:n,e(t[i],i,t))return!0;return!1},m.contains=m.include=function(t,e){return null==t?!1:(t.length!==+t.length&&(t=m.values(t)),m.indexOf(t,e)>=0)},m.invoke=function(t,e){var r=l.call(arguments,2),n=m.isFunction(e);return m.map(t,function(t){return(n?e:t[e]).apply(t,r)})},m.pluck=function(t,e){return m.map(t,m.property(e))},m.where=function(t,e){return m.filter(t,m.matches(e))},m.findWhere=function(t,e){return m.find(t,m.matches(e))},m.max=function(t,e,r){var n,i,o=-1/0,s=-1/0;if(null==e&&null!=t){t=t.length===+t.length?t:m.values(t);for(var a=0,u=t.length;u>a;a++)n=t[a],n>o&&(o=n)}else e=m.iteratee(e,r),m.each(t,function(t,r,n){i=e(t,r,n),(i>s||i===-1/0&&o===-1/0)&&(o=t,s=i)});return o},m.min=function(t,e,r){var n,i,o=1/0,s=1/0;if(null==e&&null!=t){t=t.length===+t.length?t:m.values(t);for(var a=0,u=t.length;u>a;a++)n=t[a],o>n&&(o=n)}else e=m.iteratee(e,r),m.each(t,function(t,r,n){i=e(t,r,n),(s>i||1/0===i&&1/0===o)&&(o=t,s=i)});return o},m.shuffle=function(t){for(var e,r=t&&t.length===+t.length?t:m.values(t),n=r.length,i=Array(n),o=0;n>o;o++)e=m.random(0,o),e!==o&&(i[o]=i[e]),i[e]=r[o];return i},m.sample=function(t,e,r){return null==e||r?(t.length!==+t.length&&(t=m.values(t)),t[m.random(t.length-1)]):m.shuffle(t).slice(0,Math.max(0,e))},m.sortBy=function(t,e,r){return e=m.iteratee(e,r),m.pluck(m.map(t,function(t,r,n){return{value:t,index:r,criteria:e(t,r,n)}}).sort(function(t,e){var r=t.criteria,n=e.criteria;if(r!==n){if(r>n||void 0===r)return 1;if(n>r||void 0===n)return-1}return t.index-e.index}),"value")};var _=function(t){return function(e,r,n){var i={};return r=m.iteratee(r,n),m.each(e,function(n,o){var s=r(n,o,e);t(i,n,s)}),i}};m.groupBy=_(function(t,e,r){m.has(t,r)?t[r].push(e):t[r]=[e]}),m.indexBy=_(function(t,e,r){t[r]=e}),m.countBy=_(function(t,e,r){m.has(t,r)?t[r]++:t[r]=1}),m.sortedIndex=function(t,e,r,n){r=m.iteratee(r,n,1);for(var i=r(e),o=0,s=t.length;s>o;){var a=o+s>>>1;r(t[a])<i?o=a+1:s=a}return o},m.toArray=function(t){return t?m.isArray(t)?l.call(t):t.length===+t.length?m.map(t,m.identity):m.values(t):[]},m.size=function(t){return null==t?0:t.length===+t.length?t.length:m.keys(t).length},m.partition=function(t,e,r){e=m.iteratee(e,r);var n=[],i=[];return m.each(t,function(t,r,o){(e(t,r,o)?n:i).push(t)}),[n,i]},m.first=m.head=m.take=function(t,e,r){return null==t?void 0:null==e||r?t[0]:0>e?[]:l.call(t,0,e)},m.initial=function(t,e,r){return l.call(t,0,Math.max(0,t.length-(null==e||r?1:e)))},m.last=function(t,e,r){return null==t?void 0:null==e||r?t[t.length-1]:l.call(t,Math.max(t.length-e,0))},m.rest=m.tail=m.drop=function(t,e,r){return l.call(t,null==e||r?1:e)},m.compact=function(t){return m.filter(t,m.identity)};var b=function(t,e,r,n){if(e&&m.every(t,m.isArray))return c.apply(n,t);for(var i=0,o=t.length;o>i;i++){var s=t[i];m.isArray(s)||m.isArguments(s)?e?u.apply(n,s):b(s,e,r,n):r||n.push(s)}return n};m.flatten=function(t,e){return b(t,e,!1,[])},m.without=function(t){return m.difference(t,l.call(arguments,1))},m.uniq=m.unique=function(t,e,r,n){if(null==t)return[];m.isBoolean(e)||(n=r,r=e,e=!1),null!=r&&(r=m.iteratee(r,n));for(var i=[],o=[],s=0,a=t.length;a>s;s++){var u=t[s];if(e)s&&o===u||i.push(u),o=u;else if(r){var l=r(u,s,t);m.indexOf(o,l)<0&&(o.push(l),i.push(u))}else m.indexOf(i,u)<0&&i.push(u)}return i},m.union=function(){return m.uniq(b(arguments,!0,!0,[]))},m.intersection=function(t){if(null==t)return[];for(var e=[],r=arguments.length,n=0,i=t.length;i>n;n++){var o=t[n];if(!m.contains(e,o)){for(var s=1;r>s&&m.contains(arguments[s],o);s++);s===r&&e.push(o)}}return e},m.difference=function(t){var e=b(l.call(arguments,1),!0,!0,[]);return m.filter(t,function(t){return!m.contains(e,t)})},m.zip=function(t){if(null==t)return[];for(var e=m.max(arguments,"length").length,r=Array(e),n=0;e>n;n++)r[n]=m.pluck(arguments,n);return r},m.object=function(t,e){if(null==t)return{};for(var r={},n=0,i=t.length;i>n;n++)e?r[t[n]]=e[n]:r[t[n][0]]=t[n][1];return r},m.indexOf=function(t,e,r){if(null==t)return-1;var n=0,i=t.length;if(r){if("number"!=typeof r)return n=m.sortedIndex(t,e),t[n]===e?n:-1;n=0>r?Math.max(0,i+r):r}for(;i>n;n++)if(t[n]===e)return n;return-1},m.lastIndexOf=function(t,e,r){if(null==t)return-1;var n=t.length;for("number"==typeof r&&(n=0>r?n+r+1:Math.min(n,r+1));--n>=0;)if(t[n]===e)return n;return-1},m.range=function(t,e,r){arguments.length<=1&&(e=t||0,t=0),r=r||1;for(var n=Math.max(Math.ceil((e-t)/r),0),i=Array(n),o=0;n>o;o++,t+=r)i[o]=t;return i};var w=function(){};m.bind=function(t,e){var r,n;if(g&&t.bind===g)return g.apply(t,l.call(arguments,1));if(!m.isFunction(t))throw new TypeError("Bind must be called on a function");return r=l.call(arguments,2),n=function(){if(!(this instanceof n))return t.apply(e,r.concat(l.call(arguments)));w.prototype=t.prototype;var i=new w;w.prototype=null;var o=t.apply(i,r.concat(l.call(arguments)));return m.isObject(o)?o:i}},m.partial=function(t){var e=l.call(arguments,1);return function(){for(var r=0,n=e.slice(),i=0,o=n.length;o>i;i++)n[i]===m&&(n[i]=arguments[r++]);for(;r<arguments.length;)n.push(arguments[r++]);return t.apply(this,n)}},m.bindAll=function(t){var e,r,n=arguments.length;if(1>=n)throw new Error("bindAll must be passed function names");for(e=1;n>e;e++)r=arguments[e],t[r]=m.bind(t[r],t);return t},m.memoize=function(t,e){var r=function(n){var i=r.cache,o=e?e.apply(this,arguments):n;return m.has(i,o)||(i[o]=t.apply(this,arguments)),i[o]};return r.cache={},r},m.delay=function(t,e){var r=l.call(arguments,2);return setTimeout(function(){return t.apply(null,r)},e)},m.defer=function(t){return m.delay.apply(m,[t,1].concat(l.call(arguments,1)))},m.throttle=function(t,e,r){var n,i,o,s=null,a=0;r||(r={});var u=function(){a=r.leading===!1?0:m.now(),s=null,o=t.apply(n,i),s||(n=i=null)};return function(){var l=m.now();a||r.leading!==!1||(a=l);var c=e-(l-a);return n=this,i=arguments,0>=c||c>e?(clearTimeout(s),s=null,a=l,o=t.apply(n,i),s||(n=i=null)):s||r.trailing===!1||(s=setTimeout(u,c)),o}},m.debounce=function(t,e,r){var n,i,o,s,a,u=function(){var l=m.now()-s;e>l&&l>0?n=setTimeout(u,e-l):(n=null,r||(a=t.apply(o,i),n||(o=i=null)))};return function(){o=this,i=arguments,s=m.now();var l=r&&!n;return n||(n=setTimeout(u,e)),l&&(a=t.apply(o,i),o=i=null),a}},m.wrap=function(t,e){return m.partial(e,t)},m.negate=function(t){return function(){return!t.apply(this,arguments)}},m.compose=function(){var t=arguments,e=t.length-1;return function(){for(var r=e,n=t[e].apply(this,arguments);r--;)n=t[r].call(this,n);return n}},m.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},m.before=function(t,e){var r;return function(){return--t>0?r=e.apply(this,arguments):e=null,r}},m.once=m.partial(m.before,2),m.keys=function(t){if(!m.isObject(t))return[];if(d)return d(t);var e=[];for(var r in t)m.has(t,r)&&e.push(r);return e},m.values=function(t){for(var e=m.keys(t),r=e.length,n=Array(r),i=0;r>i;i++)n[i]=t[e[i]];return n},m.pairs=function(t){for(var e=m.keys(t),r=e.length,n=Array(r),i=0;r>i;i++)n[i]=[e[i],t[e[i]]];return n},m.invert=function(t){for(var e={},r=m.keys(t),n=0,i=r.length;i>n;n++)e[t[r[n]]]=r[n];return e},m.functions=m.methods=function(t){var e=[];for(var r in t)m.isFunction(t[r])&&e.push(r);return e.sort()},m.extend=function(t){if(!m.isObject(t))return t;for(var e,r,n=1,i=arguments.length;i>n;n++){e=arguments[n];for(r in e)f.call(e,r)&&(t[r]=e[r])}return t},m.pick=function(t,e,r){var n,i={};if(null==t)return i;if(m.isFunction(e)){e=v(e,r);for(n in t){var o=t[n];e(o,n,t)&&(i[n]=o)}}else{var s=c.apply([],l.call(arguments,1));t=new Object(t);for(var a=0,u=s.length;u>a;a++)n=s[a],n in t&&(i[n]=t[n])}return i},m.omit=function(t,e,r){if(m.isFunction(e))e=m.negate(e);else{var n=m.map(c.apply([],l.call(arguments,1)),String);e=function(t,e){return!m.contains(n,e)}}return m.pick(t,e,r)},m.defaults=function(t){if(!m.isObject(t))return t;for(var e=1,r=arguments.length;r>e;e++){var n=arguments[e];for(var i in n)void 0===t[i]&&(t[i]=n[i])}return t},m.clone=function(t){return m.isObject(t)?m.isArray(t)?t.slice():m.extend({},t):t},m.tap=function(t,e){return e(t),t};var j=function(t,e,r,n){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof m&&(t=t._wrapped),e instanceof m&&(e=e._wrapped);var i=h.call(t);if(i!==h.call(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}if("object"!=typeof t||"object"!=typeof e)return!1;for(var o=r.length;o--;)if(r[o]===t)return n[o]===e;var s=t.constructor,a=e.constructor;if(s!==a&&"constructor"in t&&"constructor"in e&&!(m.isFunction(s)&&s instanceof s&&m.isFunction(a)&&a instanceof a))return!1;r.push(t),n.push(e);var u,l;if("[object Array]"===i){if(u=t.length,l=u===e.length)for(;u--&&(l=j(t[u],e[u],r,n)););}else{var c,f=m.keys(t);if(u=f.length,l=m.keys(e).length===u)for(;u--&&(c=f[u],l=m.has(e,c)&&j(t[c],e[c],r,n)););}return r.pop(),n.pop(),l};m.isEqual=function(t,e){return j(t,e,[],[])},m.isEmpty=function(t){if(null==t)return!0;if(m.isArray(t)||m.isString(t)||m.isArguments(t))return 0===t.length;for(var e in t)if(m.has(t,e))return!1;return!0},m.isElement=function(t){return!(!t||1!==t.nodeType)},m.isArray=p||function(t){return"[object Array]"===h.call(t)},m.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},m.each(["Arguments","Function","String","Number","Date","RegExp"],function(t){m["is"+t]=function(e){return h.call(e)==="[object "+t+"]"}}),m.isArguments(arguments)||(m.isArguments=function(t){return m.has(t,"callee")}),"function"!=typeof/./&&(m.isFunction=function(t){return"function"==typeof t||!1}),m.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},m.isNaN=function(t){return m.isNumber(t)&&t!==+t},m.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===h.call(t)},m.isNull=function(t){return null===t},m.isUndefined=function(t){return void 0===t},m.has=function(t,e){return null!=t&&f.call(t,e)},m.noConflict=function(){return e._=i,this},m.identity=function(t){return t},m.constant=function(t){return function(){return t}},m.noop=function(){},m.property=function(t){return function(e){return e[t]}},m.matches=function(t){var e=m.pairs(t),r=e.length;return function(t){if(null==t)return!r;t=new Object(t);for(var n=0;r>n;n++){var i=e[n],o=i[0];if(i[1]!==t[o]||!(o in t))return!1}return!0}},m.times=function(t,e,r){var n=Array(Math.max(0,t));e=v(e,r,1);for(var i=0;t>i;i++)n[i]=e(i);return n},m.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},m.now=Date.now||function(){return(new Date).getTime()};var x={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},E=m.invert(x),k=function(t){var e=function(e){return t[e]},r="(?:"+m.keys(t).join("|")+")",n=RegExp(r),i=RegExp(r,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(i,e):t}};m.escape=k(x),m.unescape=k(E),m.result=function(t,e){if(null==t)return void 0;var r=t[e];return m.isFunction(r)?t[e]():r};var T=0;m.uniqueId=function(t){var e=++T+"";return t?t+e:e},m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var R=/(.)^/,A={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},C=/\\|'|\r|\n|\u2028|\u2029/g,S=function(t){return"\\"+A[t]};m.template=function(t,e,r){!e&&r&&(e=r),e=m.defaults({},e,m.templateSettings);var n=RegExp([(e.escape||R).source,(e.interpolate||R).source,(e.evaluate||R).source].join("|")+"|$","g"),i=0,o="__p+='";t.replace(n,function(e,r,n,s,a){return o+=t.slice(i,a).replace(C,S),i=a+e.length,r?o+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":n?o+="'+\n((__t=("+n+"))==null?'':__t)+\n'":s&&(o+="';\n"+s+"\n__p+='"),e}),o+="';\n",e.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var s=new Function(e.variable||"obj","_",o)}catch(a){throw a.source=o,a}var u=function(t){return s.call(this,t,m)},l=e.variable||"obj";return u.source="function("+l+"){\n"+o+"}",u},m.chain=function(t){var e=m(t);return e._chain=!0,e};var F=function(t){return this._chain?m(t).chain():t};m.mixin=function(t){m.each(m.functions(t),function(e){var r=m[e]=t[e];m.prototype[e]=function(){var t=[this._wrapped];return u.apply(t,arguments),F.call(this,r.apply(m,t))}})},m.mixin(m),m.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=o[t];m.prototype[t]=function(){var r=this._wrapped;return e.apply(r,arguments),"shift"!==t&&"splice"!==t||0!==r.length||delete r[0],F.call(this,r)}}),m.each(["concat","join","slice"],function(t){var e=o[t];m.prototype[t]=function(){return F.call(this,e.apply(this._wrapped,arguments))}}),m.prototype.value=function(){return this._wrapped},"function"==typeof t&&t.amd&&t("underscore",[],function(){return m})}).call(this)},{}],17:[function(t,e){"use strict";e.exports=function(t){function e(t){var e=new r(t),n=e.promise();return n.isRejected()?n:(e.setHowMany(1),e.setUnwrap(),e.init(),n)}var r=t._SomePromiseArray;t.any=function(t){return e(t)},t.prototype.any=function(){return e(this)}}},{}],18:[function(t,e){(function(r){"use strict";function n(){this._isTickUsed=!1,this._schedule=i,this._length=0,this._lateBuffer=new o(16),this._functionBuffer=new o(65536);var t=this;this.consumeFunctionBuffer=function(){t._consumeFunctionBuffer()}}var i=t("./schedule.js"),o=t("./queue.js"),s=t("./util.js").errorObj,a=t("./util.js").tryCatch1,u="undefined"!=typeof r?r:void 0;n.prototype.haveItemsQueued=function(){return this._length>0},n.prototype.invokeLater=function(t,e,r){void 0===u||null==u.domain||t.domain||(t=u.domain.bind(t)),this._lateBuffer.push(t,e,r),this._queueTick()},n.prototype.invoke=function(t,e,r){void 0===u||null==u.domain||t.domain||(t=u.domain.bind(t));var n=this._functionBuffer;n.push(t,e,r),this._length=n.length(),this._queueTick()},n.prototype._consumeFunctionBuffer=function(){for(var t=this._functionBuffer;t.length()>0;){var e=t.shift(),r=t.shift(),n=t.shift();e.call(r,n)}this._reset(),this._consumeLateBuffer()},n.prototype._consumeLateBuffer=function(){for(var t=this._lateBuffer;t.length()>0;){var e=t.shift(),r=t.shift(),n=t.shift(),i=a(e,r,n);if(i===s){if(this._queueTick(),null==e.domain)throw i.e;e.domain.emit("error",i.e)}}},n.prototype._queueTick=function(){this._isTickUsed||(this._schedule(this.consumeFunctionBuffer),this._isTickUsed=!0)},n.prototype._reset=function(){this._isTickUsed=!1,this._length=0},e.exports=new n}).call(this,t("_process"))},{"./queue.js":40,"./schedule.js":43,"./util.js":50,_process:60}],19:[function(t,e){"use strict";var r=Object.create;if(r){var n=r(null),i=r(null);n[" size"]=i[" size"]=0}e.exports=function(e){function r(t){return new Function("obj","                                             \n        'use strict'                                                         \n        var len = this.length;                                               \n        switch(len) {                                                        \n            case 1: return obj.methodName(this[0]);                          \n            case 2: return obj.methodName(this[0], this[1]);                 \n            case 3: return obj.methodName(this[0], this[1], this[2]);        \n            case 0: return obj.methodName();                                 \n            default: return obj.methodName.apply(obj, this);                 \n        }                                                                    \n        ".replace(/methodName/g,t))
}function o(t){return new Function("obj","                                             \n        'use strict';                                                        \n        return obj.propertyName;                                             \n        ".replace("propertyName",t))}function s(t,e,r){var n=r[t];if("function"!=typeof n){if(!d(t))return null;if(n=e(t),r[t]=n,r[" size"]++,r[" size"]>512){for(var i=Object.keys(r),o=0;256>o;++o)delete r[i[o]];r[" size"]=i.length-256}}return n}function a(t){return s(t,r,n)}function u(t){return s(t,o,i)}function l(t){return t[this.pop()].apply(t,this)}function c(t){return t[this]}function h(t){return t[this]}var f=t("./util.js"),p=f.canEvaluate,d=f.isIdentifier;e.prototype.call=function(t){for(var e=arguments.length,r=new Array(e-1),n=1;e>n;++n)r[n-1]=arguments[n];if(p){var i=a(t);if(null!==i)return this._then(i,void 0,void 0,r,void 0)}return r.push(t),this._then(l,void 0,void 0,r,void 0)},e.prototype.get=function(t){var e,r="number"==typeof t;if(r)e=h;else if(p){var n=u(t);e=null!==n?n:c}else e=c;return this._then(e,void 0,void 0,t,void 0)}}},{"./util.js":50}],20:[function(t,e){"use strict";e.exports=function(e,r){var n=t("./errors.js"),i=n.canAttach,o=t("./async.js"),s=n.CancellationError;e.prototype._cancel=function(t){if(!this.isCancellable())return this;for(var e,r=this;void 0!==(e=r._cancellationParent)&&e.isCancellable();)r=e;this._unsetCancellable(),r._attachExtraTrace(t),r._rejectUnchecked(t)},e.prototype.cancel=function(t){return this.isCancellable()?(t=void 0!==t?i(t)?t:new Error(t+""):new s,o.invokeLater(this._cancel,this,t),this):this},e.prototype.cancellable=function(){return this._cancellable()?this:(this._setCancellable(),this._cancellationParent=void 0,this)},e.prototype.uncancellable=function(){var t=new e(r);return t._propagateFrom(this,6),t._follow(this),t._unsetCancellable(),t},e.prototype.fork=function(t,e,r){var n=this._then(t,e,r,void 0,void 0);return n._setCancellable(),n._cancellationParent=void 0,n}}},{"./async.js":18,"./errors.js":25}],21:[function(t,e){"use strict";e.exports=function(){function e(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t.toString();var n=/\[object [a-zA-Z0-9$_]+\]/;if(n.test(e))try{var i=JSON.stringify(t);e=i}catch(o){}0===e.length&&(e="(empty array)")}return"(<"+r(e)+">, no stack trace)"}function r(t){var e=41;return t.length<e?t:t.substr(0,e-3)+"..."}function n(t,e){this.captureStackTrace(n,e)}var i=t("./util.js").inherits,o=t("./es5.js").defineProperty,s=new RegExp("\\b(?:[a-zA-Z0-9.]+\\$_\\w+|tryCatch(?:1|2|3|4|Apply)|new \\w*PromiseArray|\\w*PromiseArray\\.\\w*PromiseArray|setTimeout|CatchFilter\\$_\\w+|makeNodePromisified|processImmediate|process._tickCallback|nextTick|Async\\$\\w+)\\b"),a=null,u=null;i(n,Error),n.prototype.captureStackTrace=function(t,e){l(this,t,e)},n.possiblyUnhandledRejection=function(t){if("object"==typeof console){var e;if("object"==typeof t||"function"==typeof t){var r=t.stack;e="Possibly unhandled "+u(r,t)}else e="Possibly unhandled "+String(t);"function"==typeof console.error||"object"==typeof console.error?console.error(e):("function"==typeof console.log||"object"==typeof console.log)&&console.log(e)}},n.combine=function(t,e){for(var r=t.length-1,n=t[r],i=-1,o=e.length-1;o>=0;--o)if(e[o]===n){i=o;break}for(var o=i;o>=0;--o){var u=e[o];if(t[r]!==u)break;t.pop(),r--}t.push("From previous event:");for(var l=t.concat(e),c=[],o=0,h=l.length;h>o;++o)s.test(l[o])&&a.test(l[o])||o>0&&!a.test(l[o])&&"From previous event:"!==l[o]||c.push(l[o]);return c},n.protectErrorMessageNewlines=function(t){for(var e=0;e<t.length&&!a.test(t[e]);++e);if(!(1>=e)){for(var r=[],n=0;e>n;++n)r.push(t.shift());t.unshift(r.join("\x00"))}},n.isSupported=function(){return"function"==typeof l};var l=function c(){if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){a=/^\s*at\s*/,u=function(t,r){return"string"==typeof t?t:void 0!==r.name&&void 0!==r.message?r.name+". "+r.message:e(r)};var t=Error.captureStackTrace;return function(e,r){t(e,r)}}var r=new Error;if("string"==typeof r.stack&&"function"==typeof"".startsWith&&r.stack.startsWith("stackDetection@")&&"stackDetection"===c.name){o(Error,"stackTraceLimit",{writable:!0,enumerable:!1,configurable:!1,value:25}),a=/@/;var n=/[@\n]/;return u=function(t,r){return"string"==typeof t?r.name+". "+r.message+"\n"+t:void 0!==r.name&&void 0!==r.message?r.name+". "+r.message:e(r)},function(t){for(var e=(new Error).stack,r=e.split(n),i=r.length,o="",s=0;i>s;s+=2)o+=r[s],o+="@",o+=r[s+1],o+="\n";t.stack=o}}return u=function(t,r){return"string"==typeof t?t:"object"!=typeof r&&"function"!=typeof r||void 0===r.name||void 0===r.message?e(r):r.name+". "+r.message},null}();return n}},{"./es5.js":27,"./util.js":50}],22:[function(t,e){"use strict";e.exports=function(e){function r(t,e,r){this._instances=t,this._callback=e,this._promise=r}function n(t,e){var r={},n=s(t,r,e);if(n===a)return n;var i=u(r);return i.length?(a.e=new l("Catch filter must inherit from Error or be a simple predicate function"),a):n}var i=t("./util.js"),o=t("./errors.js"),s=i.tryCatch1,a=i.errorObj,u=t("./es5.js").keys,l=o.TypeError;return r.prototype.doFilter=function(t){for(var r=this._callback,i=this._promise,u=i._boundTo,l=0,c=this._instances.length;c>l;++l){var h=this._instances[l],f=h===Error||null!=h&&h.prototype instanceof Error;if(f&&t instanceof h){var p=s(r,u,t);return p===a?(e.e=p.e,e):p}if("function"==typeof h&&!f){var d=n(h,t);if(d===a){var g=o.canAttach(a.e)?a.e:new Error(a.e+"");this._promise._attachExtraTrace(g),t=a.e;break}if(d){var p=s(r,u,t);return p===a?(e.e=p.e,e):p}}}return e.e=t,e},r}},{"./errors.js":25,"./es5.js":27,"./util.js":50}],23:[function(t,e){"use strict";var r=t("./util.js"),n=r.isPrimitive,i=r.wrapsPrimitiveReceiver;e.exports=function(t){var e=function(){return this},r=function(){throw this},o=function(t,e){return 1===e?function(){throw t}:2===e?function(){return t}:void 0};t.prototype["return"]=t.prototype.thenReturn=function(t){return i&&n(t)?this._then(o(t,2),void 0,void 0,void 0,void 0):this._then(e,void 0,void 0,t,void 0)},t.prototype["throw"]=t.prototype.thenThrow=function(t){return i&&n(t)?this._then(o(t,1),void 0,void 0,void 0,void 0):this._then(r,void 0,void 0,t,void 0)}}},{"./util.js":50}],24:[function(t,e){"use strict";e.exports=function(t,e){var r=t.reduce;t.prototype.each=function(t){return r(this,t,null,e)},t.each=function(t,n){return r(t,n,null,e)}}},{}],25:[function(t,e){"use strict";function r(t){try{p(t,"isOperational",!0)}catch(e){}}function n(t){return null==t?!1:t instanceof a||t.isOperational===!0}function i(t){return t instanceof Error}function o(t){return i(t)}function s(t,e){function r(n){return this instanceof r?(this.message="string"==typeof n?n:e,this.name=t,void(Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new r(n)}return f(r,Error),r}function a(t){this.name="OperationalError",this.message=t,this.cause=t,this.isOperational=!0,t instanceof Error?(this.message=t.message,this.stack=t.stack):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}var u,l,c=t("./es5.js").freeze,h=t("./util.js"),f=h.inherits,p=h.notEnumerableProp,d=s("CancellationError","cancellation error"),g=s("TimeoutError","timeout error"),m=s("AggregateError","aggregate error");try{u=TypeError,l=RangeError}catch(v){u=s("TypeError","type error"),l=s("RangeError","range error")}for(var y="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),_=0;_<y.length;++_)"function"==typeof Array.prototype[y[_]]&&(m.prototype[y[_]]=Array.prototype[y[_]]);m.prototype.length=0,m.prototype.isOperational=!0;var b=0;m.prototype.toString=function(){var t=Array(4*b+1).join(" "),e="\n"+t+"AggregateError of:\n";b++,t=Array(4*b+1).join(" ");for(var r=0;r<this.length;++r){for(var n=this[r]===this?"[Circular AggregateError]":this[r]+"",i=n.split("\n"),o=0;o<i.length;++o)i[o]=t+i[o];n=i.join("\n"),e+=n+"\n"}return b--,e},f(a,Error);var w="__BluebirdErrorTypes__",j=Error[w];j||(j=c({CancellationError:d,TimeoutError:g,OperationalError:a,RejectionError:a,AggregateError:m}),p(Error,w,j)),e.exports={Error:Error,TypeError:u,RangeError:l,CancellationError:j.CancellationError,OperationalError:j.OperationalError,TimeoutError:j.TimeoutError,AggregateError:j.AggregateError,originatesFromRejection:n,markAsOriginatingFromRejection:r,canAttach:o}},{"./es5.js":27,"./util.js":50}],26:[function(t,e){"use strict";e.exports=function(e){function r(t){var r=new n(t),i=e.rejected(r),o=i._peekContext();return null!=o&&o._attachExtraTrace(r),i}var n=t("./errors.js").TypeError;return r}},{"./errors.js":25}],27:[function(t,e){var r=function(){"use strict";return void 0===this}();if(r)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,keys:Object.keys,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r};else{var n={}.hasOwnProperty,i={}.toString,o={}.constructor.prototype,s=function(t){var e=[];for(var r in t)n.call(t,r)&&e.push(r);return e},a=function(t,e,r){return t[e]=r.value,t},u=function(t){return t},l=function(t){try{return Object(t).constructor.prototype}catch(e){return o}},c=function(t){try{return"[object Array]"===i.call(t)}catch(e){return!1}};e.exports={isArray:c,keys:s,defineProperty:a,freeze:u,getPrototypeOf:l,isES5:r}}},{}],28:[function(t,e){"use strict";e.exports=function(t,e){var r=t.map;t.prototype.filter=function(t,n){return r(this,t,n,e)},t.filter=function(t,n,i){return r(t,n,i,e)}}},{}],29:[function(t,e){"use strict";e.exports=function(e,r,n){function i(){return this}function o(){throw this}function s(t){return function(){return t}}function a(t){return function(){throw t}}function u(t,e,r){var n;return n=f&&p(e)?r?s(e):a(e):r?i:o,t._then(n,d,void 0,e,void 0)}function l(t){var i=this.promise,o=this.handler,s=i._isBound()?o.call(i._boundTo):o();if(void 0!==s){var a=n(s,void 0);if(a instanceof e)return u(a,t,i.isFulfilled())}return i.isRejected()?(r.e=t,r):t}function c(t){var r=this.promise,i=this.handler,o=r._isBound()?i.call(r._boundTo,t):i(t);if(void 0!==o){var s=n(o,void 0);if(s instanceof e)return u(s,t,!0)}return t}var h=t("./util.js"),f=h.wrapsPrimitiveReceiver,p=h.isPrimitive,d=h.thrower;e.prototype._passThroughHandler=function(t,e){if("function"!=typeof t)return this.then();var r={promise:this,handler:t};return this._then(e?l:c,e?l:void 0,void 0,r,void 0)},e.prototype.lastly=e.prototype["finally"]=function(t){return this._passThroughHandler(t,!0)},e.prototype.tap=function(t){return this._passThroughHandler(t,!1)}}},{"./util.js":50}],30:[function(t,e){"use strict";e.exports=function(e,r,n,i){function o(t,r){for(var n=h,s=e,a=r.length,u=0;a>u;++u){var l=f(r[u],void 0,t);if(l===n)return s.reject(n.e);var c=i(l,o);if(c instanceof s)return c}return null}function s(t,r,i){var o=this._promise=new e(n);o._setTrace(void 0),this._generatorFunction=t,this._receiver=r,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(p):p}var a=t("./errors.js"),u=a.TypeError,l=t("./util.js").deprecated,c=t("./util.js"),h=c.errorObj,f=c.tryCatch1,p=[];s.prototype.promise=function(){return this._promise},s.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._next(void 0)},s.prototype._continue=function(t){if(t===h){this._generator=void 0;var r=a.canAttach(t.e)?t.e:new Error(t.e+"");return this._promise._attachExtraTrace(r),void this._promise._reject(t.e,r)}var n=t.value;if(t.done===!0)this._generator=void 0,this._promise._tryFollow(n)||this._promise._fulfill(n);else{var s=i(n,void 0);if(!(s instanceof e)&&(s=o(s,this._yieldHandlers),null===s))return void this._throw(new u("A value was yielded that could not be treated as a promise"));s._then(this._next,this._throw,void 0,this,null)}},s.prototype._throw=function(t){a.canAttach(t)&&this._promise._attachExtraTrace(t),this._continue(f(this._generator["throw"],this._generator,t))},s.prototype._next=function(t){this._continue(f(this._generator.next,this._generator,t))},e.coroutine=function(t,e){if("function"!=typeof t)throw new u("generatorFunction must be a function");var r=Object(e).yieldHandler,n=s;return function(){var e=t.apply(this,arguments),i=new n(void 0,void 0,r);return i._generator=e,i._next(void 0),i.promise()}},e.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new u("fn must be a function");p.push(t)},e.spawn=function(t){if(l("Promise.spawn is deprecated. Use Promise.coroutine instead."),"function"!=typeof t)return r("generatorFunction must be a function");var n=new s(t,this),i=n.promise();return n._run(e.spawn),i}}},{"./errors.js":25,"./util.js":50}],31:[function(t,e){"use strict";e.exports=function(e,r,n,i){var o=t("./util.js"),s=o.canEvaluate,a=o.tryCatch1,u=o.errorObj;if(s){for(var l=function(t){return new Function("value","holder","                             \n            'use strict';                                                    \n            holder.pIndex = value;                                           \n            holder.checkFulfillment(this);                                   \n            ".replace(/Index/g,t))},c=function(t){for(var e=[],r=1;t>=r;++r)e.push("holder.p"+r);return new Function("holder","                                      \n            'use strict';                                                    \n            var callback = holder.fn;                                        \n            return callback(values);                                         \n            ".replace(/values/g,e.join(", ")))},h=[],f=[void 0],p=1;5>=p;++p)h.push(l(p)),f.push(c(p));var d=function(t,e){this.p1=this.p2=this.p3=this.p4=this.p5=null,this.fn=e,this.total=t,this.now=0};d.prototype.callers=f,d.prototype.checkFulfillment=function(t){var e=this.now;e++;var r=this.total;if(e>=r){var n=this.callers[r],i=a(n,void 0,this);i===u?t._rejectUnchecked(i.e):t._tryFollow(i)||t._fulfillUnchecked(i)}else this.now=e}}e.join=function(){var t,o=arguments.length-1;if(o>0&&"function"==typeof arguments[o]&&(t=arguments[o],6>o&&s)){var a=new e(i);a._setTrace(void 0);for(var u=new d(o,t),l=a._reject,c=h,f=0;o>f;++f){var p=n(arguments[f],void 0);p instanceof e?p.isPending()?p._then(c[f],l,void 0,a,u):p.isFulfilled()?c[f].call(a,p._settledValue,u):(a._reject(p._settledValue),p._unsetRejectionIsUnhandled()):c[f].call(a,p,u)}return a}for(var g=arguments.length,m=new Array(g),v=0;g>v;++v)m[v]=arguments[v];var a=new r(m).promise();return void 0!==t?a.spread(t):a}}},{"./util.js":50}],32:[function(t,e){"use strict";e.exports=function(e,r,n,i,o){function s(t,e,r,n){this.constructor$(t),this._callback=e,this._preservedValues=n===o?new Array(this.length()):null,this._limit=r,this._inFlight=0,this._queue=r>=1?[]:f,this._init$(void 0,-2)}function a(t,e,r,n){var i="object"==typeof r&&null!==r?r.concurrency:0;return i="number"==typeof i&&isFinite(i)&&i>=1?i:0,new s(t,e,i,n)}var u=t("./util.js"),l=u.tryCatch3,c=u.errorObj,h={},f=[];u.inherits(s,r),s.prototype._init=function(){},s.prototype._promiseFulfilled=function(t,r){var n=this._values;if(null!==n){var o=this.length(),s=this._preservedValues,a=this._limit;if(n[r]===h){if(n[r]=t,a>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return}else{if(a>=1&&this._inFlight>=a)return n[r]=t,void this._queue.push(r);null!==s&&(s[r]=t);var u=this._callback,f=this._promise._boundTo,p=l(u,f,t,r,o);if(p===c)return this._reject(p.e);var d=i(p,void 0);if(d instanceof e){if(d.isPending())return a>=1&&this._inFlight++,n[r]=h,d._proxyPromiseArray(this,r);if(!d.isFulfilled())return d._unsetRejectionIsUnhandled(),this._reject(d.reason());p=d.value()}n[r]=p}var g=++this._totalResolved;g>=o&&(null!==s?this._filter(n,s):this._resolve(n))}},s.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,r=this._values;t.length>0&&this._inFlight<e;){var n=t.pop();this._promiseFulfilled(r[n],n)}},s.prototype._filter=function(t,e){for(var r=e.length,n=new Array(r),i=0,o=0;r>o;++o)t[o]&&(n[i++]=e[o]);n.length=i,this._resolve(n)},s.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(t,e){return"function"!=typeof t?n("fn must be a function"):a(this,t,e,null).promise()},e.map=function(t,e,r,i){return"function"!=typeof e?n("fn must be a function"):a(t,e,r,i).promise()}}},{"./util.js":50}],33:[function(t,e){"use strict";e.exports=function(e){function r(t){throw t}function n(t,e){if(!s.isArray(t))return i(t,e);var n=s.tryCatchApply(this,[null].concat(t),e);n===c&&a.invokeLater(r,void 0,n.e)}function i(t,e){var n=this,i=void 0===t?l(n,e,null):u(n,e,null,t);i===c&&a.invokeLater(r,void 0,i.e)}function o(t,e){var n=this,i=l(n,e,t);i===c&&a.invokeLater(r,void 0,i.e)}var s=t("./util.js"),a=t("./async.js"),u=s.tryCatch2,l=s.tryCatch1,c=s.errorObj;e.prototype.nodeify=function(t,e){if("function"==typeof t){var r=i;void 0!==e&&Object(e).spread&&(r=n),this._then(r,o,void 0,t,this._boundTo)}return this}}},{"./async.js":18,"./util.js":50}],34:[function(t,e){"use strict";e.exports=function(e,r){var n=t("./util.js"),i=t("./async.js"),o=t("./errors.js"),s=n.tryCatch1,a=n.errorObj;e.prototype.progressed=function(t){return this._then(void 0,void 0,t,void 0,void 0)},e.prototype._progress=function(t){this._isFollowingOrFulfilledOrRejected()||this._progressUnchecked(t)},e.prototype._clearFirstHandlerData$Base=e.prototype._clearFirstHandlerData,e.prototype._clearFirstHandlerData=function(){this._clearFirstHandlerData$Base(),this._progressHandler0=void 0},e.prototype._progressHandlerAt=function(t){return 0===t?this._progressHandler0:this[(t<<2)+t-5+2]},e.prototype._doProgressWith=function(t){var r=t.value,n=t.handler,i=t.promise,u=t.receiver,l=s(n,u,r);if(l===a){if(null!=l.e&&"StopProgressPropagation"!==l.e.name){var c=o.canAttach(l.e)?l.e:new Error(l.e+"");i._attachExtraTrace(c),i._progress(l.e)}}else l instanceof e?l._then(i._progress,null,null,i,void 0):i._progress(l)},e.prototype._progressUnchecked=function(t){if(this.isPending())for(var n=this._length(),o=this._progress,s=0;n>s;s++){var a=this._progressHandlerAt(s),u=this._promiseAt(s);if(u instanceof e)"function"==typeof a?i.invoke(this._doProgressWith,this,{handler:a,promise:u,receiver:this._receiverAt(s),value:t}):i.invoke(o,u,t);else{var l=this._receiverAt(s);"function"==typeof a?a.call(l,t,u):l instanceof e&&l._isProxied()?l._progressUnchecked(t):l instanceof r&&l._promiseProgressed(t,u)}}}}},{"./async.js":18,"./errors.js":25,"./util.js":50}],35:[function(t,e){(function(r){"use strict";function n(t){try{Promise===t&&(Promise=i)}catch(e){}return t}var i;"undefined"!=typeof Promise&&(i=Promise),e.exports=function(){function e(t){if("function"!=typeof t)throw new x("the promise constructor requires a resolver function");if(this.constructor!==e)throw new x("the promise constructor cannot be invoked directly");this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._settledValue=void 0,this._boundTo=void 0,t!==l&&this._resolveFromResolver(t)}function i(t){return t[0]}function o(){return new e.PromiseInspection(this)}var s=t("./util.js"),a=t("./async.js"),u=t("./errors.js"),l=function(){},c={},h={e:null},f=t("./thenables.js")(e,l),p=t("./promise_array.js")(e,l,f),d=t("./captured_trace.js")(),g=t("./catch_filter.js")(h),m=t("./promise_resolver.js"),v=s.isArray,y=s.errorObj,_=s.tryCatch1,b=s.tryCatch2,w=s.tryCatchApply,j=u.RangeError,x=u.TypeError,E=u.CancellationError,k=u.TimeoutError,T=u.OperationalError,R=u.originatesFromRejection,A=u.markAsOriginatingFromRejection,C=u.canAttach,S=s.thrower,F=t("./errors_api_rejection")(e),N=function(){return new x("circular promise resolution chain")};e.prototype.bind=function(t){var r=f(t,void 0),n=new e(l);if(r instanceof e){var o=r.then(function(t){n._setBoundTo(t)}),s=e.all([this,o]).then(i);n._follow(s)}else n._follow(this),n._setBoundTo(t);return n._propagateFrom(this,3),n},e.prototype.toString=function(){return"[object Promise]"},e.prototype.caught=e.prototype["catch"]=function(t){var r=arguments.length;if(r>1){var n,i=new Array(r-1),o=0;for(n=0;r-1>n;++n){var s=arguments[n];if("function"!=typeof s){var a=new x("A catch filter must be an error constructor or a filter function");return this._attachExtraTrace(a),e.reject(a)}i[o++]=s}i.length=o,t=arguments[n],this._resetTrace();var u=new g(i,t,this);return this._then(void 0,u.doFilter,void 0,u,void 0)}return this._then(void 0,t,void 0,void 0,void 0)},e.prototype.reflect=function(){return this._then(o,o,void 0,this,void 0)},e.prototype.then=function(t,e,r){return this._then(t,e,r,void 0,void 0)},e.prototype.done=function(t,e,r){var n=this._then(t,e,r,void 0,void 0);n._setIsFinal()},e.prototype.spread=function(t,e){return this._then(t,e,void 0,c,void 0)},e.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},e.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this._settledValue,t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this._settledValue,t.isRejected=!0),t},e.prototype.all=function(){return new p(this).promise()},e.is=function(t){return t instanceof e},e.all=function(t){return new p(t).promise()},e.prototype.error=function(t){return this.caught(R,t)},e.prototype._resolveFromSyncValue=function(t){if(t===y){this._cleanValues(),this._setRejected();var r=t.e;this._settledValue=r,this._tryAttachExtraTrace(r),this._ensurePossibleRejectionHandled()}else{var n=f(t,void 0);n instanceof e?this._follow(n):(this._cleanValues(),this._setFulfilled(),this._settledValue=t)}},e.method=function(t){if("function"!=typeof t)throw new x("fn must be a function");return function(){var r;switch(arguments.length){case 0:r=_(t,this,void 0);break;case 1:r=_(t,this,arguments[0]);break;case 2:r=b(t,this,arguments[0],arguments[1]);break;default:for(var n=arguments.length,i=new Array(n),o=0;n>o;++o)i[o]=arguments[o];r=w(t,i,this)}var s=new e(l);return s._setTrace(void 0),s._resolveFromSyncValue(r),s}},e.attempt=e["try"]=function(t,r,n){if("function"!=typeof t)return F("fn must be a function");var i=v(r)?w(t,r,n):_(t,n,r),o=new e(l);return o._setTrace(void 0),o._resolveFromSyncValue(i),o},e.defer=e.pending=function(){var t=new e(l);return t._setTrace(void 0),new m(t)},e.bind=function(t){var r=f(t,void 0),n=new e(l);if(n._setTrace(void 0),r instanceof e){var i=r.then(function(t){n._setBoundTo(t)});n._follow(i)}else n._setBoundTo(t),n._setFulfilled();return n},e.cast=function(t){var r=f(t,void 0);if(!(r instanceof e)){var n=r;r=new e(l),r._setTrace(void 0),r._setFulfilled(),r._cleanValues(),r._settledValue=n}return r},e.resolve=e.fulfilled=e.cast,e.reject=e.rejected=function(t){var r=new e(l);if(r._setTrace(void 0),A(t),r._cleanValues(),r._setRejected(),r._settledValue=t,!C(t)){var n=new Error(t+"");r._setCarriedStackTrace(n)}return r._ensurePossibleRejectionHandled(),r},e.onPossiblyUnhandledRejection=function(t){d.possiblyUnhandledRejection="function"==typeof t?t:void 0};var O;e.onUnhandledRejectionHandled=function(t){O="function"==typeof t?t:void 0};var I=!1||!("undefined"==typeof r||"string"!=typeof r.execPath||"object"!=typeof r.env||!r.env.BLUEBIRD_DEBUG&&"development"!==r.env.NODE_ENV);e.longStackTraces=function(){if(a.haveItemsQueued()&&I===!1)throw new Error("cannot enable long stack traces after promises have been created");I=d.isSupported()},e.hasLongStackTraces=function(){return I&&d.isSupported()},e.prototype._then=function(t,r,n,i,o){var s=void 0!==o,u=s?o:new e(l);if(!s){if(I){var c=this._peekContext()===this._traceParent;u._traceParent=c?this._traceParent:this}u._propagateFrom(this,7)}var h=this._addCallbacks(t,r,n,u,i);return this.isResolved()&&a.invoke(this._queueSettleAt,this,h),u},e.prototype._length=function(){return 262143&this._bitField},e.prototype._isFollowingOrFulfilledOrRejected=function(){return(939524096&this._bitField)>0},e.prototype._isFollowing=function(){return 536870912===(536870912&this._bitField)},e.prototype._setLength=function(t){this._bitField=-262144&this._bitField|262143&t},e.prototype._setFulfilled=function(){this._bitField=268435456|this._bitField},e.prototype._setRejected=function(){this._bitField=134217728|this._bitField},e.prototype._setFollowing=function(){this._bitField=536870912|this._bitField},e.prototype._setIsFinal=function(){this._bitField=33554432|this._bitField},e.prototype._isFinal=function(){return(33554432&this._bitField)>0},e.prototype._cancellable=function(){return(67108864&this._bitField)>0},e.prototype._setCancellable=function(){this._bitField=67108864|this._bitField},e.prototype._unsetCancellable=function(){this._bitField=-67108865&this._bitField},e.prototype._setRejectionIsUnhandled=function(){this._bitField=2097152|this._bitField},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-2097153&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(2097152&this._bitField)>0},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=524288|this._bitField},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-524289&this._bitField},e.prototype._isUnhandledRejectionNotified=function(){return(524288&this._bitField)>0},e.prototype._setCarriedStackTrace=function(t){this._bitField=1048576|this._bitField,this._fulfillmentHandler0=t},e.prototype._unsetCarriedStackTrace=function(){this._bitField=-1048577&this._bitField,this._fulfillmentHandler0=void 0},e.prototype._isCarryingStackTrace=function(){return(1048576&this._bitField)>0},e.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:void 0},e.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[(t<<2)+t-5+4];return this._isBound()&&void 0===e?this._boundTo:e},e.prototype._promiseAt=function(t){return 0===t?this._promise0:this[(t<<2)+t-5+3]},e.prototype._fulfillmentHandlerAt=function(t){return 0===t?this._fulfillmentHandler0:this[(t<<2)+t-5+0]},e.prototype._rejectionHandlerAt=function(t){return 0===t?this._rejectionHandler0:this[(t<<2)+t-5+1]},e.prototype._addCallbacks=function(t,e,r,n,i){var o=this._length();if(o>=262138&&(o=0,this._setLength(0)),0===o)this._promise0=n,void 0!==i&&(this._receiver0=i),"function"!=typeof t||this._isCarryingStackTrace()||(this._fulfillmentHandler0=t),"function"==typeof e&&(this._rejectionHandler0=e),"function"==typeof r&&(this._progressHandler0=r);else{var s=(o<<2)+o-5;this[s+3]=n,this[s+4]=i,this[s+0]="function"==typeof t?t:void 0,this[s+1]="function"==typeof e?e:void 0,this[s+2]="function"==typeof r?r:void 0}return this._setLength(o+1),o},e.prototype._setProxyHandlers=function(t,e){var r=this._length();if(r>=262138&&(r=0,this._setLength(0)),0===r)this._promise0=e,this._receiver0=t;else{var n=(r<<2)+r-5;this[n+3]=e,this[n+4]=t,this[n+0]=this[n+1]=this[n+2]=void 0}this._setLength(r+1)},e.prototype._proxyPromiseArray=function(t,e){this._setProxyHandlers(t,e)},e.prototype._proxyPromise=function(t){t._setProxied(),this._setProxyHandlers(t,-15)},e.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=8388608|this._bitField,this._boundTo=t):this._bitField=-8388609&this._bitField},e.prototype._isBound=function(){return 8388608===(8388608&this._bitField)},e.prototype._resolveFromResolver=function(t){function e(t){n._tryFollow(t)||n._fulfill(t)}function r(t){var e=C(t)?t:new Error(t+"");n._attachExtraTrace(e),A(t),n._reject(t,e===t?void 0:e)}var n=this;this._setTrace(void 0),this._pushContext();var i=b(t,void 0,e,r);if(this._popContext(),void 0!==i&&i===y){var o=i.e,s=C(o)?o:new Error(o+"");n._reject(o,s)}},e.prototype._spreadSlowCase=function(t,e,r,n){var i=new p(r).promise(),o=i._then(function(){return t.apply(n,arguments)},void 0,void 0,c,void 0);e._follow(o)},e.prototype._callSpread=function(t,r,n){var i=this._boundTo;if(v(n))for(var o=0,s=n.length;s>o;++o)if(f(n[o],void 0)instanceof e)return void this._spreadSlowCase(t,r,n,i);return r._pushContext(),w(t,n,i)},e.prototype._callHandler=function(t,e,r,n){var i;return e!==c||this.isRejected()?(r._pushContext(),i=_(t,e,n)):i=this._callSpread(t,r,n),r._popContext(),i},e.prototype._settlePromiseFromHandler=function(t,r,n,i){if(!(i instanceof e))return void t.call(r,n,i);if(!i.isResolved()){var o=this._callHandler(t,r,i,n);if(!i._isFollowing())if(o===y||o===i||o===h){var s=o===i?N():o.e,a=C(s)?s:new Error(s+"");o!==h&&i._attachExtraTrace(a),i._rejectUnchecked(s,a)}else{var u=f(o,i);if(u instanceof e){if(u.isRejected()&&!u._isCarryingStackTrace()&&!C(u._settledValue)){var a=new Error(u._settledValue+"");i._attachExtraTrace(a),u._setCarriedStackTrace(a)}i._follow(u),i._propagateFrom(u,1)}else i._fulfillUnchecked(o)}}},e.prototype._follow=function(t){this._setFollowing(),t.isPending()?(this._propagateFrom(t,1),t._proxyPromise(this)):t.isFulfilled()?this._fulfillUnchecked(t._settledValue):this._rejectUnchecked(t._settledValue,t._getCarriedStackTrace()),t._isRejectionUnhandled()&&t._unsetRejectionIsUnhandled(),I&&null==t._traceParent&&(t._traceParent=this)},e.prototype._tryFollow=function(t){if(this._isFollowingOrFulfilledOrRejected()||t===this)return!1;var r=f(t,void 0);return r instanceof e?(this._follow(r),!0):!1},e.prototype._resetTrace=function(){I&&(this._trace=new d(void 0===this._peekContext()))},e.prototype._setTrace=function(t){if(I){var e=this._peekContext();this._traceParent=e;var r=void 0===e;this._trace=void 0!==t&&t._traceParent===e?t._trace:new d(r)}return this},e.prototype._tryAttachExtraTrace=function(t){C(t)&&this._attachExtraTrace(t)},e.prototype._attachExtraTrace=function(t){if(I){var e=this,r=t.stack;r="string"==typeof r?r.split("\n"):[],d.protectErrorMessageNewlines(r);for(var n=1,i=1;null!=e&&null!=e._trace;)r=d.combine(r,e._trace.stack.split("\n")),e=e._traceParent,i++;var o=Error.stackTraceLimit||10,s=(o+n)*i,a=r.length;a>s&&(r.length=s),a>0&&(r[0]=r[0].split("\x00").join("\n")),t.stack=r.length<=n?"(No stack trace)":r.join("\n")}},e.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=void 0)},e.prototype._propagateFrom=function(t,e){(1&e)>0&&t._cancellable()&&(this._setCancellable(),this._cancellationParent=t),(4&e)>0&&this._setBoundTo(t._boundTo),(2&e)>0&&this._setTrace(t)},e.prototype._fulfill=function(t){this._isFollowingOrFulfilledOrRejected()||this._fulfillUnchecked(t)},e.prototype._reject=function(t,e){this._isFollowingOrFulfilledOrRejected()||this._rejectUnchecked(t,e)},e.prototype._settlePromiseAt=function(t){var r=this.isFulfilled()?this._fulfillmentHandlerAt(t):this._rejectionHandlerAt(t),n=this._settledValue,i=this._receiverAt(t),o=this._promiseAt(t);if("function"==typeof r)this._settlePromiseFromHandler(r,i,n,o);else{var s=!1,a=this.isFulfilled();void 0!==i&&(i instanceof e&&i._isProxied()?(i._unsetProxied(),a?i._fulfillUnchecked(n):i._rejectUnchecked(n,this._getCarriedStackTrace()),s=!0):i instanceof p&&(a?i._promiseFulfilled(n,o):i._promiseRejected(n,o),s=!0)),s||(a?o._fulfill(n):o._reject(n,this._getCarriedStackTrace()))}t>=4&&this._queueGC()},e.prototype._isProxied=function(){return 4194304===(4194304&this._bitField)},e.prototype._setProxied=function(){this._bitField=4194304|this._bitField},e.prototype._unsetProxied=function(){this._bitField=-4194305&this._bitField},e.prototype._isGcQueued=function(){return-1073741824===(-1073741824&this._bitField)},e.prototype._setGcQueued=function(){this._bitField=-1073741824|this._bitField},e.prototype._unsetGcQueued=function(){this._bitField=1073741823&this._bitField},e.prototype._queueGC=function(){this._isGcQueued()||(this._setGcQueued(),a.invokeLater(this._gc,this,void 0))},e.prototype._gc=function(){for(var t=5*this._length()-5,e=0;t>e;e++)delete this[e];this._clearFirstHandlerData(),this._setLength(0),this._unsetGcQueued()
},e.prototype._clearFirstHandlerData=function(){this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0},e.prototype._queueSettleAt=function(t){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),a.invoke(this._settlePromiseAt,this,t)},e.prototype._fulfillUnchecked=function(t){if(this.isPending()){if(t===this){var e=N();return this._attachExtraTrace(e),this._rejectUnchecked(e,void 0)}this._cleanValues(),this._setFulfilled(),this._settledValue=t;var r=this._length();r>0&&a.invoke(this._settlePromises,this,r)}},e.prototype._rejectUncheckedCheckError=function(t){var e=C(t)?t:new Error(t+"");this._rejectUnchecked(t,e===t?void 0:e)},e.prototype._rejectUnchecked=function(t,e){if(this.isPending()){if(t===this){var r=N();return this._attachExtraTrace(r),this._rejectUnchecked(r)}if(this._cleanValues(),this._setRejected(),this._settledValue=t,this._isFinal())return void a.invokeLater(S,void 0,void 0===e?t:e);var n=this._length();void 0!==e&&this._setCarriedStackTrace(e),n>0?a.invoke(this._rejectPromises,this,null):this._ensurePossibleRejectionHandled()}},e.prototype._rejectPromises=function(){this._settlePromises(),this._unsetCarriedStackTrace()},e.prototype._settlePromises=function(){for(var t=this._length(),e=0;t>e;e++)this._settlePromiseAt(e)},e.prototype._ensurePossibleRejectionHandled=function(){this._setRejectionIsUnhandled(),void 0!==d.possiblyUnhandledRejection&&a.invokeLater(this._notifyUnhandledRejection,this,void 0)},e.prototype._notifyUnhandledRejectionIsHandled=function(){"function"==typeof O&&a.invokeLater(O,void 0,this)},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue,e=this._getCarriedStackTrace();this._setUnhandledRejectionIsNotified(),void 0!==e&&(this._unsetCarriedStackTrace(),t=e),"function"==typeof d.possiblyUnhandledRejection&&d.possiblyUnhandledRejection(t,this)}};var P=[];return e.prototype._peekContext=function(){var t=P.length-1;return t>=0?P[t]:void 0},e.prototype._pushContext=function(){I&&P.push(this)},e.prototype._popContext=function(){I&&P.pop()},e.noConflict=function(){return n(e)},e.setScheduler=function(t){if("function"!=typeof t)throw new x("fn must be a function");a._schedule=t},d.isSupported()||(e.longStackTraces=function(){},I=!1),e._makeSelfResolutionError=N,t("./finally.js")(e,h,f),t("./direct_resolve.js")(e),t("./synchronous_inspection.js")(e),t("./join.js")(e,p,f,l),e.RangeError=j,e.CancellationError=E,e.TimeoutError=k,e.TypeError=x,e.OperationalError=T,e.RejectionError=T,e.AggregateError=u.AggregateError,s.toFastProperties(e),s.toFastProperties(e.prototype),e.Promise=e,t("./timers.js")(e,l,f),t("./race.js")(e,l,f),t("./call_get.js")(e),t("./generators.js")(e,F,l,f),t("./map.js")(e,p,F,f,l),t("./nodeify.js")(e),t("./promisify.js")(e,l),t("./props.js")(e,p,f),t("./reduce.js")(e,p,F,f,l),t("./settle.js")(e,p),t("./some.js")(e,p,F),t("./progress.js")(e,p),t("./cancel.js")(e,l),t("./filter.js")(e,l),t("./any.js")(e,p),t("./each.js")(e,l),t("./using.js")(e,F,f),e.prototype=e.prototype,e}}).call(this,t("_process"))},{"./any.js":17,"./async.js":18,"./call_get.js":19,"./cancel.js":20,"./captured_trace.js":21,"./catch_filter.js":22,"./direct_resolve.js":23,"./each.js":24,"./errors.js":25,"./errors_api_rejection":26,"./filter.js":28,"./finally.js":29,"./generators.js":30,"./join.js":31,"./map.js":32,"./nodeify.js":33,"./progress.js":34,"./promise_array.js":36,"./promise_resolver.js":37,"./promisify.js":38,"./props.js":39,"./race.js":41,"./reduce.js":42,"./settle.js":44,"./some.js":45,"./synchronous_inspection.js":46,"./thenables.js":47,"./timers.js":48,"./using.js":49,"./util.js":50,_process:60}],36:[function(t,e){"use strict";e.exports=function(e,r,n){function i(t){switch(t){case-1:return void 0;case-2:return[];case-3:return{}}}function o(t){var n=this._promise=new e(r),i=void 0;t instanceof e&&(i=t,n._propagateFrom(i,5)),n._setTrace(i),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var s=t("./errors.js").canAttach,a=t("./util.js"),u=a.isArray;return o.prototype.length=function(){return this._length},o.prototype.promise=function(){return this._promise},o.prototype._init=function l(t,r){var o=n(this._values,void 0);if(o instanceof e){if(this._values=o,o._setBoundTo(this._promise._boundTo),!o.isFulfilled())return o.isPending()?void o._then(l,this._reject,void 0,this,r):(o._unsetRejectionIsUnhandled(),void this._reject(o._settledValue));if(o=o._settledValue,!u(o)){var s=new e.TypeError("expecting an array, a promise or a thenable");return void this.__hardReject__(s)}}else if(!u(o)){var s=new e.TypeError("expecting an array, a promise or a thenable");return void this.__hardReject__(s)}if(0===o.length)return void(-5===r?this._resolveEmptyArray():this._resolve(i(r)));for(var a=this.getActualLength(o.length),c=a,h=this.shouldCopyValues()?new Array(a):this._values,f=!1,p=0;a>p;++p){var d=n(o[p],void 0);d instanceof e?d.isPending()?d._proxyPromiseArray(this,p):(d._unsetRejectionIsUnhandled(),f=!0):f=!0,h[p]=d}this._values=h,this._length=c,f&&this._scanDirectValues(a)},o.prototype._settlePromiseAt=function(t){var r=this._values[t];r instanceof e?r.isFulfilled()?this._promiseFulfilled(r._settledValue,t):r.isRejected()&&this._promiseRejected(r._settledValue,t):this._promiseFulfilled(r,t)},o.prototype._scanDirectValues=function(t){for(var e=0;t>e&&!this._isResolved();++e)this._settlePromiseAt(e)},o.prototype._isResolved=function(){return null===this._values},o.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},o.prototype.__hardReject__=o.prototype._reject=function(t){this._values=null;var e=s(t)?t:new Error(t+"");this._promise._attachExtraTrace(e),this._promise._reject(t,e)},o.prototype._promiseProgressed=function(t,e){this._isResolved()||this._promise._progress({index:e,value:t})},o.prototype._promiseFulfilled=function(t,e){if(!this._isResolved()){this._values[e]=t;var r=++this._totalResolved;r>=this._length&&this._resolve(this._values)}},o.prototype._promiseRejected=function(t){this._isResolved()||(this._totalResolved++,this._reject(t))},o.prototype.shouldCopyValues=function(){return!0},o.prototype.getActualLength=function(t){return t},o}},{"./errors.js":25,"./util.js":50}],37:[function(t,e){"use strict";function r(t){return t instanceof Error&&p.getPrototypeOf(t)===Error.prototype}function n(t){var e;return e=r(t)?new c(t):t,u.markAsOriginatingFromRejection(e),e}function i(t){function e(e,r){if(null!==t){if(e){var i=n(a(e));t._attachExtraTrace(i),t._reject(i)}else if(arguments.length>2){for(var o=arguments.length,s=new Array(o-1),u=1;o>u;++u)s[u-1]=arguments[u];t._fulfill(s)}else t._fulfill(r);t=null}}return e}var o,s=t("./util.js"),a=s.maybeWrapAsError,u=t("./errors.js"),l=u.TimeoutError,c=u.OperationalError,h=t("./async.js"),f=s.haveGetters,p=t("./es5.js");if(o=f?function(t){this.promise=t}:function(t){this.promise=t,this.asCallback=i(t),this.callback=this.asCallback},f){var d={get:function(){return i(this.promise)}};p.defineProperty(o.prototype,"asCallback",d),p.defineProperty(o.prototype,"callback",d)}o._nodebackForPromise=i,o.prototype.toString=function(){return"[object PromiseResolver]"},o.prototype.resolve=o.prototype.fulfill=function(t){if(!(this instanceof o))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");var e=this.promise;e._tryFollow(t)||h.invoke(e._fulfill,e,t)},o.prototype.reject=function(t){if(!(this instanceof o))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");var e=this.promise;u.markAsOriginatingFromRejection(t);var r=u.canAttach(t)?t:new Error(t+"");e._attachExtraTrace(r),h.invoke(e._reject,e,t),r!==t&&h.invoke(this._setCarriedStackTrace,this,r)},o.prototype.progress=function(t){if(!(this instanceof o))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");h.invoke(this.promise._progress,this.promise,t)},o.prototype.cancel=function(){h.invoke(this.promise.cancel,this.promise,void 0)},o.prototype.timeout=function(){this.reject(new l("timeout"))},o.prototype.isResolved=function(){return this.promise.isResolved()},o.prototype.toJSON=function(){return this.promise.toJSON()},o.prototype._setCarriedStackTrace=function(t){this.promise.isRejected()&&this.promise._setCarriedStackTrace(t)},e.exports=o},{"./async.js":18,"./errors.js":25,"./es5.js":27,"./util.js":50}],38:[function(t,e){"use strict";e.exports=function(e,r){function n(t){return t.replace(/([$])/,"\\$")}function i(t){try{return t.__isPromisified__===!0}catch(e){return!1}}function o(t,e,r){var n=y.getDataPropertyOrDefault(t,e+r,T);return n?i(n):!1}function s(t,e,r){for(var n=0;n<t.length;n+=2){var i=t[n];if(r.test(i))for(var o=i.replace(r,""),s=0;s<t.length;s+=2)if(t[s]===o)throw new x("Cannot promisify an API that has normal methods with '"+e+"'-suffix")}}function a(t,e,r,n){for(var a=y.inheritedDataKeys(t),u=[],l=0;l<a.length;++l){var c=a[l],h=t[c];"function"!=typeof h||i(h)||o(t,c,e)||!n(c,h,t)||u.push(c,h)}return s(u,e,r),u}function u(t){for(var e=[t],r=Math.max(0,t-1-5),n=t-1;n>=r;--n)n!==t&&e.push(n);for(var n=t+1;5>=n;++n)e.push(n);return e}function l(t){return y.filledRange(t,"arguments[","]")}function c(t){return y.filledRange(t,"_arg","")}function h(t){return"number"==typeof t.length?Math.max(Math.min(t.length,1024),0):0}function f(t){return y.isIdentifier(t)?"."+t:"['"+t.replace(/(['\\])/g,"\\$1")+"']"}function p(t,n,i,o,s){function a(e){var r,i=l(e).join(", "),o=e>0?", ":"";return r="string"==typeof t?"                                                          \n                this.method({{args}}, fn);                                   \n                break;                                                       \n            ".replace(".method",f(t)):n===v?"                                                         \n                callback.call(this, {{args}}, fn);                           \n                break;                                                       \n            ":void 0!==n?"                                                         \n                callback.call(receiver, {{args}}, fn);                       \n                break;                                                       \n            ":"                                                         \n                callback({{args}}, fn);                                      \n                break;                                                       \n            ",r.replace("{{args}}",i).replace(", ",o)}function p(){for(var e="",r=0;r<g.length;++r)e+="case "+g[r]+":"+a(g[r]);var i;return i="string"==typeof t?"                                                  \n                this.property.apply(this, args);                             \n            ".replace(".property",f(t)):n===v?"                                                  \n                callback.apply(this, args);                                  \n            ":"                                                  \n                callback.apply(receiver, args);                              \n            ",e+="                                                             \n        default:                                                             \n            var args = new Array(len + 1);                                   \n            var i = 0;                                                       \n            for (var i = 0; i < len; ++i) {                                  \n               args[i] = arguments[i];                                       \n            }                                                                \n            args[i] = fn;                                                    \n            [CodeForCall]                                                    \n            break;                                                           \n        ".replace("[CodeForCall]",i)}var d=Math.max(0,h(o)-1),g=u(d),m="string"==typeof i&&y.isIdentifier(i)?i+s:"promisified";return new Function("Promise","callback","receiver","withAppended","maybeWrapAsError","nodebackForPromise","INTERNAL","                                         \n        var ret = function FunctionName(Parameters) {                        \n            'use strict';                                                    \n            var len = arguments.length;                                      \n            var promise = new Promise(INTERNAL);                             \n            promise._setTrace(void 0);                                       \n            var fn = nodebackForPromise(promise);                            \n            try {                                                            \n                switch(len) {                                                \n                    [CodeForSwitchCase]                                      \n                }                                                            \n            } catch (e) {                                                    \n                var wrapped = maybeWrapAsError(e);                           \n                promise._attachExtraTrace(wrapped);                          \n                promise._reject(wrapped);                                    \n            }                                                                \n            return promise;                                                  \n        };                                                                   \n        ret.__isPromisified__ = true;                                        \n        return ret;                                                          \n        ".replace("FunctionName",m).replace("Parameters",c(d)).replace("[CodeForSwitchCase]",p()))(e,t,n,b,w,_,r)}function d(t,n){function i(){var i=n;n===v&&(i=this),"string"==typeof t&&(t=i[t]);var o=new e(r);o._setTrace(void 0);var s=_(o);try{t.apply(i,b(arguments,s))}catch(a){var u=w(a);o._attachExtraTrace(u),o._reject(u)}return o}return i.__isPromisified__=!0,i}function g(t,e,r,i){for(var o=new RegExp(n(e)+"$"),s=a(t,e,o,r),u=0,l=s.length;l>u;u+=2){var c=s[u],h=s[u+1],f=c+e;t[f]=i===R?R(c,v,c,h,e):i(h)}return y.toFastProperties(t),t}function m(t,e){return R(t,e,void 0,t)}var v={},y=t("./util.js"),_=t("./promise_resolver.js")._nodebackForPromise,b=y.withAppended,w=y.maybeWrapAsError,j=y.canEvaluate,x=t("./errors").TypeError,E="Async",k=function(t,e){return y.isIdentifier(t)&&"_"!==t.charAt(0)&&!y.isClass(e)},T={__isPromisified__:!0},R=j?p:d;e.promisify=function(t,e){if("function"!=typeof t)throw new x("fn must be a function");return i(t)?t:m(t,arguments.length<2?v:e)},e.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new x("the target of promisifyAll must be an object or a function");e=Object(e);var r=e.suffix;"string"!=typeof r&&(r=E);var n=e.filter;"function"!=typeof n&&(n=k);var i=e.promisifier;if("function"!=typeof i&&(i=R),!y.isIdentifier(r))throw new RangeError("suffix must be a valid identifier");for(var o=y.inheritedDataKeys(t,{includeHidden:!0}),s=0;s<o.length;++s){var a=t[o[s]];"constructor"!==o[s]&&y.isClass(a)&&(g(a.prototype,r,n,i),g(a,r,n,i))}return g(t,r,n,i)}}},{"./errors":25,"./promise_resolver.js":37,"./util.js":50}],39:[function(t,e){"use strict";e.exports=function(e,r,n){function i(t){for(var e=l.keys(t),r=e.length,n=new Array(2*r),i=0;r>i;++i){var o=e[i];n[i]=t[o],n[i+r]=o}this.constructor$(n)}function o(t){var r,o=n(t,void 0);return u(o)?(r=o instanceof e?o._then(e.props,void 0,void 0,void 0,void 0):new i(o).promise(),o instanceof e&&r._propagateFrom(o,4),r):a("cannot await properties of a non-object")}var s=t("./util.js"),a=t("./errors_api_rejection")(e),u=s.isObject,l=t("./es5.js");s.inherits(i,r),i.prototype._init=function(){this._init$(void 0,-3)},i.prototype._promiseFulfilled=function(t,e){if(!this._isResolved()){this._values[e]=t;var r=++this._totalResolved;if(r>=this._length){for(var n={},i=this.length(),o=0,s=this.length();s>o;++o)n[this._values[o+i]]=this._values[o];this._resolve(n)}}},i.prototype._promiseProgressed=function(t,e){this._isResolved()||this._promise._progress({key:this._values[e+this.length()],value:t})},i.prototype.shouldCopyValues=function(){return!1},i.prototype.getActualLength=function(t){return t>>1},e.prototype.props=function(){return o(this)},e.props=function(t){return o(t)}}},{"./errors_api_rejection":26,"./es5.js":27,"./util.js":50}],40:[function(t,e){"use strict";function r(t,e,r,n,i){for(var o=0;i>o;++o)r[o+n]=t[o+e]}function n(t){this._capacity=t,this._length=0,this._front=0,this._makeCapacity()}n.prototype._willBeOverCapacity=function(t){return this._capacity<t},n.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1);var r=this._front+e&this._capacity-1;this[r]=t,this._length=e+1},n.prototype.push=function(t,e,r){var n=this.length()+3;if(this._willBeOverCapacity(n))return this._pushOne(t),this._pushOne(e),void this._pushOne(r);var i=this._front+n-3;this._checkCapacity(n);var o=this._capacity-1;this[i+0&o]=t,this[i+1&o]=e,this[i+2&o]=r,this._length=n},n.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},n.prototype.length=function(){return this._length},n.prototype._makeCapacity=function(){for(var t=this._capacity,e=0;t>e;++e)this[e]=void 0},n.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<3)},n.prototype._resizeTo=function(t){var e=this._front,n=this._capacity,i=new Array(n),o=this.length();if(r(this,0,i,0,n),this._capacity=t,this._makeCapacity(),this._front=0,n>=e+o)r(i,e,this,0,o);else{var s=o-(e+o&n-1);r(i,e,this,0,s),r(i,0,this,s,o-s)}},e.exports=n},{}],41:[function(t,e){"use strict";e.exports=function(e,r,n){function i(t,i){var l=n(t,void 0);if(l instanceof e)return a(l);if(!s(t))return o("expecting an array, a promise or a thenable");var c=new e(r);void 0!==i?c._propagateFrom(i,7):c._setTrace(void 0);for(var h=c._fulfill,f=c._reject,p=0,d=t.length;d>p;++p){var g=t[p];(void 0!==g||u.call(t,p))&&e.cast(g)._then(h,f,void 0,c,null)}return c}var o=t("./errors_api_rejection.js")(e),s=t("./util.js").isArray,a=function(t){return t.then(function(e){return i(e,t)})},u={}.hasOwnProperty;e.race=function(t){return i(t,void 0)},e.prototype.race=function(){return i(this,void 0)}}},{"./errors_api_rejection.js":26,"./util.js":50}],42:[function(t,e){"use strict";e.exports=function(e,r,n,i,o){function s(t,r,n,s){this.constructor$(t),this._preservedValues=s===o?[]:null,this._zerothIsAccum=void 0===n,this._gotAccum=!1,this._reducingIndex=this._zerothIsAccum?1:0,this._valuesPhase=void 0;var a=i(n,void 0),u=!1,l=a instanceof e;l&&(a.isPending()?a._proxyPromiseArray(this,-1):a.isFulfilled()?(n=a.value(),this._gotAccum=!0):(a._unsetRejectionIsUnhandled(),this._reject(a.reason()),u=!0)),l||this._zerothIsAccum||(this._gotAccum=!0),this._callback=r,this._accum=n,u||this._init$(void 0,-5)}function a(t,e,r,i){if("function"!=typeof e)return n("fn must be a function");var o=new s(t,e,r,i);return o.promise()}var u=t("./util.js"),l=u.tryCatch4,c=u.tryCatch3,h=u.errorObj;u.inherits(s,r),s.prototype._init=function(){},s.prototype._resolveEmptyArray=function(){(this._gotAccum||this._zerothIsAccum)&&this._resolve(null!==this._preservedValues?[]:this._accum)},s.prototype._promiseFulfilled=function(t,r){var n=this._values;if(null!==n){var o,s=this.length(),a=this._preservedValues,u=null!==a,f=this._gotAccum,p=this._valuesPhase;if(!p)for(p=this._valuesPhase=Array(s),o=0;s>o;++o)p[o]=0;if(o=p[r],0===r&&this._zerothIsAccum?(f||(this._accum=t,this._gotAccum=f=!0),p[r]=0===o?1:2):-1===r?f||(this._accum=t,this._gotAccum=f=!0):0===o?p[r]=1:(p[r]=2,f&&(this._accum=t)),f){for(var d,g=this._callback,m=this._promise._boundTo,v=this._reducingIndex;s>v;++v)if(o=p[v],2!==o){if(1!==o)return;if(t=n[v],t instanceof e){if(!t.isFulfilled())return t.isPending()?void 0:(t._unsetRejectionIsUnhandled(),this._reject(t.reason()));t=t._settledValue}if(u?(a.push(t),d=c(g,m,t,v,s)):d=l(g,m,this._accum,t,v,s),d===h)return this._reject(d.e);var y=i(d,void 0);if(y instanceof e){if(y.isPending())return p[v]=4,y._proxyPromiseArray(this,v);if(!y.isFulfilled())return y._unsetRejectionIsUnhandled(),this._reject(y.reason());d=y.value()}this._reducingIndex=v+1,this._accum=d}else this._reducingIndex=v+1;this._reducingIndex<s||this._resolve(u?a:this._accum)}}},e.prototype.reduce=function(t,e){return a(this,t,e,null)},e.reduce=function(t,e,r,n){return a(t,e,r,n)}}},{"./util.js":50}],43:[function(t,e){(function(t){"use strict";var r,n;if("object"==typeof t&&"string"==typeof t.version)r=function(e){t.nextTick(e)};else if("undefined"!=typeof MutationObserver&&(n=MutationObserver)||"undefined"!=typeof WebKitMutationObserver&&(n=WebKitMutationObserver))r=function(){var t=document.createElement("div"),e=void 0,r=new n(function(){var t=e;e=void 0,t()});return r.observe(t,{attributes:!0}),function(r){e=r,t.classList.toggle("foo")}}();else{if("undefined"==typeof setTimeout)throw new Error("no async scheduler available");r=function(t){setTimeout(t,0)}}e.exports=r}).call(this,t("_process"))},{_process:60}],44:[function(t,e){"use strict";e.exports=function(e,r){function n(t){this.constructor$(t)}var i=e.PromiseInspection,o=t("./util.js");o.inherits(n,r),n.prototype._promiseResolved=function(t,e){this._values[t]=e;var r=++this._totalResolved;r>=this._length&&this._resolve(this._values)},n.prototype._promiseFulfilled=function(t,e){if(!this._isResolved()){var r=new i;r._bitField=268435456,r._settledValue=t,this._promiseResolved(e,r)}},n.prototype._promiseRejected=function(t,e){if(!this._isResolved()){var r=new i;r._bitField=134217728,r._settledValue=t,this._promiseResolved(e,r)}},e.settle=function(t){return new n(t).promise()},e.prototype.settle=function(){return new n(this).promise()}}},{"./util.js":50}],45:[function(t,e){"use strict";e.exports=function(e,r,n){function i(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function o(t,e){if((0|e)!==e||0>e)return n("expecting a positive integer");var r=new i(t),o=r.promise();return o.isRejected()?o:(r.setHowMany(e),r.init(),o)}var s=t("./util.js"),a=t("./errors.js").RangeError,u=t("./errors.js").AggregateError,l=s.isArray;s.inherits(i,r),i.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var t=l(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},i.prototype.init=function(){this._initialized=!0,this._init()},i.prototype.setUnwrap=function(){this._unwrap=!0},i.prototype.howMany=function(){return this._howMany},i.prototype.setHowMany=function(t){this._isResolved()||(this._howMany=t)},i.prototype._promiseFulfilled=function(t){this._isResolved()||(this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),this._resolve(1===this.howMany()&&this._unwrap?this._values[0]:this._values)))},i.prototype._promiseRejected=function(t){if(!this._isResolved()&&(this._addRejected(t),this.howMany()>this._canPossiblyFulfill())){for(var e=new u,r=this.length();r<this._values.length;++r)e.push(this._values[r]);this._reject(e)}},i.prototype._fulfilled=function(){return this._totalResolved},i.prototype._rejected=function(){return this._values.length-this.length()},i.prototype._addRejected=function(t){this._values.push(t)},i.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},i.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},i.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new a(e)},i.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(t,e){return o(t,e)},e.prototype.some=function(t){return o(this,t)},e._SomePromiseArray=i}},{"./errors.js":25,"./util.js":50}],46:[function(t,e){"use strict";e.exports=function(t){function e(t){void 0!==t?(this._bitField=t._bitField,this._settledValue=t.isResolved()?t._settledValue:void 0):(this._bitField=0,this._settledValue=void 0)}e.prototype.isFulfilled=t.prototype.isFulfilled=function(){return(268435456&this._bitField)>0},e.prototype.isRejected=t.prototype.isRejected=function(){return(134217728&this._bitField)>0},e.prototype.isPending=t.prototype.isPending=function(){return 0===(402653184&this._bitField)},e.prototype.value=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise");return this._settledValue},e.prototype.error=e.prototype.reason=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise");return this._settledValue},e.prototype.isResolved=t.prototype.isResolved=function(){return(402653184&this._bitField)>0},t.PromiseInspection=e}},{}],47:[function(t,e){"use strict";e.exports=function(e,r){function n(t){try{return t.then}catch(e){return l.e=e,l}}function i(t,i){if(c(t)){if(t instanceof e)return t;if(o(t)){var a=new e(r);return a._setTrace(void 0),t._then(a._fulfillUnchecked,a._rejectUncheckedCheckError,a._progressUnchecked,a,null),a._setFollowing(),a}var h=n(t);if(h===l)return void 0!==i&&u(h.e)&&i._attachExtraTrace(h.e),e.reject(h.e);if("function"==typeof h)return s(t,h,i)}return t}function o(t){return h.call(t,"_promise0")}function s(t,r,n){function i(r){if(!l){if(l=!0,t===r){var i=e._makeSelfResolutionError();return void 0!==n&&n._attachExtraTrace(i),void a.promise._reject(i,void 0)}a.resolve(r)}}function o(t){if(!l){l=!0;var e=u(t)?t:new Error(t+"");void 0!==n&&n._attachExtraTrace(e),a.promise._reject(t,e)}}function s(t){if(!l){var e=a.promise;"function"==typeof e._progress&&e._progress(t)}}var a=e.defer(),l=!1;try{r.call(t,i,o,s)}catch(c){if(!l){l=!0;var h=u(c)?c:new Error(c+"");void 0!==n&&n._attachExtraTrace(h),a.promise._reject(c,h)}}return a.promise}var a=t("./util.js"),u=t("./errors.js").canAttach,l=a.errorObj,c=a.isObject,h={}.hasOwnProperty;return i}},{"./errors.js":25,"./util.js":50}],48:[function(t,e){"use strict";var r=function(t,e){var r=arguments.length,n=arguments[2],i=arguments[3],o=r>=5?arguments[4]:void 0;setTimeout(function(){t(n,i,o)},0|e)};e.exports=function(e,n,i){var o=(t("./util.js"),t("./errors.js")),s=(t("./errors_api_rejection")(e),e.TimeoutError),a=function(t,e,r){if(t.isPending()){"string"!=typeof e&&(e="operation timed out after "+r+" ms");var n=new s(e);o.markAsOriginatingFromRejection(n),t._attachExtraTrace(n),t._cancel(n)}},u=function(t,e){e._fulfill(t)},l=e.delay=function(t,o){void 0===o&&(o=t,t=void 0),o=+o;var s=i(t,void 0),a=new e(n);return s instanceof e?(a._propagateFrom(s,7),a._follow(s),a.then(function(t){return e.delay(t,o)})):(a._setTrace(void 0),r(u,o,t,a),a)};e.prototype.delay=function(t){return l(this,t)},e.prototype.timeout=function(t,i){t=+t;var o=new e(n);return o._propagateFrom(this,7),o._follow(this),r(a,t,o,i,t),o.cancellable()}}},{"./errors.js":25,"./errors_api_rejection":26,"./util.js":50}],49:[function(t,e){"use strict";e.exports=function(e,r,n){function i(t){for(var r=t.length,n=0;r>n;++n){var i=t[n];if(i.isRejected())return e.reject(i.error());t[n]=i.value()}return t}function o(t){setTimeout(function(){throw t},0)}function s(t){var e=n(t,void 0);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}function a(t,r){function i(){if(a>=u)return l.resolve();var c=s(t[a++]);if(c instanceof e&&c._isDisposable()){try{c=n(c._getDisposer().tryDispose(r),void 0)}catch(h){return o(h)}if(c instanceof e)return c._then(i,o,null,null,null)}i()}var a=0,u=t.length,l=e.defer();return i(),l.promise}function u(t){var e=new d;return e._settledValue=t,e._bitField=268435456,a(this,e).thenReturn(t)}function l(t){var e=new d;return e._settledValue=t,e._bitField=134217728,a(this,e).thenThrow(t)}function c(t,e){this._data=t,this._promise=e}function h(t,e){this.constructor$(t,e)}var f=t("./errors.js").TypeError,p=t("./util.js").inherits,d=e.PromiseInspection;c.prototype.data=function(){return this._data},c.prototype.promise=function(){return this._promise},c.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():null},c.prototype.tryDispose=function(t){var e=this.resource(),r=null!==e?this.doDispose(e,t):null;return this._promise._unsetDisposable(),this._data=this._promise=null,r},c.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},p(h,c),h.prototype.doDispose=function(t,e){var r=this.data();return r.call(t,t,e)},e.using=function(){var t=arguments.length;if(2>t)return r("you must pass at least 2 arguments to Promise.using");var n=arguments[t-1];if("function"!=typeof n)return r("fn must be a function");t--;for(var o=new Array(t),s=0;t>s;++s){var a=arguments[s];if(c.isDisposer(a)){var h=a;a=a.promise(),a._setDisposable(h)}o[s]=a}return e.settle(o).then(i).spread(n)._then(u,l,void 0,o,void 0)},e.prototype._setDisposable=function(t){this._bitField=262144|this._bitField,this._disposer=t},e.prototype._isDisposable=function(){return(262144&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-262145&this._bitField,this._disposer=void 0},e.prototype.disposer=function(t){if("function"==typeof t)return new h(t,this);throw new f}}},{"./errors.js":25,"./util.js":50}],50:[function(t,e,r){"use strict";function n(t,e,r){try{return t.call(e,r)}catch(n){return x.e=n,x}}function i(t,e,r,n){try{return t.call(e,r,n)}catch(i){return x.e=i,x}}function o(t,e,r,n,i){try{return t.call(e,r,n,i)}catch(o){return x.e=o,x}}function s(t,e,r,n,i,o){try{return t.call(e,r,n,i,o)}catch(s){return x.e=s,x}}function a(t,e,r){try{return t.apply(r,e)}catch(n){return x.e=n,x}}function u(t){return"string"==typeof t?t:""+t}function l(t){return null==t||t===!0||t===!1||"string"==typeof t||"number"==typeof t}function c(t){return!l(t)}function h(t){return l(t)?new Error(u(t)):t}function f(t,e){var r,n=t.length,i=new Array(n+1);for(r=0;n>r;++r)i[r]=t[r];return i[r]=e,i}function p(t,e,r){if(!b.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var n=Object.getOwnPropertyDescriptor(t,e);return null!=n?null==n.get&&null==n.set?n.value:r:void 0}function d(t,e,r){if(l(t))return t;var n={value:r,configurable:!0,enumerable:!1,writable:!0};return b.defineProperty(t,e,n),t}function g(t){throw t}function m(t){try{if("function"==typeof t){var e=b.keys(t.prototype);return e.length>0&&!(1===e.length&&"constructor"===e[0])}return!1}catch(r){return!1}}function v(t){function e(){}return e.prototype=t,e}function y(t){return R.test(t)}function _(t,e,r){for(var n=new Array(t),i=0;t>i;++i)n[i]=e+i+r;return n}var b=t("./es5.js"),w=function(){try{var t={};return b.defineProperty(t,"f",{get:function(){return 3}}),3===t.f}catch(e){return!1}}(),j="undefined"==typeof navigator,x={e:{}},E=function(t,e){function r(){this.constructor=t,this.constructor$=e;for(var r in e.prototype)n.call(e.prototype,r)&&"$"!==r.charAt(r.length-1)&&(this[r+"$"]=e.prototype[r])}var n={}.hasOwnProperty;return r.prototype=e.prototype,t.prototype=new r,t.prototype},k=function(){return"string"!==this}.call("string"),T=function(){return b.isES5?function(t,e){for(var r=[],n=Object.create(null),i=Object(e).includeHidden?Object.getOwnPropertyNames:Object.keys;null!=t;){var o;try{o=i(t)}catch(s){return r}for(var a=0;a<o.length;++a){var u=o[a];if(!n[u]){n[u]=!0;var l=Object.getOwnPropertyDescriptor(t,u);null!=l&&null==l.get&&null==l.set&&r.push(u)}}t=b.getPrototypeOf(t)}return r}:function(t){var e=[];for(var r in t)e.push(r);
return e}}(),R=/^[a-z$_][a-z$_0-9]*$/i,A={isClass:m,isIdentifier:y,inheritedDataKeys:T,getDataPropertyOrDefault:p,thrower:g,isArray:b.isArray,haveGetters:w,notEnumerableProp:d,isPrimitive:l,isObject:c,canEvaluate:j,errorObj:x,tryCatch1:n,tryCatch2:i,tryCatch3:o,tryCatch4:s,tryCatchApply:a,inherits:E,withAppended:f,asString:u,maybeWrapAsError:h,wrapsPrimitiveReceiver:k,toFastProperties:v,filledRange:_};e.exports=A},{"./es5.js":27}],51:[function(){},{}],52:[function(t,e){e.exports=t(51)},{"/Users/tgriesser/Github/bookshelf/bookshelf/node_modules/browserify/lib/_empty.js":51}],53:[function(t,e,r){function n(t,e,r){if(!(this instanceof n))return new n(t,e,r);var i,o=typeof t;if("number"===o)i=t>0?t>>>0:0;else if("string"===o)"base64"===e&&(t=x(t)),i=n.byteLength(t,e);else{if("object"!==o||null===t)throw new TypeError("must start with number, buffer, array or string");"Buffer"===t.type&&P(t.data)&&(t=t.data),i=+t.length>0?Math.floor(+t.length):0}if(this.length>q)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+q.toString(16)+" bytes");var s;n.TYPED_ARRAY_SUPPORT?s=n._augment(new Uint8Array(i)):(s=this,s.length=i,s._isBuffer=!0);var a;if(n.TYPED_ARRAY_SUPPORT&&"number"==typeof t.byteLength)s._set(t);else if(k(t))if(n.isBuffer(t))for(a=0;i>a;a++)s[a]=t.readUInt8(a);else for(a=0;i>a;a++)s[a]=(t[a]%256+256)%256;else if("string"===o)s.write(t,0,e);else if("number"===o&&!n.TYPED_ARRAY_SUPPORT&&!r)for(a=0;i>a;a++)s[a]=0;return s}function i(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;var o=e.length;if(o%2!==0)throw new Error("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;n>s;s++){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))throw new Error("Invalid hex string");t[r+s]=a}return s}function o(t,e,r,n){var i=F(R(e),t,r,n);return i}function s(t,e,r,n){var i=F(A(e),t,r,n);return i}function a(t,e,r,n){return s(t,e,r,n)}function u(t,e,r,n){var i=F(S(e),t,r,n);return i}function l(t,e,r,n){var i=F(C(e),t,r,n);return i}function c(t,e,r){return O.fromByteArray(0===e&&r===t.length?t:t.slice(e,r))}function h(t,e,r){var n="",i="";r=Math.min(t.length,r);for(var o=e;r>o;o++)t[o]<=127?(n+=N(i)+String.fromCharCode(t[o]),i=""):i+="%"+t[o].toString(16);return n+N(i)}function f(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;r>i;i++)n+=String.fromCharCode(t[i]);return n}function p(t,e,r){return f(t,e,r)}function d(t,e,r){var n=t.length;(!e||0>e)&&(e=0),(!r||0>r||r>n)&&(r=n);for(var i="",o=e;r>o;o++)i+=T(t[o]);return i}function g(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function m(t,e,r){if(t%1!==0||0>t)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function v(t,e,r,i,o,s){if(!n.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(e>o||s>e)throw new TypeError("value is out of bounds");if(r+i>t.length)throw new TypeError("index out of range")}function y(t,e,r,n){0>e&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-r,2);o>i;i++)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function _(t,e,r,n){0>e&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-r,4);o>i;i++)t[r+i]=e>>>8*(n?i:3-i)&255}function b(t,e,r,n,i,o){if(e>i||o>e)throw new TypeError("value is out of bounds");if(r+n>t.length)throw new TypeError("index out of range")}function w(t,e,r,n,i){return i||b(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38),I.write(t,e,r,n,23,4),r+4}function j(t,e,r,n,i){return i||b(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308),I.write(t,e,r,n,52,8),r+8}function x(t){for(t=E(t).replace(L,"");t.length%4!==0;)t+="=";return t}function E(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function k(t){return P(t)||n.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}function T(t){return 16>t?"0"+t.toString(16):t.toString(16)}function R(t){for(var e=[],r=0;r<t.length;r++){var n=t.charCodeAt(r);if(127>=n)e.push(n);else{var i=r;n>=55296&&57343>=n&&r++;for(var o=encodeURIComponent(t.slice(i,r+1)).substr(1).split("%"),s=0;s<o.length;s++)e.push(parseInt(o[s],16))}}return e}function A(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e}function C(t){for(var e,r,n,i=[],o=0;o<t.length;o++)e=t.charCodeAt(o),r=e>>8,n=e%256,i.push(n),i.push(r);return i}function S(t){return O.toByteArray(t)}function F(t,e,r,n){for(var i=0;n>i&&!(i+r>=e.length||i>=t.length);i++)e[i+r]=t[i];return i}function N(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}var O=t("base64-js"),I=t("ieee754"),P=t("is-array");r.Buffer=n,r.SlowBuffer=n,r.INSPECT_MAX_BYTES=50,n.poolSize=8192;var q=1073741823;n.TYPED_ARRAY_SUPPORT=function(){try{var t=new ArrayBuffer(0),e=new Uint8Array(t);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(r){return!1}}(),n.isBuffer=function(t){return!(null==t||!t._isBuffer)},n.compare=function(t,e){if(!n.isBuffer(t)||!n.isBuffer(e))throw new TypeError("Arguments must be Buffers");for(var r=t.length,i=e.length,o=0,s=Math.min(r,i);s>o&&t[o]===e[o];o++);return o!==s&&(r=t[o],i=e[o]),i>r?-1:r>i?1:0},n.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(t,e){if(!P(t))throw new TypeError("Usage: Buffer.concat(list[, length])");if(0===t.length)return new n(0);if(1===t.length)return t[0];var r;if(void 0===e)for(e=0,r=0;r<t.length;r++)e+=t[r].length;var i=new n(e),o=0;for(r=0;r<t.length;r++){var s=t[r];s.copy(i,o),o+=s.length}return i},n.byteLength=function(t,e){var r;switch(t+="",e||"utf8"){case"ascii":case"binary":case"raw":r=t.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=2*t.length;break;case"hex":r=t.length>>>1;break;case"utf8":case"utf-8":r=R(t).length;break;case"base64":r=S(t).length;break;default:r=t.length}return r},n.prototype.length=void 0,n.prototype.parent=void 0,n.prototype.toString=function(t,e,r){var n=!1;if(e>>>=0,r=void 0===r||1/0===r?this.length:r>>>0,t||(t="utf8"),0>e&&(e=0),r>this.length&&(r=this.length),e>=r)return"";for(;;)switch(t){case"hex":return d(this,e,r);case"utf8":case"utf-8":return h(this,e,r);case"ascii":return f(this,e,r);case"binary":return p(this,e,r);case"base64":return c(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return g(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}},n.prototype.equals=function(t){if(!n.isBuffer(t))throw new TypeError("Argument must be a Buffer");return 0===n.compare(this,t)},n.prototype.inspect=function(){var t="",e=r.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},n.prototype.compare=function(t){if(!n.isBuffer(t))throw new TypeError("Argument must be a Buffer");return n.compare(this,t)},n.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},n.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},n.prototype.write=function(t,e,r,n){if(isFinite(e))isFinite(r)||(n=r,r=void 0);else{var c=n;n=e,e=r,r=c}e=Number(e)||0;var h=this.length-e;r?(r=Number(r),r>h&&(r=h)):r=h,n=String(n||"utf8").toLowerCase();var f;switch(n){case"hex":f=i(this,t,e,r);break;case"utf8":case"utf-8":f=o(this,t,e,r);break;case"ascii":f=s(this,t,e,r);break;case"binary":f=a(this,t,e,r);break;case"base64":f=u(this,t,e,r);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":f=l(this,t,e,r);break;default:throw new TypeError("Unknown encoding: "+n)}return f},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},n.prototype.slice=function(t,e){var r=this.length;if(t=~~t,e=void 0===e?r:~~e,0>t?(t+=r,0>t&&(t=0)):t>r&&(t=r),0>e?(e+=r,0>e&&(e=0)):e>r&&(e=r),t>e&&(e=t),n.TYPED_ARRAY_SUPPORT)return n._augment(this.subarray(t,e));for(var i=e-t,o=new n(i,void 0,!0),s=0;i>s;s++)o[s]=this[s+t];return o},n.prototype.readUInt8=function(t,e){return e||m(t,1,this.length),this[t]},n.prototype.readUInt16LE=function(t,e){return e||m(t,2,this.length),this[t]|this[t+1]<<8},n.prototype.readUInt16BE=function(t,e){return e||m(t,2,this.length),this[t]<<8|this[t+1]},n.prototype.readUInt32LE=function(t,e){return e||m(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},n.prototype.readUInt32BE=function(t,e){return e||m(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},n.prototype.readInt8=function(t,e){return e||m(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},n.prototype.readInt16LE=function(t,e){e||m(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},n.prototype.readInt16BE=function(t,e){e||m(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},n.prototype.readInt32LE=function(t,e){return e||m(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},n.prototype.readInt32BE=function(t,e){return e||m(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},n.prototype.readFloatLE=function(t,e){return e||m(t,4,this.length),I.read(this,t,!0,23,4)},n.prototype.readFloatBE=function(t,e){return e||m(t,4,this.length),I.read(this,t,!1,23,4)},n.prototype.readDoubleLE=function(t,e){return e||m(t,8,this.length),I.read(this,t,!0,52,8)},n.prototype.readDoubleBE=function(t,e){return e||m(t,8,this.length),I.read(this,t,!1,52,8)},n.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||v(this,t,e,1,255,0),n.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=t,e+1},n.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||v(this,t,e,2,65535,0),n.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):y(this,t,e,!0),e+2},n.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||v(this,t,e,2,65535,0),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):y(this,t,e,!1),e+2},n.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||v(this,t,e,4,4294967295,0),n.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t):_(this,t,e,!0),e+4},n.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||v(this,t,e,4,4294967295,0),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):_(this,t,e,!1),e+4},n.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||v(this,t,e,1,127,-128),n.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),0>t&&(t=255+t+1),this[e]=t,e+1},n.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||v(this,t,e,2,32767,-32768),n.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):y(this,t,e,!0),e+2},n.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||v(this,t,e,2,32767,-32768),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):y(this,t,e,!1),e+2},n.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||v(this,t,e,4,2147483647,-2147483648),n.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):_(this,t,e,!0),e+4},n.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||v(this,t,e,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):_(this,t,e,!1),e+4},n.prototype.writeFloatLE=function(t,e,r){return w(this,t,e,!0,r)},n.prototype.writeFloatBE=function(t,e,r){return w(this,t,e,!1,r)},n.prototype.writeDoubleLE=function(t,e,r){return j(this,t,e,!0,r)},n.prototype.writeDoubleBE=function(t,e,r){return j(this,t,e,!1,r)},n.prototype.copy=function(t,e,r,i){var o=this;if(r||(r=0),i||0===i||(i=this.length),e||(e=0),i!==r&&0!==t.length&&0!==o.length){if(r>i)throw new TypeError("sourceEnd < sourceStart");if(0>e||e>=t.length)throw new TypeError("targetStart out of bounds");if(0>r||r>=o.length)throw new TypeError("sourceStart out of bounds");if(0>i||i>o.length)throw new TypeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-r&&(i=t.length-e+r);var s=i-r;if(100>s||!n.TYPED_ARRAY_SUPPORT)for(var a=0;s>a;a++)t[a+e]=this[a+r];else t._set(this.subarray(r,r+s),e)}},n.prototype.fill=function(t,e,r){if(t||(t=0),e||(e=0),r||(r=this.length),e>r)throw new TypeError("end < start");if(r!==e&&0!==this.length){if(0>e||e>=this.length)throw new TypeError("start out of bounds");if(0>r||r>this.length)throw new TypeError("end out of bounds");var n;if("number"==typeof t)for(n=e;r>n;n++)this[n]=t;else{var i=R(t.toString()),o=i.length;for(n=e;r>n;n++)this[n]=i[n%o]}return this}},n.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(n.TYPED_ARRAY_SUPPORT)return new n(this).buffer;for(var t=new Uint8Array(this.length),e=0,r=t.length;r>e;e+=1)t[e]=this[e];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var M=n.prototype;n._augment=function(t){return t._isBuffer=!0,t._get=t.get,t._set=t.set,t.get=M.get,t.set=M.set,t.write=M.write,t.toString=M.toString,t.toLocaleString=M.toString,t.toJSON=M.toJSON,t.equals=M.equals,t.compare=M.compare,t.copy=M.copy,t.slice=M.slice,t.readUInt8=M.readUInt8,t.readUInt16LE=M.readUInt16LE,t.readUInt16BE=M.readUInt16BE,t.readUInt32LE=M.readUInt32LE,t.readUInt32BE=M.readUInt32BE,t.readInt8=M.readInt8,t.readInt16LE=M.readInt16LE,t.readInt16BE=M.readInt16BE,t.readInt32LE=M.readInt32LE,t.readInt32BE=M.readInt32BE,t.readFloatLE=M.readFloatLE,t.readFloatBE=M.readFloatBE,t.readDoubleLE=M.readDoubleLE,t.readDoubleBE=M.readDoubleBE,t.writeUInt8=M.writeUInt8,t.writeUInt16LE=M.writeUInt16LE,t.writeUInt16BE=M.writeUInt16BE,t.writeUInt32LE=M.writeUInt32LE,t.writeUInt32BE=M.writeUInt32BE,t.writeInt8=M.writeInt8,t.writeInt16LE=M.writeInt16LE,t.writeInt16BE=M.writeInt16BE,t.writeInt32LE=M.writeInt32LE,t.writeInt32BE=M.writeInt32BE,t.writeFloatLE=M.writeFloatLE,t.writeFloatBE=M.writeFloatBE,t.writeDoubleLE=M.writeDoubleLE,t.writeDoubleBE=M.writeDoubleBE,t.fill=M.fill,t.inspect=M.inspect,t.toArrayBuffer=M.toArrayBuffer,t};var L=/[^+\/0-9A-z]/g},{"base64-js":54,ieee754:55,"is-array":56}],54:[function(t,e,r){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===s?62:e===a?63:u>e?-1:u+10>e?e-u+26+26:c+26>e?e-c:l+26>e?e-l+26:void 0}function r(t){function r(t){l[h++]=t}var n,i,s,a,u,l;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var c=t.length;u="="===t.charAt(c-2)?2:"="===t.charAt(c-1)?1:0,l=new o(3*t.length/4-u),s=u>0?t.length-4:t.length;var h=0;for(n=0,i=0;s>n;n+=4,i+=3)a=e(t.charAt(n))<<18|e(t.charAt(n+1))<<12|e(t.charAt(n+2))<<6|e(t.charAt(n+3)),r((16711680&a)>>16),r((65280&a)>>8),r(255&a);return 2===u?(a=e(t.charAt(n))<<2|e(t.charAt(n+1))>>4,r(255&a)):1===u&&(a=e(t.charAt(n))<<10|e(t.charAt(n+1))<<4|e(t.charAt(n+2))>>2,r(a>>8&255),r(255&a)),l}function i(t){function e(t){return n.charAt(t)}function r(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var i,o,s,a=t.length%3,u="";for(i=0,s=t.length-a;s>i;i+=3)o=(t[i]<<16)+(t[i+1]<<8)+t[i+2],u+=r(o);switch(a){case 1:o=t[t.length-1],u+=e(o>>2),u+=e(o<<4&63),u+="==";break;case 2:o=(t[t.length-2]<<8)+t[t.length-1],u+=e(o>>10),u+=e(o>>4&63),u+=e(o<<2&63),u+="="}return u}var o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="+".charCodeAt(0),a="/".charCodeAt(0),u="0".charCodeAt(0),l="a".charCodeAt(0),c="A".charCodeAt(0);t.toByteArray=r,t.fromByteArray=i}("undefined"==typeof r?this.base64js={}:r)},{}],55:[function(t,e,r){r.read=function(t,e,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,l=u>>1,c=-7,h=r?i-1:0,f=r?-1:1,p=t[e+h];for(h+=f,o=p&(1<<-c)-1,p>>=-c,c+=a;c>0;o=256*o+t[e+h],h+=f,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=n;c>0;s=256*s+t[e+h],h+=f,c-=8);if(0===o)o=1-l;else{if(o===u)return s?0/0:1/0*(p?-1:1);s+=Math.pow(2,n),o-=l}return(p?-1:1)*s*Math.pow(2,o-n)},r.write=function(t,e,r,n,i,o){var s,a,u,l=8*o-i-1,c=(1<<l)-1,h=c>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,g=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||1/0===e?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),e+=s+h>=1?f/u:f*Math.pow(2,1-h),e*u>=2&&(s++,u/=2),s+h>=c?(a=0,s=c):s+h>=1?(a=(e*u-1)*Math.pow(2,i),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[r+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;t[r+p]=255&s,p+=d,s/=256,l-=8);t[r+p-d]|=128*g}},{}],56:[function(t,e){var r=Array.isArray,n=Object.prototype.toString;e.exports=r||function(t){return!!t&&"[object Array]"==n.call(t)}},{}],57:[function(t,e){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function i(t){return"number"==typeof t}function o(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!i(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,r,i,a,u,l;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(r=this._events[t],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,a=new Array(i-1),u=1;i>u;u++)a[u-1]=arguments[u];r.apply(this,a)}else if(o(r)){for(i=arguments.length,a=new Array(i-1),u=1;i>u;u++)a[u-1]=arguments[u];for(l=r.slice(),i=l.length,u=0;i>u;u++)l[u].apply(this,a)}return!0},r.prototype.addListener=function(t,e){var i;if(!n(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned){var i;i=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[t].length>i&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())}return this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function r(){this.removeListener(t,r),i||(i=!0,e.apply(this,arguments))}if(!n(e))throw TypeError("listener must be a function");var i=!1;return r.listener=e,this.on(t,r),this},r.prototype.removeListener=function(t,e){var r,i,s,a;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],s=r.length,i=-1,r===e||n(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(r)){for(a=s;a-->0;)if(r[a]===e||r[a].listener&&r[a].listener===e){i=a;break}if(0>i)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],n(r))this.removeListener(t,r);else for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.listenerCount=function(t,e){var r;return r=t._events&&t._events[e]?n(t._events[e])?1:t._events[e].length:0}},{}],58:[function(t,e){e.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)}},{}],59:[function(t,e,r){(function(t){function e(t,e){for(var r=0,n=t.length-1;n>=0;n--){var i=t[n];"."===i?t.splice(n,1):".."===i?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r--;r)t.unshift("..");return t}function n(t,e){if(t.filter)return t.filter(e);for(var r=[],n=0;n<t.length;n++)e(t[n],n,t)&&r.push(t[n]);return r}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(t){return i.exec(t).slice(1)};r.resolve=function(){for(var r="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var s=o>=0?arguments[o]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(r=s+"/"+r,i="/"===s.charAt(0))}return r=e(n(r.split("/"),function(t){return!!t}),!i).join("/"),(i?"/":"")+r||"."},r.normalize=function(t){var i=r.isAbsolute(t),o="/"===s(t,-1);return t=e(n(t.split("/"),function(t){return!!t}),!i).join("/"),t||i||(t="."),t&&o&&(t+="/"),(i?"/":"")+t},r.isAbsolute=function(t){return"/"===t.charAt(0)},r.join=function(){var t=Array.prototype.slice.call(arguments,0);return r.normalize(n(t,function(t){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},r.relative=function(t,e){function n(t){for(var e=0;e<t.length&&""===t[e];e++);for(var r=t.length-1;r>=0&&""===t[r];r--);return e>r?[]:t.slice(e,r-e+1)}t=r.resolve(t).substr(1),e=r.resolve(e).substr(1);for(var i=n(t.split("/")),o=n(e.split("/")),s=Math.min(i.length,o.length),a=s,u=0;s>u;u++)if(i[u]!==o[u]){a=u;break}for(var l=[],u=a;u<i.length;u++)l.push("..");return l=l.concat(o.slice(a)),l.join("/")},r.sep="/",r.delimiter=":",r.dirname=function(t){var e=o(t),r=e[0],n=e[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},r.basename=function(t,e){var r=o(t)[2];return e&&r.substr(-1*e.length)===e&&(r=r.substr(0,r.length-e.length)),r},r.extname=function(t){return o(t)[3]};var s="b"==="ab".substr(-1)?function(t,e,r){return t.substr(e,r)}:function(t,e,r){return 0>e&&(e=t.length+e),t.substr(e,r)}}).call(this,t("_process"))},{_process:60}],60:[function(t,e){function r(){}var n=e.exports={};n.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.MutationObserver,r="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};var n=[];if(e){var i=document.createElement("div"),o=new MutationObserver(function(){var t=n.slice();n.length=0,t.forEach(function(t){t()})});return o.observe(i,{attributes:!0}),function(t){n.length||i.setAttribute("yes","no"),n.push(t)}}return r?(window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}):function(t){setTimeout(t,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.on=r,n.addListener=r,n.once=r,n.off=r,n.removeListener=r,n.removeAllListeners=r,n.emit=r,n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")}},{}],61:[function(t,e){e.exports=t("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":62}],62:[function(t,e){(function(r){function n(t){return this instanceof n?(u.call(this,t),l.call(this,t),t&&t.readable===!1&&(this.readable=!1),t&&t.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,t&&t.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",i)):new n(t)}function i(){this.allowHalfOpen||this._writableState.ended||r.nextTick(this.end.bind(this))}function o(t,e){for(var r=0,n=t.length;n>r;r++)e(t[r],r)}e.exports=n;var s=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e},a=t("core-util-is");a.inherits=t("inherits");var u=t("./_stream_readable"),l=t("./_stream_writable");a.inherits(n,u),o(s(l.prototype),function(t){n.prototype[t]||(n.prototype[t]=l.prototype[t])})}).call(this,t("_process"))},{"./_stream_readable":64,"./_stream_writable":66,_process:60,"core-util-is":67,inherits:76}],63:[function(t,e){function r(t){return this instanceof r?void n.call(this,t):new r(t)}e.exports=r;var n=t("./_stream_transform"),i=t("core-util-is");i.inherits=t("inherits"),i.inherits(r,n),r.prototype._transform=function(t,e,r){r(null,t)}},{"./_stream_transform":65,"core-util-is":67,inherits:76}],64:[function(t,e){(function(r){function n(e){e=e||{};var r=e.highWaterMark;this.highWaterMark=r||0===r?r:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(A||(A=t("string_decoder/").StringDecoder),this.decoder=new A(e.encoding),this.encoding=e.encoding)}function i(t){return this instanceof i?(this._readableState=new n(t,this),this.readable=!0,void T.call(this)):new i(t)}function o(t,e,r,n,i){var o=l(e,r);if(o)t.emit("error",o);else if(null===r||void 0===r)e.reading=!1,e.ended||c(t,e);else if(e.objectMode||r&&r.length>0)if(e.ended&&!i){var a=new Error("stream.push() after EOF");t.emit("error",a)}else if(e.endEmitted&&i){var a=new Error("stream.unshift() after end event");t.emit("error",a)}else!e.decoder||i||n||(r=e.decoder.write(r)),e.length+=e.objectMode?1:r.length,i?e.buffer.unshift(r):(e.reading=!1,e.buffer.push(r)),e.needReadable&&h(t),p(t,e);else i||(e.reading=!1);return s(e)}function s(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}function a(t){if(t>=C)t=C;else{t--;for(var e=1;32>e;e<<=1)t|=t>>e;t++}return t}function u(t,e){return 0===e.length&&e.ended?0:e.objectMode?0===t?0:1:null===t||isNaN(t)?e.flowing&&e.buffer.length?e.buffer[0].length:e.length:0>=t?0:(t>e.highWaterMark&&(e.highWaterMark=a(t)),t>e.length?e.ended?e.length:(e.needReadable=!0,0):t)}function l(t,e){var r=null;return E.isBuffer(e)||"string"==typeof e||null===e||void 0===e||t.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}function c(t,e){if(e.decoder&&!e.ended){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.length>0?h(t):b(t)}function h(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,e.sync?r.nextTick(function(){f(t)}):f(t))}function f(t){t.emit("readable")}function p(t,e){e.readingMore||(e.readingMore=!0,r.nextTick(function(){d(t,e)}))}function d(t,e){for(var r=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(t.read(0),r!==e.length);)r=e.length;e.readingMore=!1}function g(t){return function(){var e=t._readableState;e.awaitDrain--,0===e.awaitDrain&&m(t)}}function m(t){function e(t){var e=t.write(r);!1===e&&n.awaitDrain++}var r,n=t._readableState;for(n.awaitDrain=0;n.pipesCount&&null!==(r=t.read());)if(1===n.pipesCount?e(n.pipes,0,null):w(n.pipes,e),t.emit("data",r),n.awaitDrain>0)return;return 0===n.pipesCount?(n.flowing=!1,void(k.listenerCount(t,"data")>0&&y(t))):void(n.ranOut=!0)}function v(){this._readableState.ranOut&&(this._readableState.ranOut=!1,m(this))}function y(t,e){var n=t._readableState;if(n.flowing)throw new Error("Cannot switch to old mode now.");var i=e||!1,o=!1;t.readable=!0,t.pipe=T.prototype.pipe,t.on=t.addListener=T.prototype.on,t.on("readable",function(){o=!0;for(var e;!i&&null!==(e=t.read());)t.emit("data",e);null===e&&(o=!1,t._readableState.needReadable=!0)}),t.pause=function(){i=!0,this.emit("pause")},t.resume=function(){i=!1,o?r.nextTick(function(){t.emit("readable")}):this.read(0),this.emit("resume")},t.emit("readable")}function _(t,e){var r,n=e.buffer,i=e.length,o=!!e.decoder,s=!!e.objectMode;if(0===n.length)return null;if(0===i)r=null;else if(s)r=n.shift();else if(!t||t>=i)r=o?n.join(""):E.concat(n,i),n.length=0;else if(t<n[0].length){var a=n[0];r=a.slice(0,t),n[0]=a.slice(t)}else if(t===n[0].length)r=n.shift();else{r=o?"":new E(t);for(var u=0,l=0,c=n.length;c>l&&t>u;l++){var a=n[0],h=Math.min(t-u,a.length);o?r+=a.slice(0,h):a.copy(r,u,0,h),h<a.length?n[0]=a.slice(h):n.shift(),u+=h}}return r}function b(t){var e=t._readableState;if(e.length>0)throw new Error("endReadable called on non-empty stream");!e.endEmitted&&e.calledRead&&(e.ended=!0,r.nextTick(function(){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}))}function w(t,e){for(var r=0,n=t.length;n>r;r++)e(t[r],r)}function j(t,e){for(var r=0,n=t.length;n>r;r++)if(t[r]===e)return r;return-1}e.exports=i;var x=t("isarray"),E=t("buffer").Buffer;i.ReadableState=n;var k=t("events").EventEmitter;k.listenerCount||(k.listenerCount=function(t,e){return t.listeners(e).length});var T=t("stream"),R=t("core-util-is");R.inherits=t("inherits");var A;R.inherits(i,T),i.prototype.push=function(t,e){var r=this._readableState;return"string"!=typeof t||r.objectMode||(e=e||r.defaultEncoding,e!==r.encoding&&(t=new E(t,e),e="")),o(this,r,t,e,!1)},i.prototype.unshift=function(t){var e=this._readableState;return o(this,e,t,"",!0)},i.prototype.setEncoding=function(e){A||(A=t("string_decoder/").StringDecoder),this._readableState.decoder=new A(e),this._readableState.encoding=e};var C=8388608;i.prototype.read=function(t){var e=this._readableState;e.calledRead=!0;var r,n=t;if(("number"!=typeof t||t>0)&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return h(this),null;if(t=u(t,e),0===t&&e.ended)return r=null,e.length>0&&e.decoder&&(r=_(t,e),e.length-=r.length),0===e.length&&b(this),r;var i=e.needReadable;return e.length-t<=e.highWaterMark&&(i=!0),(e.ended||e.reading)&&(i=!1),i&&(e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1),i&&!e.reading&&(t=u(n,e)),r=t>0?_(t,e):null,null===r&&(e.needReadable=!0,t=0),e.length-=t,0!==e.length||e.ended||(e.needReadable=!0),e.ended&&!e.endEmitted&&0===e.length&&b(this),r},i.prototype._read=function(){this.emit("error",new Error("not implemented"))},i.prototype.pipe=function(t,e){function n(t){t===c&&o()}function i(){t.end()}function o(){t.removeListener("close",a),t.removeListener("finish",u),t.removeListener("drain",d),t.removeListener("error",s),t.removeListener("unpipe",n),c.removeListener("end",i),c.removeListener("end",o),(!t._writableState||t._writableState.needDrain)&&d()}function s(e){l(),t.removeListener("error",s),0===k.listenerCount(t,"error")&&t.emit("error",e)}function a(){t.removeListener("finish",u),l()}function u(){t.removeListener("close",a),l()}function l(){c.unpipe(t)}var c=this,h=this._readableState;switch(h.pipesCount){case 0:h.pipes=t;break;case 1:h.pipes=[h.pipes,t];break;default:h.pipes.push(t)}h.pipesCount+=1;var f=(!e||e.end!==!1)&&t!==r.stdout&&t!==r.stderr,p=f?i:o;h.endEmitted?r.nextTick(p):c.once("end",p),t.on("unpipe",n);var d=g(c);return t.on("drain",d),t._events&&t._events.error?x(t._events.error)?t._events.error.unshift(s):t._events.error=[s,t._events.error]:t.on("error",s),t.once("close",a),t.once("finish",u),t.emit("pipe",c),h.flowing||(this.on("readable",v),h.flowing=!0,r.nextTick(function(){m(c)})),t},i.prototype.unpipe=function(t){var e=this._readableState;if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,this.removeListener("readable",v),e.flowing=!1,t&&t.emit("unpipe",this),this);if(!t){var r=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,this.removeListener("readable",v),e.flowing=!1;for(var i=0;n>i;i++)r[i].emit("unpipe",this);return this}var i=j(e.pipes,t);return-1===i?this:(e.pipes.splice(i,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this),this)
},i.prototype.on=function(t,e){var r=T.prototype.on.call(this,t,e);if("data"!==t||this._readableState.flowing||y(this),"readable"===t&&this.readable){var n=this._readableState;n.readableListening||(n.readableListening=!0,n.emittedReadable=!1,n.needReadable=!0,n.reading?n.length&&h(this,n):this.read(0))}return r},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){y(this),this.read(0),this.emit("resume")},i.prototype.pause=function(){y(this,!0),this.emit("pause")},i.prototype.wrap=function(t){var e=this._readableState,r=!1,n=this;t.on("end",function(){if(e.decoder&&!e.ended){var t=e.decoder.end();t&&t.length&&n.push(t)}n.push(null)}),t.on("data",function(i){if(e.decoder&&(i=e.decoder.write(i)),(!e.objectMode||null!==i&&void 0!==i)&&(e.objectMode||i&&i.length)){var o=n.push(i);o||(r=!0,t.pause())}});for(var i in t)"function"==typeof t[i]&&"undefined"==typeof this[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));var o=["error","close","destroy","pause","resume"];return w(o,function(e){t.on(e,n.emit.bind(n,e))}),n._read=function(){r&&(r=!1,t.resume())},n},i._fromList=_}).call(this,t("_process"))},{_process:60,buffer:53,"core-util-is":67,events:57,inherits:76,isarray:58,stream:72,"string_decoder/":73}],65:[function(t,e){function r(t,e){this.afterTransform=function(t,r){return n(e,t,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function n(t,e,r){var n=t._transformState;n.transforming=!1;var i=n.writecb;if(!i)return t.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,null!==r&&void 0!==r&&t.push(r),i&&i(e);var o=t._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&t._read(o.highWaterMark)}function i(t){if(!(this instanceof i))return new i(t);s.call(this,t);var e=(this._transformState=new r(t,this),this);this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(t){o(e,t)}):o(e)})}function o(t,e){if(e)return t.emit("error",e);var r=t._writableState,n=(t._readableState,t._transformState);if(r.length)throw new Error("calling transform done when ws.length != 0");if(n.transforming)throw new Error("calling transform done when still transforming");return t.push(null)}e.exports=i;var s=t("./_stream_duplex"),a=t("core-util-is");a.inherits=t("inherits"),a.inherits(i,s),i.prototype.push=function(t,e){return this._transformState.needTransform=!1,s.prototype.push.call(this,t,e)},i.prototype._transform=function(){throw new Error("not implemented")},i.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},i.prototype._read=function(){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0}},{"./_stream_duplex":62,"core-util-is":67,inherits:76}],66:[function(t,e){(function(r){function n(t,e,r){this.chunk=t,this.encoding=e,this.callback=r}function i(t,e){t=t||{};var r=t.highWaterMark;this.highWaterMark=r||0===r?r:16384,this.objectMode=!!t.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var n=t.decodeStrings===!1;this.decodeStrings=!n,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){p(e,t)},this.writecb=null,this.writelen=0,this.buffer=[],this.errorEmitted=!1}function o(e){var r=t("./_stream_duplex");return this instanceof o||this instanceof r?(this._writableState=new i(e,this),this.writable=!0,void j.call(this)):new o(e)}function s(t,e,n){var i=new Error("write after end");t.emit("error",i),r.nextTick(function(){n(i)})}function a(t,e,n,i){var o=!0;if(!b.isBuffer(n)&&"string"!=typeof n&&null!==n&&void 0!==n&&!e.objectMode){var s=new TypeError("Invalid non-string/buffer chunk");t.emit("error",s),r.nextTick(function(){i(s)}),o=!1}return o}function u(t,e,r){return t.objectMode||t.decodeStrings===!1||"string"!=typeof e||(e=new b(e,r)),e}function l(t,e,r,i,o){r=u(e,r,i),b.isBuffer(r)&&(i="buffer");var s=e.objectMode?1:r.length;e.length+=s;var a=e.length<e.highWaterMark;return a||(e.needDrain=!0),e.writing?e.buffer.push(new n(r,i,o)):c(t,e,s,r,i,o),a}function c(t,e,r,n,i,o){e.writelen=r,e.writecb=o,e.writing=!0,e.sync=!0,t._write(n,i,e.onwrite),e.sync=!1}function h(t,e,n,i,o){n?r.nextTick(function(){o(i)}):o(i),t._writableState.errorEmitted=!0,t.emit("error",i)}function f(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function p(t,e){var n=t._writableState,i=n.sync,o=n.writecb;if(f(n),e)h(t,n,i,e,o);else{var s=v(t,n);s||n.bufferProcessing||!n.buffer.length||m(t,n),i?r.nextTick(function(){d(t,n,s,o)}):d(t,n,s,o)}}function d(t,e,r,n){r||g(t,e),n(),r&&y(t,e)}function g(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function m(t,e){e.bufferProcessing=!0;for(var r=0;r<e.buffer.length;r++){var n=e.buffer[r],i=n.chunk,o=n.encoding,s=n.callback,a=e.objectMode?1:i.length;if(c(t,e,a,i,o,s),e.writing){r++;break}}e.bufferProcessing=!1,r<e.buffer.length?e.buffer=e.buffer.slice(r):e.buffer.length=0}function v(t,e){return e.ending&&0===e.length&&!e.finished&&!e.writing}function y(t,e){var r=v(t,e);return r&&(e.finished=!0,t.emit("finish")),r}function _(t,e,n){e.ending=!0,y(t,e),n&&(e.finished?r.nextTick(n):t.once("finish",n)),e.ended=!0}e.exports=o;var b=t("buffer").Buffer;o.WritableState=i;var w=t("core-util-is");w.inherits=t("inherits");var j=t("stream");w.inherits(o,j),o.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},o.prototype.write=function(t,e,r){var n=this._writableState,i=!1;return"function"==typeof e&&(r=e,e=null),b.isBuffer(t)?e="buffer":e||(e=n.defaultEncoding),"function"!=typeof r&&(r=function(){}),n.ended?s(this,n,r):a(this,n,t,r)&&(i=l(this,n,t,e,r)),i},o.prototype._write=function(t,e,r){r(new Error("not implemented"))},o.prototype.end=function(t,e,r){var n=this._writableState;"function"==typeof t?(r=t,t=null,e=null):"function"==typeof e&&(r=e,e=null),"undefined"!=typeof t&&null!==t&&this.write(t,e),n.ending||n.finished||_(this,n,r)}}).call(this,t("_process"))},{"./_stream_duplex":62,_process:60,buffer:53,"core-util-is":67,inherits:76,stream:72}],67:[function(t,e,r){(function(t){function e(t){return Array.isArray(t)}function n(t){return"boolean"==typeof t}function i(t){return null===t}function o(t){return null==t}function s(t){return"number"==typeof t}function a(t){return"string"==typeof t}function u(t){return"symbol"==typeof t}function l(t){return void 0===t}function c(t){return h(t)&&"[object RegExp]"===v(t)}function h(t){return"object"==typeof t&&null!==t}function f(t){return h(t)&&"[object Date]"===v(t)}function p(t){return h(t)&&("[object Error]"===v(t)||t instanceof Error)}function d(t){return"function"==typeof t}function g(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function m(e){return t.isBuffer(e)}function v(t){return Object.prototype.toString.call(t)}r.isArray=e,r.isBoolean=n,r.isNull=i,r.isNullOrUndefined=o,r.isNumber=s,r.isString=a,r.isSymbol=u,r.isUndefined=l,r.isRegExp=c,r.isObject=h,r.isDate=f,r.isError=p,r.isFunction=d,r.isPrimitive=g,r.isBuffer=m}).call(this,t("buffer").Buffer)},{buffer:53}],68:[function(t,e){e.exports=t("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":63}],69:[function(t,e,r){var n=t("stream");r=e.exports=t("./lib/_stream_readable.js"),r.Stream=n,r.Readable=r,r.Writable=t("./lib/_stream_writable.js"),r.Duplex=t("./lib/_stream_duplex.js"),r.Transform=t("./lib/_stream_transform.js"),r.PassThrough=t("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":62,"./lib/_stream_passthrough.js":63,"./lib/_stream_readable.js":64,"./lib/_stream_transform.js":65,"./lib/_stream_writable.js":66,stream:72}],70:[function(t,e){e.exports=t("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":65}],71:[function(t,e){e.exports=t("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":66}],72:[function(t,e){function r(){n.call(this)}e.exports=r;var n=t("events").EventEmitter,i=t("inherits");i(r,n),r.Readable=t("readable-stream/readable.js"),r.Writable=t("readable-stream/writable.js"),r.Duplex=t("readable-stream/duplex.js"),r.Transform=t("readable-stream/transform.js"),r.PassThrough=t("readable-stream/passthrough.js"),r.Stream=r,r.prototype.pipe=function(t,e){function r(e){t.writable&&!1===t.write(e)&&l.pause&&l.pause()}function i(){l.readable&&l.resume&&l.resume()}function o(){c||(c=!0,t.end())}function s(){c||(c=!0,"function"==typeof t.destroy&&t.destroy())}function a(t){if(u(),0===n.listenerCount(this,"error"))throw t}function u(){l.removeListener("data",r),t.removeListener("drain",i),l.removeListener("end",o),l.removeListener("close",s),l.removeListener("error",a),t.removeListener("error",a),l.removeListener("end",u),l.removeListener("close",u),t.removeListener("close",u)}var l=this;l.on("data",r),t.on("drain",i),t._isStdio||e&&e.end===!1||(l.on("end",o),l.on("close",s));var c=!1;return l.on("error",a),t.on("error",a),l.on("end",u),l.on("close",u),t.on("close",u),t.emit("pipe",l),t}},{events:57,inherits:76,"readable-stream/duplex.js":61,"readable-stream/passthrough.js":68,"readable-stream/readable.js":69,"readable-stream/transform.js":70,"readable-stream/writable.js":71}],73:[function(t,e,r){function n(t){if(t&&!u(t))throw new Error("Unknown encoding: "+t)}function i(t){return t.toString(this.encoding)}function o(t){this.charReceived=t.length%2,this.charLength=this.charReceived?2:0}function s(t){this.charReceived=t.length%3,this.charLength=this.charReceived?3:0}var a=t("buffer").Buffer,u=a.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},l=r.StringDecoder=function(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),n(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=o;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=s;break;default:return void(this.write=i)}this.charBuffer=new a(6),this.charReceived=0,this.charLength=0};l.prototype.write=function(t){for(var e="";this.charLength;){var r=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";t=t.slice(r,t.length),e=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var n=e.charCodeAt(e.length-1);if(!(n>=55296&&56319>=n)){if(this.charReceived=this.charLength=0,0===t.length)return e;break}this.charLength+=this.surrogateSize,e=""}this.detectIncompleteChar(t);var i=t.length;this.charLength&&(t.copy(this.charBuffer,0,t.length-this.charReceived,i),i-=this.charReceived),e+=t.toString(this.encoding,0,i);var i=e.length-1,n=e.charCodeAt(i);if(n>=55296&&56319>=n){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),t.copy(this.charBuffer,0,0,o),e.substring(0,i)}return e},l.prototype.detectIncompleteChar=function(t){for(var e=t.length>=3?3:t.length;e>0;e--){var r=t[t.length-e];if(1==e&&r>>5==6){this.charLength=2;break}if(2>=e&&r>>4==14){this.charLength=3;break}if(3>=e&&r>>3==30){this.charLength=4;break}}this.charReceived=e},l.prototype.end=function(t){var e="";if(t&&t.length&&(e=this.write(t)),this.charReceived){var r=this.charReceived,n=this.charBuffer,i=this.encoding;e+=n.slice(0,r).toString(i)}return e}},{buffer:53}],74:[function(e,r,n){!function(t){"use strict";t(function(){function t(t){return 0===t.length?"":i(t[0])?t[1]||"":t[0]}function e(t){return 0===t.length?Error:i(t[0])?t[0]:Error}function r(t){return 0===t.length?null:i(t[0])?t[2]:t[1]}function n(t){var e=[];for(var r in t)e.push(r);return e}function i(t){return"function"==typeof t}function o(t){return t&&"object"==typeof t&&"[object Object]"===u.call(t)}function s(t,e){if(o(e))for(var r=n(e),i=0,s=r.length;s>i;++i)t[r[i]]=a(e[r[i]])}function a(t){if(null==t||"object"!=typeof t)return t;var e=t.constructor?t.constructor():Object.create(null);for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}var u=Object.prototype.toString;return function(){function n(t,e){s(this,c),s(this,e),this.message=t||this.message,t instanceof Error?(this.message=t.message,this.stack=t.stack):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}function i(){this.constructor=n}for(var o=new Array(arguments.length),a=0;a<o.length;++a)o[a]=arguments[a];var u=t(o),l=e(o),c=r(o);return i.prototype=l.prototype,n.prototype=new i,n.prototype.name=""+u||"CustomError",n}})}(function(e){if("function"==typeof t&&t.amd)t(e);else if("object"==typeof n)r.exports=e();else{var i=this,o=i.createError,s=i.createError=e();s.noConflict=function(){return i.createError=o,s}}})},{}],75:[function(e,r,n){!function(e,i){"function"==typeof t&&t.amd?t([],i):"object"==typeof n?r.exports=i():e.inflection=i()}(this,function(){var t=["access","accommodation","adulthood","advertising","advice","aggression","aid","air","aircraft","alcohol","anger","applause","arithmetic","art","assistance","athletics","attention","bacon","baggage","ballet","beauty","beef","beer","behavior","biology","blood","botany","bread","business","butter","carbon","cardboard","cash","chalk","chaos","chess","crossroads","countryside","damage","dancing","danger","deer","delight","dessert","dignity","dirt","distribution","dust","economics","education","electricity","employment","energy","engineering","enjoyment","entertainment","envy","equipment","ethics","evidence","evolution","failure","faith","fame","fiction","flour","flu","food","freedom","fruit","fuel","fun","furniture","gallows","garbage","garlic","gas","genetics","glass","gold","golf","gossip","grammar","grass","gratitude","grief","ground","guilt","gymnastics","hair","happiness","hardware","harm","hate","hatred","health","heat","height","help","homework","honesty","honey","hospitality","housework","humour","hunger","hydrogen","ice","importance","inflation","information","injustice","innocence","intelligence","iron","irony","jam","jealousy","jelly","jewelry","joy","judo","juice","justice","karate","kindness","knowledge","labour","lack","land","laughter","lava","leather","leisure","lightning","linguine","linguini","linguistics","literature","litter","livestock","logic","loneliness","love","luck","luggage","macaroni","machinery","magic","mail","management","mankind","marble","mathematics","mayonnaise","measles","meat","metal","methane","milk","money","mud","music","mumps","nature","news","nitrogen","nonsense","nurture","nutrition","obedience","obesity","oil","oxygen","paper","passion","pasta","patience","permission","physics","poetry","pollution","poverty","power","pride","production","progress","pronunciation","psychology","publicity","punctuation","quality","quantity","quartz","racism","rain","recreation","relaxation","reliability","research","respect","revenge","rice","rubbish","rum","safety","salad","salt","sand","satire","scenery","seafood","seaside","series","shame","sheep","shopping","silence","sleep","smoke","smoking","snow","soap","software","soil","sorrow","soup","spaghetti","speed","species","spelling","sport","steam","strength","stuff","stupidity","success","sugar","sunshine","symmetry","tea","tennis","thirst","thunder","timber","time","toast","tolerance","trade","traffic","transportation","travel","trust","understanding","underwear","unemployment","unity","usage","validity","veal","vegetation","vegetarianism","vengeance","violence","vision","vitality","warmth","water","wealth","weather","weight","welfare","wheat","whiskey","width","wildlife","wine","wisdom","wood","wool","work","yeast","yoga","zinc","zoology"],e={plural:{men:new RegExp("^(m)en$","gi"),people:new RegExp("(pe)ople$","gi"),children:new RegExp("(child)ren$","gi"),tia:new RegExp("([ti])a$","gi"),analyses:new RegExp("((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$","gi"),hives:new RegExp("(hi|ti)ves$","gi"),curves:new RegExp("(curve)s$","gi"),lrves:new RegExp("([lr])ves$","gi"),foves:new RegExp("([^fo])ves$","gi"),movies:new RegExp("(m)ovies$","gi"),aeiouyies:new RegExp("([^aeiouy]|qu)ies$","gi"),series:new RegExp("(s)eries$","gi"),xes:new RegExp("(x|ch|ss|sh)es$","gi"),mice:new RegExp("([m|l])ice$","gi"),buses:new RegExp("(bus)es$","gi"),oes:new RegExp("(o)es$","gi"),shoes:new RegExp("(shoe)s$","gi"),crises:new RegExp("(cris|ax|test)es$","gi"),octopi:new RegExp("(octop|vir)i$","gi"),aliases:new RegExp("(alias|status)es$","gi"),summonses:new RegExp("^(summons)es$","gi"),oxen:new RegExp("^(ox)en","gi"),matrices:new RegExp("(matr)ices$","gi"),vertices:new RegExp("(vert|ind)ices$","gi"),feet:new RegExp("^feet$","gi"),teeth:new RegExp("^teeth$","gi"),geese:new RegExp("^geese$","gi"),quizzes:new RegExp("(quiz)zes$","gi"),whereases:new RegExp("^(whereas)es$","gi"),ss:new RegExp("ss$","gi"),s:new RegExp("s$","gi")},singular:{man:new RegExp("^(m)an$","gi"),person:new RegExp("(pe)rson$","gi"),child:new RegExp("(child)$","gi"),ox:new RegExp("^(ox)$","gi"),axis:new RegExp("(ax|test)is$","gi"),octopus:new RegExp("(octop|vir)us$","gi"),alias:new RegExp("(alias|status)$","gi"),summons:new RegExp("^(summons)$","gi"),bus:new RegExp("(bu)s$","gi"),buffalo:new RegExp("(buffal|tomat|potat)o$","gi"),tium:new RegExp("([ti])um$","gi"),sis:new RegExp("sis$","gi"),ffe:new RegExp("(?:([^f])fe|([lr])f)$","gi"),hive:new RegExp("(hi|ti)ve$","gi"),aeiouyy:new RegExp("([^aeiouy]|qu)y$","gi"),x:new RegExp("(x|ch|ss|sh)$","gi"),matrix:new RegExp("(matr)ix$","gi"),vertex:new RegExp("(vert|ind)ex$","gi"),mouse:new RegExp("([m|l])ouse$","gi"),foot:new RegExp("^foot$","gi"),tooth:new RegExp("^tooth$","gi"),goose:new RegExp("^goose$","gi"),quiz:new RegExp("(quiz)$","gi"),whereas:new RegExp("^(whereas)$","gi"),s:new RegExp("s$","gi"),common:new RegExp("$","gi")}},r=[[e.plural.men],[e.plural.people],[e.plural.children],[e.plural.tia],[e.plural.analyses],[e.plural.hives],[e.plural.curves],[e.plural.lrves],[e.plural.foves],[e.plural.aeiouyies],[e.plural.series],[e.plural.movies],[e.plural.xes],[e.plural.mice],[e.plural.buses],[e.plural.oes],[e.plural.shoes],[e.plural.crises],[e.plural.octopi],[e.plural.aliases],[e.plural.summonses],[e.plural.oxen],[e.plural.matrices],[e.plural.feet],[e.plural.teeth],[e.plural.geese],[e.plural.quizzes],[e.plural.whereases],[e.singular.man,"$1en"],[e.singular.person,"$1ople"],[e.singular.child,"$1ren"],[e.singular.ox,"$1en"],[e.singular.axis,"$1es"],[e.singular.octopus,"$1i"],[e.singular.alias,"$1es"],[e.singular.summons,"$1es"],[e.singular.bus,"$1ses"],[e.singular.buffalo,"$1oes"],[e.singular.tium,"$1a"],[e.singular.sis,"ses"],[e.singular.ffe,"$1$2ves"],[e.singular.hive,"$1ves"],[e.singular.aeiouyy,"$1ies"],[e.singular.x,"$1es"],[e.singular.matrix,"$1ices"],[e.singular.vertex,"$1ices"],[e.singular.mouse,"$1ice"],[e.singular.foot,"feet"],[e.singular.tooth,"teeth"],[e.singular.goose,"geese"],[e.singular.quiz,"$1zes"],[e.singular.whereas,"$1es"],[e.singular.s,"s"],[e.singular.common,"s"]],n=[[e.singular.man],[e.singular.person],[e.singular.child],[e.singular.ox],[e.singular.axis],[e.singular.octopus],[e.singular.alias],[e.singular.summons],[e.singular.bus],[e.singular.buffalo],[e.singular.tium],[e.singular.sis],[e.singular.ffe],[e.singular.hive],[e.singular.aeiouyy],[e.singular.x],[e.singular.matrix],[e.singular.mouse],[e.singular.foot],[e.singular.tooth],[e.singular.goose],[e.singular.quiz],[e.singular.whereas],[e.plural.men,"$1an"],[e.plural.people,"$1rson"],[e.plural.children,"$1"],[e.plural.tia,"$1um"],[e.plural.analyses,"$1$2sis"],[e.plural.hives,"$1ve"],[e.plural.curves,"$1"],[e.plural.lrves,"$1f"],[e.plural.foves,"$1fe"],[e.plural.movies,"$1ovie"],[e.plural.aeiouyies,"$1y"],[e.plural.series,"$1eries"],[e.plural.xes,"$1"],[e.plural.mice,"$1ouse"],[e.plural.buses,"$1"],[e.plural.oes,"$1"],[e.plural.shoes,"$1"],[e.plural.crises,"$1is"],[e.plural.octopi,"$1us"],[e.plural.aliases,"$1"],[e.plural.summonses,"$1"],[e.plural.oxen,"$1"],[e.plural.matrices,"$1ix"],[e.plural.vertices,"$1ex"],[e.plural.feet,"foot"],[e.plural.teeth,"tooth"],[e.plural.geese,"goose"],[e.plural.quizzes,"$1"],[e.plural.whereases,"$1"],[e.plural.ss,"ss"],[e.plural.s,""]],i=["and","or","nor","a","an","the","so","but","to","of","at","by","from","into","on","onto","off","out","in","over","with","for"],o=new RegExp("(_ids|_id)$","g"),s=new RegExp("_","g"),a=new RegExp("[ _]","g"),u=new RegExp("([A-Z])","g"),l=new RegExp("^_"),c={_apply_rules:function(t,e,r,n){if(n)t=n;else{var i=c.indexOf(r,t.toLowerCase())>-1;if(!i)for(var o=0,s=e.length;s>o;o++)if(t.match(e[o][0])){void 0!==e[o][1]&&(t=t.replace(e[o][0],e[o][1]));break}}return t},indexOf:function(t,e,r,n){r||(r=-1);for(var i=-1,o=r,s=t.length;s>o;o++)if(t[o]===e||n&&n(t[o],e)){i=o;break}return i},pluralize:function(e,n){return c._apply_rules(e,r,t,n)},singularize:function(e,r){return c._apply_rules(e,n,t,r)},inflect:function(e,i,o,s){return i=parseInt(i,10),isNaN(i)?e:0===i||i>1?c._apply_rules(e,r,t,s):c._apply_rules(e,n,t,o)},camelize:function(t,e){for(var r,n,i,o,s=t.split("/"),a=0,u=s.length;u>a;a++){for(r=s[a].split("_"),n=0,i=r.length;i>n;n++)0!==n&&(r[n]=r[n].toLowerCase()),o=r[n].charAt(0),o=e&&0===a&&0===n?o.toLowerCase():o.toUpperCase(),r[n]=o+r[n].substring(1);s[a]=r.join("")}return s.join("::")},underscore:function(t,e){if(e&&t===t.toUpperCase())return t;for(var r=t.split("::"),n=0,i=r.length;i>n;n++)r[n]=r[n].replace(u,"_$1"),r[n]=r[n].replace(l,"");return r.join("/").toLowerCase()},humanize:function(t,e){return t=t.toLowerCase(),t=t.replace(o,""),t=t.replace(s," "),e||(t=c.capitalize(t)),t},capitalize:function(t){return t=t.toLowerCase(),t.substring(0,1).toUpperCase()+t.substring(1)},dasherize:function(t){return t.replace(a,"-")},titleize:function(t){t=t.toLowerCase().replace(s," ");for(var e,r,n,o=t.split(" "),a=0,u=o.length;u>a;a++){for(e=o[a].split("-"),r=0,n=e.length;n>r;r++)c.indexOf(i,e[r].toLowerCase())<0&&(e[r]=c.capitalize(e[r]));o[a]=e.join("-")}return t=o.join(" "),t=t.substring(0,1).toUpperCase()+t.substring(1)},demodulize:function(t){var e=t.split("::");return e[e.length-1]},tableize:function(t){return t=c.underscore(t),t=c.pluralize(t)},classify:function(t){return t=c.camelize(t),t=c.singularize(t)},foreign_key:function(t,e){return t=c.demodulize(t),t=c.underscore(t)+(e?"":"_")+"id"},ordinalize:function(t){for(var e=t.split(" "),r=0,n=e.length;n>r;r++){var i=parseInt(e[r],10);if(!isNaN(i)){var o=e[r].substring(e[r].length-2),s=e[r].substring(e[r].length-1),a="th";"11"!=o&&"12"!=o&&"13"!=o&&("1"===s?a="st":"2"===s?a="nd":"3"===s&&(a="rd")),e[r]+=a}}return e.join(" ")},transform:function(t,e){for(var r=0,n=e.length;n>r;r++){var i=e[r];this.hasOwnProperty(i)&&(t=this[i](t))}return t}};return c.version="1.5.1",c})},{}],76:[function(t,e){e.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},{}],77:[function(t,e){"use strict";function r(){return r.initialize.apply(null,arguments)}var n=t("./lib/raw");r.raw=function(t,e){return new n(t,e)};var i=function(){return t("./lib/dialects/mysql")},o=function(){return t("./lib/dialects/mysql2")},s=function(){return t("./lib/dialects/maria")},a=function(){return t("./lib/dialects/oracle")},u=function(){return t("./lib/dialects/postgres")},l=function(){return t("./lib/dialects/sqlite3")},c=function(){return t("./lib/dialects/websql")},h=r.Clients={mysql:i,mysql2:o,maria:s,mariadb:s,mariasql:s,oracle:a,pg:u,postgres:u,postgresql:u,sqlite:l,sqlite3:l,websql:c},f=t("./lib/query/methods");r.initialize=function(e){function r(t){var r=new i.QueryBuilder;return e.__transactor__&&r.transacting(e.__transactor__),t?r.table(t):r}var n,i,o=t("events").EventEmitter,s=new o;for(var a in s)r[a]=s[a];if(r.VERSION=r.__knex__="0.7.3",r.raw=function(t,r){var n=new i.Raw(t,r);return e.__transactor__&&n.transacting(e.__transactor__),n},r.transaction=function(t){return new i.Transaction(t)},r.destroy=function(t){return this.client.destroy(t)},e.__client__)i=e.__client__;else{var u=e.client||e.dialect;if(!h[u])throw new Error(u+" is not a valid Knex client, did you misspell it?");r.toString=function(){return"[object Knex:"+u+"]"},n=h[u](),i=new n(e),i.on("start",function(t){r.emit("start",t)}),i.on("query",function(t){r.emit("query",t)})}return f.forEach(function(t){r[t]=function(){var e=r();return e[t].apply(e,arguments)}}),r.client=i,Object.defineProperties(r,{schema:{get:function(){i.SchemaBuilder||i.initSchema();var t=new i.SchemaBuilder;return e.__transactor__&&t.transacting(e.__transactor__),t}},migrate:{get:function(){return i.Migrator||i.initMigrator(),new i.Migrator(r)}},seed:{get:function(){return i.Seeder||i.initSeeder(),new i.Seeder(r)}},fn:{get:function(){return i.FunctionHelper||i.initFunctionHelper(),i.FunctionHelper}}}),r},e.exports=r},{"./lib/dialects/maria":52,"./lib/dialects/mysql":52,"./lib/dialects/mysql2":52,"./lib/dialects/oracle":52,"./lib/dialects/postgres":52,"./lib/dialects/sqlite3":52,"./lib/dialects/websql":95,"./lib/query/methods":107,"./lib/raw":108,events:57}],78:[function(t,e){"use strict";function r(t){this.initFormatter(),this.initRaw(),this.initTransaction(),this.initQuery(),this.migrationConfig=i.clone(t&&t.migrations),this.seedConfig=i.clone(t&&t.seeds)}var n=t("./promise"),i=t("lodash"),o=t("inherits"),s=t("events").EventEmitter;o(r,s),r.prototype.isDebugging=!1,r.prototype.acquireConnection=function(){var t=this.pool;return new n(function(e,r){return t?void t.acquire(function(t,n){return t?r(t):void e(n)}):r(new Error("There is no pool defined on the current client"))})},r.prototype.releaseConnection=function(t){var e=this.pool;return new n(function(r,n){e.release(t,function(e){return e?n(e):void r(t)})})},r.prototype.destroy=function(t){var e=this.pool,r=new n(function(t,r){e||t(),e.destroy(function(e){return e?r(e):void t()})});return"function"!=typeof t?r:void r.exec(t)},r.prototype.database=function(){return this.databaseName||this.connectionSettings.database},e.exports=r},{"./promise":103,events:57,inherits:76,lodash:130}],79:[function(t,e,r){(function(t){"use strict";function e(t,e){for(t=t.toString();t.length<e;)t="0"+t;return t}function n(t){if("Z"===t)return 0;var e=t.match(/([\+\-\s])(\d\d):?(\d\d)?/);return e?("-"===e[1]?-1:1)*(parseInt(e[2],10)+(e[3]?parseInt(e[3],10):0)/60)*60:!1}var i=r;i.escapeId=function(t,e){return Array.isArray(t)?t.map(function(t){return i.escapeId(t,e)}).join(", "):e?"`"+t.replace(/`/g,"``")+"`":"`"+t.replace(/`/g,"``").replace(/\./g,"`.`")+"`"},i.escape=function(e,r,n){if(void 0===e||null===e)return"NULL";switch(typeof e){case"boolean":return e?"true":"false";case"number":return e+""}if(e instanceof Date&&(e=i.dateToString(e,n||"local")),t.isBuffer(e))return i.bufferToString(e);if(Array.isArray(e))return i.arrayToList(e,n);if("object"==typeof e){if(!r)return i.objectToValues(e,n);e=e.toString()}return e=e.replace(/[\0\n\r\b\t\\\'\"\x1a]/g,function(t){switch(t){case"\x00":return"\\0";case"\n":return"\\n";case"\r":return"\\r";case"\b":return"\\b";case"	":return"\\t";case"":return"\\Z";default:return"\\"+t}}),"'"+e+"'"},i.arrayToList=function(t,e){return t.map(function(t){return Array.isArray(t)?"("+i.arrayToList(t,e)+")":i.escape(t,!0,e)}).join(", ")},i.format=function(t,e,r,n){return e=e?[].concat(e):[],t.replace(/\?\??/g,function(t){return e.length?"??"===t?i.escapeId(e.shift()):i.escape(e.shift(),r,n):t})},i.dateToString=function(t,r){var i=new Date(t);if("local"!==r){var o=n(r);i.setTime(i.getTime()+6e4*i.getTimezoneOffset()),o!==!1&&i.setTime(i.getTime()+6e4*o)}var s=i.getFullYear(),a=e(i.getMonth()+1,2),u=e(i.getDate(),2),l=e(i.getHours(),2),c=e(i.getMinutes(),2),h=e(i.getSeconds(),2),f=e(i.getMilliseconds(),3);return s+"-"+a+"-"+u+" "+l+":"+c+":"+h+"."+f},i.bufferToString=function(t){var r="";try{r=t.toString("hex")}catch(n){for(var i=0;i<t.length;i++){var o=t[i];r+=e(o.toString(16))}}return"X'"+r+"'"},i.objectToValues=function(t,e){var r=[];for(var n in t){var o=t[n];"function"!=typeof o&&r.push(this.escapeId(n)+" = "+i.escape(o,!0,e))}return r.join(", ")}}).call(this,t("buffer").Buffer)},{buffer:53}],80:[function(t,e){"use strict";e.exports=function(e){function r(){this.client=e,n.apply(this,arguments)}var n=t("../../formatter"),i=t("inherits");i(r,n),r.prototype.operators=["=","<",">","<=",">=","<>","!=","like","not like","between","ilike","&","|","<<",">>"],r.prototype.wrapValue=function(t){return"*"!==t?'"'+t+'"':"*"};var o=function(){var t=Object.create(null);return function(e){return void 0===t[e]&&(t[e]=this._wrapString(e)),t[e]}}();r.prototype._wrap=o,e.Formatter=r}},{"../../formatter":97,inherits:76}],81:[function(t,e){"use strict";e.exports=function(e){var r=t("../../functionhelper"),n=Object.create(r);n.client=e,e.FunctionHelper=n}},{"../../functionhelper":98}],82:[function(t,e){"use strict";function r(t){i.apply(this,arguments),t.debug&&(this.isDebugging=!0),t.connection&&(this.initDriver(),this.initRunner(),this.connectionSettings=t.connection,this.initPool(),this.pool=new this.Pool(t.pool))}var n=t("inherits"),i=t("../../client"),o=t("../../promise");n(r,i);var s;r.prototype.dialect="sqlite3",r.prototype.initTransaction=function(){t("./transaction")(this)},r.prototype.initFormatter=function(){t("./formatter")(this)},r.prototype.initDriver=function(){s=s||t("sqlite3")},r.prototype.initRaw=function(){t("./raw")(this)},r.prototype.initFunctionHelper=function(){t("./functionhelper")(this)},r.prototype.initQuery=function(){t("./query")(this)},r.prototype.initPool=function(){t("./pool")(this)},r.prototype.initRunner=function(){t("./runner")(this)},r.prototype.initSchema=function(){t("./schema")(this)},r.prototype.initMigrator=function(){t("./migrator")(this)},r.prototype.initSeeder=function(){t("./seeder")(this)},r.prototype.acquireRawConnection=function(){var t=this;return new o(function(e,r){var n=new s.Database(t.connectionSettings.filename,function(t){return t?r(t):void e(n)})})},r.prototype.destroyRawConnection=o.method(function(t){t.close()}),e.exports=r},{"../../client":78,"../../promise":103,"./formatter":80,"./functionhelper":81,"./migrator":83,"./pool":84,"./query":85,"./raw":86,"./runner":87,"./schema":90,"./seeder":93,"./transaction":94,inherits:76,sqlite3:52}],83:[function(t,e){"use strict";e.exports=function(e){function r(){this.client=e,n.apply(this,arguments)}var n=t("../../migrate"),i=t("inherits");i(r,n),e.Migrator=r}},{"../../migrate":101,inherits:76}],84:[function(t,e){"use strict";e.exports=function(e){function r(){this.client=e,n.apply(this,arguments)}var n=t("../../pool"),i=t("inherits"),o=t("lodash");i(r,n),r.prototype.defaults=function(){return o.extend(n.prototype.defaults.call(this),{max:1,min:1,destroy:function(t){t.close()}})},e.Pool=r}},{"../../pool":102,inherits:76,lodash:130}],85:[function(t,e){"use strict";e.exports=function(e){function r(){this.client=e,s.apply(this,arguments)}function n(){this.formatter=new e.Formatter,a.apply(this,arguments)}var i=t("lodash"),o=t("inherits"),s=t("../../query/builder"),a=t("../../query/compiler");o(r,s),o(n,a),n.prototype.forShare=n.prototype.forUpdate=function(){return""},n.prototype.insert=function(){var t=this.single.insert,e="insert into "+this.tableName+" ";if(i.isArray(t)&&1===t.length&&i.isEmpty(t[0])&&(t=[]),i.isEmpty(t)&&!i.isFunction(t))return e+"default values";var r=this._prepInsert(t);if(i.isString(r))return e+r;if(e+="("+this.formatter.columnize(r.columns)+")",1===r.values.length)return e+" values ("+this.formatter.parameterize(r.values[0])+")";
for(var n=[],o=0,s=r.values.length;s>o;o++){for(var a=n[o]=[],u=r.values[o],l=0,c=r.columns.length;c>l;l++)a.push(this.formatter.parameter(u[l])+" as "+this.formatter.wrap(r.columns[l]));n[o]=a.join(", ")}return e+" select "+n.join(" union all select ")},n.prototype.truncate=function(){var t=this.tableName;return{sql:"delete from sqlite_sequence where name = "+this.tableName,output:function(){return this.query({sql:"delete from "+t})}}},n.prototype.columnInfo=function(){var t=this.single.columnInfo;return{sql:"PRAGMA table_info("+this.single.table+")",output:function(e){var r=/.*\((\d+)\)/,n=i.reduce(e,function(t,e){var n=e.type,i=(i=n.match(r))&&i[1];return n=i?n.split("(")[0]:n,t[e.name]={type:n.toLowerCase(),maxLength:i,nullable:!e.notnull,defaultValue:e.dflt_value},t},{});return t&&n[t]||n}}},n.prototype.limit=function(){return this.single.limit||this.single.offset?"limit "+this.formatter.parameter(this.single.offset&&!this.single.limit?-1:this.single.limit):""},e.QueryBuilder=r,e.QueryCompiler=n}},{"../../query/builder":104,"../../query/compiler":105,inherits:76,lodash:130}],86:[function(t,e){"use strict";e.exports=function(e){function r(){this.client=e,n.apply(this,arguments)}var n=t("../../raw"),i=t("inherits");i(r,n),e.Raw=r}},{"../../raw":108,inherits:76}],87:[function(t,e){"use strict";e.exports=function(e){function r(){this.client=e,o.apply(this,arguments)}var n=t("lodash"),i=t("../../promise"),o=t("../../runner"),s=t("../../helpers"),a=t("inherits");a(r,o),r.prototype._beginTransaction="begin transaction;",r.prototype._query=i.method(function(t){var e=t.method;this.isDebugging()&&this.debug(t);var r;switch(e){case"insert":case"update":case"counter":case"del":r="run";break;default:r="all"}var n=this.connection;return new i(function(e,i){return n&&n[r]?void n[r](t.sql,t.bindings,function(r,n){return r?i(r):(t.response=n,t.context=this,e(t))}):i(new Error("Error calling "+r+" on connection."))})}),r.prototype._stream=i.method(function(t,e){var r=this;return new i(function(n,i){return e.on("error",i),e.on("end",n),r.query(t).map(function(t){e.write(t)}).catch(function(t){e.emit("error",t)}).then(function(){e.end()})})}),r.prototype.processResponse=function(t){var e=t.context,r=t.response;if(t.output)return t.output.call(this,r);switch(t.method){case"select":case"pluck":case"first":return r=s.skim(r),"pluck"===t.method&&(r=n.pluck(r,t.pluck)),"first"===t.method?r[0]:r;case"insert":return[e.lastID];case"del":case"update":case"counter":return e.changes;default:return r}},e.Runner=r}},{"../../helpers":99,"../../promise":103,"../../runner":109,inherits:76,lodash:130}],88:[function(t,e){"use strict";e.exports=function(e){function r(){this.client=e,o.ColumnBuilder.apply(this,arguments)}function n(){this.modifiers=["nullable","defaultTo"],this.Formatter=e.Formatter,o.ColumnCompiler.apply(this,arguments)}var i=t("inherits"),o=t("../../../schema");i(r,o.ColumnBuilder),i(n,o.ColumnCompiler),n.prototype.double=n.prototype.decimal=n.prototype.floating="float",n.prototype.timestamp="datetime",e.ColumnBuilder=r,e.ColumnCompiler=n}},{"../../../schema":114,inherits:76}],89:[function(t,e){"use strict";e.exports=function(e){function r(t,r,i){this.tableCompiler=r,this.pragma=i,this.runner=t,this.formatter=new e.Formatter,this.tableName=this.tableCompiler.tableNameRaw,this.alteredName="_knex_temp_alter"+n.uniqueId()}var n=t("lodash"),i=t("../../../promise");r.prototype.getColumn=i.method(function(t){var e=n.findWhere(this.pragma,{name:t});if(!e)throw new Error("The column "+t+" is not in the "+this.tableName+" table");return e}),r.prototype.ensureTransaction=i.method(function(){return this.runner.transaction?void 0:this.runner.beginTransaction()}),r.prototype.commitTransaction=i.method(function(){return this.runner.transaction?void 0:this.runner.commitTransaction()}),r.prototype.rollbackTransaction=function(t){if(this.runner.transaction)throw t;return this.runner.rollbackTransaction().throw(t)},r.prototype.getTableSql=function(){return this.runner.query({sql:'SELECT name, sql FROM sqlite_master WHERE type="table" AND name="'+this.tableName+'"'})},r.prototype.renameTable=i.method(function(){return this.runner.query({sql:'ALTER TABLE "'+this.tableName+'" RENAME TO "'+this.alteredName+'"'})}),r.prototype.dropOriginal=function(){return this.runner.query({sql:'DROP TABLE "'+this.tableName+'"'})},r.prototype.dropTempTable=function(){return this.runner.query({sql:'DROP TABLE "'+this.alteredName+'"'})},r.prototype.copyData=function(){return this.runner.query({sql:'SELECT * FROM "'+this.tableName+'"'}).bind(this).then(this.insertChunked(20,this.alteredName))},r.prototype.reinsertData=function(t){return function(){return this.runner.query({sql:'SELECT * FROM "'+this.alteredName+'"'}).bind(this).then(this.insertChunked(20,this.tableName,t))}},r.prototype.insertChunked=function(t,r,o){return o=o||function(t){return t},function(t){var s=[],a=this;return i.reduce(t,function(i,u){return i++,s.push(u),i%20===0||i===t.length?(new e.QueryBuilder).connection(a.runner.connection).table(r).insert(n.map(s,o)).then(function(){s=[]}).thenReturn(i):i},0)}},r.prototype.createTempTable=function(t){return function(){return this.runner.query({sql:t.sql.replace(this.tableName,this.alteredName)})}},r.prototype.renameColumn=i.method(function(t,e){var r;return this.ensureTransaction().bind(this).then(function(){return this.getColumn(t)}).tap(function(t){r=t}).then(this.getTableSql).then(function(o){var s=o[0],a=this.formatter.wrap(t)+" "+r.type,u=this.formatter.wrap(e)+" "+r.type;if(-1===s.sql.indexOf(a))throw new Error("Unable to find the column to change");return i.bind(this).then(this.createTempTable(s)).then(this.copyData).then(this.dropOriginal).then(function(){return this.runner.query({sql:s.sql.replace(a,u)})}).then(this.reinsertData(function(r){return r[e]=r[t],n.omit(r,t)})).then(this.dropTempTable)}).tap(this.commitTransaction).catch(this.rollbackTransaction)}),r.prototype.dropColumn=i.method(function(t){var e;return this.ensureTransaction().bind(this).then(function(){return this.getColumn(t)}).tap(function(t){e=t}).then(this.getTableSql).then(function(r){var o=r[0],s=this.formatter.wrap(t)+" "+e.type+", ";if(-1===o.sql.indexOf(s))throw new Error("Unable to find the column to change");return i.bind(this).then(this.createTempTable(o)).then(this.copyData).then(this.dropOriginal).then(function(){return this.runner.query({sql:o.sql.replace(s,"")})}).then(this.reinsertData(function(e){return n.omit(e,t)})).then(this.dropTempTable)}).tap(this.commitTransaction).catch(this.rollbackTransaction)}),e.SQLite3_DDL=r}},{"../../../promise":103,lodash:130}],90:[function(t,e){"use strict";e.exports=function(e){t("./ddl")(e),t("./schema")(e),t("./table")(e),t("./column")(e)}},{"./column":88,"./ddl":89,"./schema":91,"./table":92}],91:[function(t,e){"use strict";e.exports=function(e){function r(){this.client=e,s.Builder.apply(this,arguments)}function n(){this.client=e,this.Formatter=e.Formatter,s.Compiler.apply(this,arguments)}var i=t("lodash"),o=t("inherits"),s=t("../../../schema");o(r,s.Builder),o(n,s.Compiler),n.prototype.hasTable=function(t){this.pushQuery({sql:"select * from sqlite_master where type = 'table' and name = "+this.formatter.parameter(t),output:function(t){return t.length>0}})},n.prototype.hasColumn=function(t,e){this.pushQuery({sql:"PRAGMA table_info("+this.formatter.wrap(t)+")",output:function(t){return i.some(t,{name:e})}})},n.prototype.renameTable=function(t,e){this.pushQuery("alter table "+this.formatter.wrap(t)+" rename to "+this.formatter.wrap(e))},e.SchemaBuilder=r,e.SchemaCompiler=n}},{"../../../schema":114,inherits:76,lodash:130}],92:[function(t,e){"use strict";e.exports=function(e){function r(){this.client=e,s.TableBuilder.apply(this,arguments)}function n(){this.client=e,this.Formatter=e.Formatter,this.SQLite3_DDL=e.SQLite3_DDL,this.primaryKey=void 0,s.TableCompiler.apply(this,arguments)}var i=t("lodash"),o=t("inherits"),s=t("../../../schema");o(r,s.TableBuilder),o(n,s.TableCompiler),n.prototype.createQuery=function(t,e){var r=e?"create table if not exists ":"create table ",n=r+this.tableName()+" ("+t.sql.join(", ");n+=this.foreignKeys()||"",n+=this.primaryKeys()||"",n+=")",this.pushQuery(n)},n.prototype.addColumns=function(t){for(var e=0,r=t.sql.length;r>e;e++)this.pushQuery({sql:"alter table "+this.tableName()+" add column "+t.sql[e],bindings:t.bindings[e]})},n.prototype.dropUnique=function(t,e){e=e||this._indexCommand("unique",this.tableNameRaw,t),this.pushQuery("drop index "+e)},n.prototype.dropIndex=function(t,e){e=e||this._indexCommand("index",this.tableNameRaw,t),this.pushQuery("drop index "+e)},n.prototype.unique=function(t,e){e=e||this._indexCommand("unique",this.tableNameRaw,t),t=this.formatter.columnize(t),this.pushQuery("create unique index "+e+" on "+this.tableName()+" ("+t+")")},n.prototype.index=function(t,e){e=e||this._indexCommand("index",this.tableNameRaw,t),t=this.formatter.columnize(t),this.pushQuery("create index "+e+" on "+this.tableName()+" ("+t+")")},n.prototype.primary=n.prototype.foreign=function(){"create"!==this.method&&console.warn("SQLite3 Foreign & Primary keys may only be added on create")},n.prototype.primaryKeys=function(){var t=i.where(this.grouped.alterTable||[],{method:"primary"});if(t.length>0&&t[0].args.length>0){var e=i.isArray(t[0].args[0])?t[0].args[0]:t[0].args;return", primary key ("+this.formatter.columnize(e)+")"}},n.prototype.foreignKeys=function(){for(var t="",e=i.where(this.grouped.alterTable||[],{method:"foreign"}),r=0,n=e.length;n>r;r++){var o=e[r].args[0],s=this.formatter.columnize(o.column),a=this.formatter.columnize(o.references),u=this.formatter.wrap(o.inTable);t+=", foreign key("+s+") references "+u+"("+a+")",o.onDelete&&(t+=" on delete "+o.onDelete),o.onUpdate&&(t+=" on update "+o.onUpdate)}return t},n.prototype.createTableBlock=function(){return this.getColumns().concat().join(",")},n.prototype.renameColumn=function(t,e){var r=this;this.pushQuery({sql:"PRAGMA table_info("+this.tableName()+")",output:function(n){return new r.SQLite3_DDL(this,r,n).renameColumn(t,e)}})},n.prototype.dropColumn=function(t){var e=this;this.pushQuery({sql:"PRAGMA table_info("+this.tableName()+")",output:function(r){return new e.SQLite3_DDL(this,e,r).dropColumn(t)}})},e.TableBuilder=r,e.TableCompiler=n}},{"../../../schema":114,inherits:76,lodash:130}],93:[function(t,e){"use strict";e.exports=function(e){function r(){this.client=e,n.apply(this,arguments)}var n=t("../../seed"),i=t("inherits");i(r,n),e.Seeder=r}},{"../../seed":117,inherits:76}],94:[function(t,e){"use strict";e.exports=function(e){function r(){this.client=e,i.apply(this,arguments)}var n=t("inherits"),i=t("../../transaction");n(r,i),e.Transaction=r}},{"../../transaction":118,inherits:76}],95:[function(t,e){"use strict";function r(t){t=t||{},o.super_.apply(this,arguments),t.debug&&(this.isDebugging=!0),this.name=t.name||"knex_database",this.version=t.version||"1.0",this.displayName=t.displayName||this.name,this.estimatedSize=t.estimatedSize||5242880,this.initDriver(),this.initRunner(),this.transaction=function(){return this}}var n=t("inherits"),i=t("lodash"),o=t("../sqlite3/index"),s=t("../../promise");n(r,o),r.prototype.dialect="websql",r.prototype.initDriver=function(){},r.prototype.initPool=function(){},r.prototype.initMigrator=function(){},r.prototype.initRunner=function(){t("./runner")(this)},r.prototype.acquireConnection=function(){var t=this;return new s(function(e,r){try{var n=openDatabase(t.name,t.version,t.displayName,t.estimatedSize);n.transaction(function(t){t.__cid=i.uniqueId("__cid"),e(t)})}catch(o){r(o)}})},r.prototype.releaseConnection=s.method(function(){}),e.exports=r},{"../../promise":103,"../sqlite3/index":82,"./runner":96,inherits:76,lodash:130}],96:[function(t,e){"use strict";e.exports=function(e){function r(){i.apply(this,arguments)}var n=t("../../promise");t("../sqlite3/runner")(e);var i=e.Runner,o=t("inherits"),s=t("lodash");o(r,i),r.prototype._query=n.method(function(t){this.isDebugging()&&this.debug(t);var e=this.connection;return new n(function(r,n){return e?void e.executeSql(t.sql,t.bindings,function(e,n){return t.response=n,r(t)},function(t,e){console.error(e),n(e)}):n(new Error("No connection provided."))})}),r.prototype._beginTransaction=null,r.prototype._commitTransaction=null,r.prototype._rollbackTransaction=null,r.prototype.processResponse=function(t){var e=t.response;if(t.output)return t.output.call(this,e);switch(t.method){case"pluck":case"first":case"select":for(var r=[],n=0,i=e.rows.length;i>n;n++)r[n]=s.clone(e.rows.item(n));return"pluck"===t.method&&(r=s.pluck(r,t.pluck)),"first"===t.method?r[0]:r;case"insert":return[e.insertId];case"delete":case"update":case"counter":return e.rowsAffected;default:return e}},e.Runner=r}},{"../../promise":103,"../sqlite3/runner":87,inherits:76,lodash:130}],97:[function(t,e){"use strict";function r(){this.bindings=[]}var n=t("lodash"),i=t("./query/builder"),o=t("./raw"),s=Array.prototype.push,a=["asc","desc"];r.prototype.parameterize=function(t){return n.isFunction(t)?this.parameter(t):(t=n.isArray(t)?t:[t],n.map(t,this.parameter,this).join(", "))},r.prototype.parameter=function(t){return n.isFunction(t)?this.outputQuery(this.compileCallback(t),!0):this.checkRaw(t,!0)||"?"},r.prototype.checkRaw=function(t,e){if(t instanceof i){var r=t.toSQL();return r.bindings&&s.apply(this.bindings,r.bindings),this.outputQuery(r)}return t instanceof o?(t.bindings&&s.apply(this.bindings,t.bindings),t.sql):void(e&&this.bindings.push(t))},r.prototype.rawOrFn=function(t,e){return n.isFunction(t)?this.outputQuery(this.compileCallback(t,e)):this.checkRaw(t)||""},r.prototype.wrap=function(t){var e;return n.isFunction(t)?this.outputQuery(this.compileCallback(t),!0):(e=this.checkRaw(t),e?e:n.isNumber(t)?t:this._wrap(t+""))},r.prototype._wrapString=function(t){var e,r=t.toLowerCase().indexOf(" as ");if(-1!==r){var n=t.slice(0,r),i=t.slice(r+4);return this.wrap(n)+" as "+this.wrap(i)}var o=[];e=t.split(".");for(var s=0,a=e.length;a>s;s=++s)t=e[s],o.push(0===s&&e.length>1?this.wrap((t||"").trim()):this.wrapValue((t||"").trim()));return o.join(".")},r.prototype.columnize=function(t){var e=n.isString(t)?[t]:t;return n.map(e,this.wrap,this).join(", ")},r.prototype.operator=function(t){var e=this.checkRaw(t);if(e)return e;if(!n.contains(this.operators,(t||"").toLowerCase()))throw new TypeError('The operator "'+t+'" is not permitted');return t},r.prototype.direction=function(t){var e=this.checkRaw(t);return e?e:n.contains(a,(t||"").toLowerCase())?t:"asc"},r.prototype.compileCallback=function(t,e){var r=this.client,n=new r.QueryBuilder;t.call(n,n);var i=new r.QueryCompiler(n);return i.formatter=this,i.toSQL(e||"select")},r.prototype.outputQuery=function(t,e){var r=t.sql||"";return r&&("select"===t.method&&e||t.as)&&(r="("+r+")",t.as&&(r+=" as "+this.wrap(t.as))),r},e.exports=r},{"./query/builder":104,"./raw":108,lodash:130}],98:[function(t,e){"use strict";e.exports={now:function(){return new this.client.Raw("CURRENT_TIMESTAMP")}}},{}],99:[function(t,e){"use strict";var r=t("lodash"),n={skim:function(t){return r.map(t,function(t){return r.pick(t,r.keys(t))})},normalizeArr:function(){for(var t=new Array(arguments.length),e=0;e<t.length;e++)t[e]=arguments[e];return r.isArray(t[0])?t[0]:t},deprecate:function(t){this.warn(t)},warn:function(t){"undefined"!=typeof console&&null!==console&&"function"==typeof console.warn&&console.warn("Knex: "+t)},sortObject:function(t){return r.sortBy(r.pairs(t),function(t){return t[0]})}};e.exports=n},{lodash:130}],100:[function(t,e){"use strict";e.exports=function(e){var r=t("lodash"),n=t("./dialects/mysql/string");e.prototype.toQuery=function(t){var e=this.toSQL(this._method);if(this._errors&&this._errors.length>0)throw this._errors[0];return r.isArray(e)||(e=[e]),r.map(e,function(e){return this._formatQuery(e.sql,e.bindings,t)},this).join(";\n")},e.prototype._formatQuery=function(t,e,r){return this.client&&this.client.prepBindings&&(e=this.client.prepBindings(e,r)),n.format(t,e,!0,r)},e.prototype.then=function(t,e){var r=this.client.Runner;return new r(this).run().then(t,e)},e.prototype.options=function(t){return this._options=this._options||[],this._options.push(r.clone(t)||{}),this},e.prototype.connection=function(t){return this._connection=t,this},e.prototype.debug=function(t){return this._debug=void 0===t||null===t?!0:t,this},e.prototype.transacting=function(t){return this._transacting=t,this},e.prototype.stream=function(t){var e=this.client.Runner;return new e(this).stream(t)},e.prototype.pipe=function(t){var e=this.client.Runner;return new e(this).pipe(t)},r.each(["bind","catch","spread","otherwise","map","reduce","tap","thenReturn","return","yield","ensure","nodeify","exec"],function(t){e.prototype[t]=function(){var e=this.then();return e[t].apply(e,arguments)}})}},{"./dialects/mysql/string":79,lodash:130}],101:[function(t,e){(function(r,n){"use strict";function i(t,e){var r=u.difference(e,t);if(!u.isEmpty(r))throw new Error("The migration directory is corrupt, the following files are missing: "+r.join(", "))}function o(t){this.knex=t,this.config=this.setConfig(t.client.migrationConfig)}var s=t("fs"),a=t("path"),u=t("lodash"),l=t("mkdirp"),c=t("../promise"),h=function(t){return t=t.toString(),t[1]?t:"0"+t},f=function(){var t=new Date;return t.getFullYear().toString()+h(t.getMonth()+1)+h(t.getDate())+h(t.getHours())+h(t.getMinutes())+h(t.getSeconds())};o.prototype.latest=c.method(function(t){return this.config=this.setConfig(t),this._migrationData().tap(i).bind(this).spread(function(t,e){return this._runBatch(u.difference(t,e),"up")})}),o.prototype.rollback=c.method(function(t){return this.config=this.setConfig(t),this._migrationData().tap(i).bind(this).then(this._getLastBatch).then(function(t){return this._runBatch(u.pluck(t,"name"),"down")})}),o.prototype.currentVersion=function(t){return this.config=this.setConfig(t),this._listCompleted(t).then(function(t){var e=u.chain(t).map(function(t){return t.split("_")[0]}).max().value();return e===-1/0?"none":e})},o.prototype.make=function(t,e){return this.config=this.setConfig(e),t||c.rejected(new Error("A name must be specified for the generated migration")),this._ensureFolder(e).bind(this).then(this._generateStubTemplate).then(this._writeNewMigration(t))},o.prototype._listAll=c.method(function(t){return this.config=this.setConfig(t),c.promisify(s.readdir,s)(this._absoluteConfigDir()).bind(this).then(function(t){return u.filter(t,function(t){var e=a.extname(t);return u.contains([".co",".coffee",".iced",".js",".litcoffee",".ls"],e)}).sort()})}),o.prototype._ensureFolder=function(){var t=this._absoluteConfigDir();return c.promisify(s.stat,s)(t).catch(function(){return c.promisify(l)(t)})},o.prototype._ensureTable=c.method(function(){var t=this.config.tableName;return this.knex.schema.hasTable(t).bind(this).then(function(e){return e?void 0:this._createMigrationTable(t)})}),o.prototype._createMigrationTable=function(t){return this.knex.schema.createTable(t,function(t){t.increments(),t.string("name"),t.integer("batch"),t.timestamp("migration_time")})},o.prototype._runBatch=function(t,e){return c.all(u.map(t,this._validateMigrationStructure,this)).bind(this).then(function(t){return c.bind(this).then(this._latestBatchNumber).then(function(t){return"up"===e&&t++,t}).then(function(r){return this._waterfallBatch(r,t,e)})})},o.prototype._validateMigrationStructure=function(e){var r=t(a.join(this._absoluteConfigDir(),e));if(!u.isFunction(r.up)||!u.isFunction(r.down))throw new Error("Invalid migration: "+e+" must have both an up and down function");return e},o.prototype._listCompleted=c.method(function(){var t=this.config.tableName;return this._ensureTable(t).bind(this).then(function(){return this.knex(t).orderBy("id").select("name")}).then(function(t){return u.pluck(t,"name")})}),o.prototype._migrationData=function(){return c.all([this._listAll(),this._listCompleted()])},o.prototype._generateStubTemplate=function(){var t=this.config.stub||a.join(n,"stub",this.config.extension+".stub");return c.promisify(s.readFile,s)(t).then(function(t){return u.template(t.toString(),null,{variable:"d"})})},o.prototype._writeNewMigration=function(t){var e=this.config,r=this._absoluteConfigDir();return function(n){"-"===t[0]&&(t=t.slice(1));var i=f()+"_"+t+"."+e.extension;return c.promisify(s.writeFile,s)(a.join(r,i),n(e.variables||{})).return(a.join(r,i))}},o.prototype._getLastBatch=function(){var t=this.knex,e=this.config.tableName;return this.knex(e).where("batch",function(){this.select(t.raw("MAX(batch)")).from(e)}).orderBy("id","desc")},o.prototype._latestBatchNumber=function(){return this.knex(this.config.tableName).max("batch as batchNo").then(function(t){return t[0].batchNo||0})},o.prototype._waterfallBatch=function(e,r,n){var i=this.knex,o=this.config.tableName,s=this._absoluteConfigDir(),l=c.bind({failed:!1,failedOn:0}),h=[];return u.each(r,function(r){var u=r;r=t(s+"/"+u),l=l.then(function(){return r[n](i,c)}).then(function(){return h.push(a.join(s,u)),"up"===n?i(o).insert({name:u,batch:e,migration_time:new Date}):"down"===n?i(o).where({name:u}).del():void 0})}),l.thenReturn([e,h])},o.prototype._absoluteConfigDir=function(){return a.resolve(r.cwd(),this.config.directory)},o.prototype.setConfig=function(t){return u.extend({extension:"js",tableName:"knex_migrations",directory:"./migrations"},this.config||{},t)},e.exports=o}).call(this,t("_process"),"/node_modules/knex/lib/migrate")},{"../promise":103,_process:60,fs:51,lodash:130,mkdirp:120,path:59}],102:[function(t,e){"use strict";function r(t){this.config=n.clone(t)||{},this.genericPool=this.initialize()}var n=t("lodash"),i=t("generic-pool-redux").Pool,o=t("./promise");r.prototype.initialize=function(){return new i(n.defaults(this.config,n.result(this,"defaults")))},r.prototype.defaults=function(){var t=this;return{min:2,max:10,create:function(e){t.client.acquireRawConnection().tap(function(e){return e.__cid=n.uniqueId("__cid"),t.config.afterCreate?o.promisify(t.config.afterCreate)(e):void 0}).exec(e)},destroy:function(e){return t.config.beforeDestroy?t.config.beforeDestroy(e,function(){void 0!==e&&e.end()}):void(void 0!==e&&e.end())}}},r.prototype.acquire=function(t,e){this.genericPool?this.genericPool.acquire(t,e):t(new Error("The genericPool is not initialized."))},r.prototype.release=function(t,e){this.genericPool?this.genericPool.release(t,e):e(new Error("The genericPool is not initialized."))},r.prototype.destroy=function(t){var e=this.genericPool;return e?(e.drain(function(){e.destroyAllNow(t)}),this.genericPool=void 0):t(),this},e.exports=r},{"./promise":103,"generic-pool-redux":119,lodash:130}],103:[function(t,e){"use strict";var r=t("bluebird/js/main/promise")();r.prototype.yield=r.prototype.thenReturn,r.prototype.ensure=r.prototype.lastly,r.prototype.otherwise=r.prototype.caught,r.prototype.exec=r.prototype.nodeify,e.exports=r},{"bluebird/js/main/promise":35}],104:[function(t,e){"use strict";function r(){this._single={},this._statements=[],this._errors=[],this._joinFlag="inner",this._boolFlag="and",this._notFlag=!1,this.and=this}var n=t("lodash"),i=t("inherits"),o=t("events").EventEmitter,s=t("../raw"),a=t("../helpers"),u=t("./joinclause");i(r,o),r.prototype.toString=function(){return this.toQuery()},r.prototype.toSQL=function(){var t=this.client.QueryCompiler;return new t(this).toSQL(this._method||"select")},r.prototype.clone=function(){var t=new this.constructor;return t._method=this._method,t._single=n.clone(this._single),t._options=n.clone(this._options),t._statements=this._statements.slice(),t._errors=this._errors.slice(),t._debug=this._debug,t._transacting=this._transacting,t._connection=this._connection,t},r.prototype.select=r.prototype.columns=r.prototype.column=function(t){return t?(this._statements.push({grouping:"columns",value:a.normalizeArr.apply(null,arguments)}),this):this},r.prototype.as=function(t){return this._single.as=t,this},r.prototype.table=function(t){return this._single.table=t,this},r.prototype.from=r.prototype.table,r.prototype.into=r.prototype.table,r.prototype.distinct=function(){return this._statements.push({grouping:"columns",value:a.normalizeArr.apply(null,arguments),distinct:!0}),this},r.prototype.join=function(t,e){var r,i=this._joinType();return n.isFunction(e)?(r=new u(t,i),e.call(r,r)):"raw"===i?r=new u(new s(t,e),"raw"):(r=new u(t,i),arguments.length>1&&r.on.apply(r,n.toArray(arguments).slice(1))),this._statements.push(r),this},r.prototype.innerJoin=function(){return this._joinType("inner").join.apply(this,arguments)},r.prototype.leftJoin=function(){return this._joinType("left").join.apply(this,arguments)},r.prototype.leftOuterJoin=function(){return this._joinType("left outer").join.apply(this,arguments)},r.prototype.rightJoin=function(){return this._joinType("right").join.apply(this,arguments)},r.prototype.rightOuterJoin=function(){return this._joinType("right outer").join.apply(this,arguments)},r.prototype.outerJoin=function(){return this._joinType("outer").join.apply(this,arguments)},r.prototype.fullOuterJoin=function(){return this._joinType("full outer").join.apply(this,arguments)},r.prototype.crossJoin=function(){return this._joinType("cross").join.apply(this,arguments)},r.prototype.joinRaw=function(){return this._joinType("raw").join.apply(this,arguments)},r.prototype.where=r.prototype.andWhere=function(t,e,r){if(t===!1||t===!0)return this.whereRaw(t);if(n.isFunction(t))return this.whereWrapped(t);if(t instanceof s)return this.whereRaw(t);if(n.isObject(t))return this._objectWhere(t);if(2===arguments.length&&(r=e,e="=",null===r))return this.whereNull(t);var i=(""+e).toLowerCase().trim();if(3===arguments.length){if("in"===i||"not in"===i)return this._not("not in"===i).whereIn(arguments[0],arguments[2]);if("between"===i||"not between"===i)return this._not("not between"===i).whereBetween(arguments[0],arguments[2])}return null!==r||"is"!==i&&"is not"!==i?(this._statements.push({grouping:"where",type:"whereBasic",column:t,operator:e,value:r,bool:this._bool()}),this):this._not("is not"===i).whereNull(t)},r.prototype.orWhere=function(){return this._bool("or").where.apply(this,arguments)},r.prototype._objectWhere=function(t){var e=this._bool();for(var r in t)this[e+"Where"](r,t[r]);return this},r.prototype.whereRaw=r.prototype.andWhereRaw=function(t,e){var r=t instanceof s?t:new s(t,e);return this._statements.push({grouping:"where",type:"whereRaw",value:r,bool:this._bool()}),this},r.prototype.orWhereRaw=function(t,e){return this._bool("or").whereRaw(t,e)},r.prototype.whereWrapped=function(t){return this._statements.push({grouping:"where",type:"whereWrapped",value:t,bool:this._bool()}),this},r.prototype.whereExists=function(t){return this._statements.push({grouping:"where",type:"whereExists",value:t,not:this._not(),bool:this._bool()}),this},r.prototype.orWhereExists=function(t){return this._bool("or").whereExists(t)},r.prototype.whereNotExists=function(t){return this._not(!0).whereExists(t)},r.prototype.orWhereNotExists=function(t){return this._bool("or").whereNotExists(t)},r.prototype.whereIn=function(t,e){return n.isArray(e)&&n.isEmpty(e)?this.where(this._not()):(this._statements.push({grouping:"where",type:"whereIn",column:t,value:e,not:this._not(),bool:this._bool()}),this)},r.prototype.orWhereIn=function(t,e){return this._bool("or").whereIn(t,e)},r.prototype.whereNotIn=function(t,e){return this._not(!0).whereIn(t,e)},r.prototype.orWhereNotIn=function(t,e){return this._bool("or")._not(!0).whereIn(t,e)},r.prototype.whereNull=function(t){return this._statements.push({grouping:"where",type:"whereNull",column:t,not:this._not(),bool:this._bool()}),this},r.prototype.orWhereNull=function(t){return this._bool("or").whereNull(t)},r.prototype.whereNotNull=function(t){return this._not(!0).whereNull(t)},r.prototype.orWhereNotNull=function(t){return this._bool("or").whereNotNull(t)},r.prototype.whereBetween=function(t,e){return n.isArray(e)?2!==e.length?this._errors.push(new Error("You must specify 2 values for the whereBetween clause")):(this._statements.push({grouping:"where",type:"whereBetween",column:t,value:e,not:this._not(),bool:this._bool()}),this):this._errors.push(new Error("The second argument to whereBetween must be an array."))},r.prototype.whereNotBetween=function(t,e){return this._not(!0).whereBetween(t,e)},r.prototype.orWhereBetween=function(t,e){return this._bool("or").whereBetween(t,e)},r.prototype.orWhereNotBetween=function(t,e){return this._bool("or").whereNotBetween(t,e)},r.prototype.groupBy=function(t){return t instanceof s?this.groupByRaw.apply(this,arguments):(this._statements.push({grouping:"group",type:"groupByBasic",value:a.normalizeArr.apply(null,arguments)}),this)},r.prototype.groupByRaw=function(t,e){var r=t instanceof s?t:new s(t,e);return this._statements.push({grouping:"group",type:"groupByRaw",value:r}),this},r.prototype.orderBy=function(t,e){return this._statements.push({grouping:"order",type:"orderByBasic",value:t,direction:e}),this},r.prototype.orderByRaw=function(t,e){var r=t instanceof s?t:new s(t,e);return this._statements.push({grouping:"order",type:"orderByRaw",value:r}),this},r.prototype.union=function(t,e){if(arguments.length>1){for(var r=new Array(arguments.length),n=0,i=r.length;i>n;n++)r[n]=arguments[n],this.union(r[n]);return this}return this._statements.push({grouping:"union",clause:"union",value:t,wrap:e||!1}),this},r.prototype.unionAll=function(t,e){return this._statements.push({grouping:"union",clause:"union all",value:t,wrap:e||!1}),this},r.prototype.having=r.prototype.andHaving=function(t,e,r){return t instanceof s&&1===arguments.length?this._havingRaw(t):(this._statements.push({grouping:"having",type:"havingBasic",column:t,operator:e,value:r,bool:this._bool()}),this)},r.prototype.orHaving=function(){return this._bool("or").having.apply(this,arguments)},r.prototype.havingRaw=function(t,e){return this._havingRaw(t,e)},r.prototype.orHavingRaw=function(t,e){return this._bool("or").havingRaw(t,e)},r.prototype._havingRaw=function(t,e){var r=t instanceof s?t:new s(t,e);return this._statements.push({grouping:"having",type:"havingRaw",value:r,bool:this._bool()}),this},r.prototype.offset=function(t){return this._single.offset=t,this},r.prototype.limit=function(t){return this._single.limit=t,this},r.prototype.count=function(t){return this._aggregate("count",t||"*")},r.prototype.min=function(t){return this._aggregate("min",t)},r.prototype.max=function(t){return this._aggregate("max",t)},r.prototype.sum=function(t){return this._aggregate("sum",t)},r.prototype.avg=function(t){return this._aggregate("avg",t)},r.prototype.increment=function(t,e){return this._counter(t,e)},r.prototype.decrement=function(t,e){return this._counter(t,e,"-")},r.prototype.first=function(){var t,e=new Array(arguments.length);for(t=0;t<e.length;t++)e[t]=arguments[t];return this.select.apply(this,e),this._method="first",this.limit(1),this},r.prototype.pluck=function(t){return this._method="pluck",this._single.pluck=t,this._statements.push({grouping:"columns",type:"pluck",value:t}),this},r.prototype.insert=function(t,e){return this._method="insert",n.isEmpty(e)||this.returning(e),this._single.insert=t,this},r.prototype.update=function(t,e){var r,i={};this._method="update";var o,s=new Array(arguments.length);for(o=0;o<s.length;o++)s[o]=arguments[o];return n.isString(t)?(i[t]=e,s.length>2&&(r=s[2])):(i=t,r=s[1]),n.isEmpty(r)||this.returning(r),this._single.update=i,this},r.prototype.returning=function(t){return this._single.returning=t,this},r.prototype.del=r.prototype.delete=function(t){return this._method="del",n.isEmpty(t)||this.returning(t),this},r.prototype.truncate=function(){return this._method="truncate",this},r.prototype.columnInfo=function(t){return this._method="columnInfo",this._single.columnInfo=t,this},r.prototype.forUpdate=function(){return this._single.lock="forUpdate",this},r.prototype.forShare=function(){return this._single.lock="forShare",this},r.prototype._counter=function(t,e,r){var n=parseInt(e,10);
return isNaN(n)&&(n=1),this._method="counter",this._single.counter={column:t,amount:n,symbol:r||"+"},this},r.prototype._bool=function(t){if(1===arguments.length)return this._boolFlag=t,this;var e=this._boolFlag;return this._boolFlag="and",e},r.prototype._not=function(t){if(1===arguments.length)return this._notFlag=t,this;var e=this._notFlag;return this._notFlag=!1,e},r.prototype._joinType=function(t){if(1===arguments.length)return this._joinFlag=t,this;var e=this._joinFlag||"inner";return this._joinFlag="inner",e},r.prototype._aggregate=function(t,e){return this._statements.push({grouping:"columns",type:"aggregate",method:t,value:e}),this},Object.defineProperty(r.prototype,"or",{get:function(){return this._bool("or")}}),Object.defineProperty(r.prototype,"not",{get:function(){return this._not(!0)}}),t("../interface")(r),e.exports=r},{"../helpers":99,"../interface":100,"../raw":108,"./joinclause":106,events:57,inherits:76,lodash:130}],105:[function(t,e){"use strict";function r(t){this.method=t._method||"select",this.options=t._options,this.single=t._single,this.transacting=t._transacting,this.grouped=n.groupBy(t._statements,"grouping"),this.tableName=this.single.table?this.formatter.wrap(this.single.table):""}var n=t("lodash"),i=t("../helpers"),o=t("../raw");r.prototype.toSQL=function(t){var e=this[t](),r={method:t,options:this.options&&this.options.length>0?n.extend.apply(n,this.options):void 0,bindings:this.formatter.bindings};return n.isString(e)&&(e={sql:e}),"select"===t&&this.single.as&&(r.as=this.single.as),n.extend(r,e)};var s=["columns","join","where","union","group","having","order","limit","offset","lock"];r.prototype.select=function(){for(var t=[],e=0,r=s.length;r>e;e++){var i=s[e];t.push(this[i](this))}return n.compact(t).join(" ")},r.prototype.first=r.prototype.select,r.prototype.pluck=function(){return{sql:this.select(),pluck:this.single.pluck}},r.prototype.insert=function(){var t=this,e=this.single.insert,r="insert into "+this.tableName+" ";if(n.isArray(e)&&1===e.length&&n.isEmpty(e[0])&&(e=[]),n.isEmpty(e)&&!n.isFunction(e))r+=this._emptyInsertValue;else{var i=this._prepInsert(e);r+=n.isString(i)?i:i.columns.length?"("+this.formatter.columnize(i.columns)+") values ("+n.map(i.values,this.formatter.parameterize,this.formatter).join("), (")+")":"() values "+n.map(i.values,function(){return"("+(t._defaultInsertValue||"")+")"}).join(", ")}return r},r.prototype.update=function(){var t=this._prepUpdate(this.single.update),e=this.where();return"update "+this.tableName+" set "+t.join(", ")+(e?" "+e:"")},r.prototype.columns=function(){var t=!1;if(this.onlyUnions())return"";var e=this.grouped.columns||[],r=[];if(e)for(var n=0,i=e.length;i>n;n++){var o=e[n];o.distinct&&(t=!0),"aggregate"===o.type?r.push(this.aggregate(o)):o.value&&o.value.length>0&&r.push(this.formatter.columnize(o.value))}return 0===r.length&&r.push("*"),"select "+(t?"distinct ":"")+(r.join(", ")||"*")+(this.tableName?" from "+this.tableName:"")},r.prototype.aggregate=function(t){var e=t.value,r=e.toLowerCase().indexOf(" as ");if(-1!==r){var n=e.slice(0,r),i=e.slice(r+4);return t.method+"("+this.formatter.wrap(n)+") as "+this.formatter.wrap(i)}return t.method+"("+this.formatter.wrap(e)+")"},r.prototype.join=function(){var t=this.grouped.join;if(!t)return"";var e=n.reduce(t,function(t,e){return"raw"===e.joinType?t.push(this.formatter.checkRaw(e.table)):(t.push(e.joinType+" join "+this.formatter.wrap(e.table)),n.each(e.clauses,function(e,r){t.push(r>0?e[1]:e[0]),t.push(this.formatter.wrap(e[2])),e[3]&&t.push(this.formatter.operator(e[3])),e[4]&&t.push(this.formatter.wrap(e[4]))},this)),t},[],this);return e.length>0?e.join(" "):""},r.prototype.where=function(){var t=this.grouped.where;if(t){var e=[];e[0]="where";for(var r=0,n=t.length;n>r;r++){var i=t[r];0!==r&&e.push(i.bool),e.push(this[i.type](i))}return e.length>1?e.join(" "):""}},r.prototype.group=function(){return this._groupsOrders("group")},r.prototype.order=function(){return this._groupsOrders("order")},r.prototype.having=function(){var t=this.grouped.having;if(!t)return"";for(var e=["having"],r=0,n=t.length;n>r;r++){var i="",o=t[r];0!==r&&(i=o.bool+" "),e.push("havingBasic"===o.type?i+this.formatter.columnize(o.column)+" "+this.formatter.operator(o.operator)+" "+this.formatter.parameter(o.value):i+this.formatter.checkRaw(o.value))}return e.length>1?e.join(" "):""},r.prototype.union=function(){var t=this.onlyUnions(),e=this.grouped.union;if(!e)return"";for(var r="",n=0,i=e.length;i>n;n++){var o=e[n];n>0&&(r+=" "),(n>0||!t)&&(r+=o.clause+" ");var s=this.formatter.rawOrFn(o.value);s&&(o.wrap&&(r+="("),r+=s,o.wrap&&(r+=")"))}return r},r.prototype.onlyUnions=function(){return!this.grouped.columns&&this.grouped.union&&!this.tableName},r.prototype.limit=function(){return this.single.limit?"limit "+this.formatter.parameter(this.single.limit):""},r.prototype.offset=function(){return this.single.offset?"offset "+this.formatter.parameter(this.single.offset):""},r.prototype.del=function(){var t=this.where();return"delete from "+this.tableName+(t?" "+t:"")},r.prototype.truncate=function(){return"truncate "+this.tableName},r.prototype.lock=function(){if(this.single.lock){if(this.transacting)return this[this.single.lock]();i.warn('You are attempting to perform a "lock" command outside of a transaction.')}},r.prototype.counter=function(){var t=this.single.counter,e={};return e[t.column]=new o(this.formatter.wrap(t.column)+" "+(t.symbol||"+")+" "+t.amount),this.single.update=e,this.update()},r.prototype._groupsOrders=function(t){var e=this.grouped[t];if(!e)return"";var r=this.formatter,n=e.map(function(e){return(e.value instanceof o?r.checkRaw(e.value):r.columnize(e.value))+("order"===t&&"orderByRaw"!==e.type?" "+r.direction(e.direction):"")});return n.length?t+" by "+n.join(", "):""},r.prototype.whereIn=function(t){return n.isArray(t.column)?this.multiWhereIn(t):this.formatter.wrap(t.column)+" "+this._not(t,"in ")+this.wrap(this.formatter.parameterize(t.value))},r.prototype.multiWhereIn=function(t){return"("+n.map(t.column,this.formatter.wrap,this.formatter)+") "+this._not(t,"in ")+"(("+n.map(t.value,this.formatter.parameterize,this.formatter).join("),(")+"))"},r.prototype.whereNull=function(t){return this.formatter.wrap(t.column)+" is "+this._not(t,"null")},r.prototype.whereBasic=function(t){return this.formatter.wrap(t.column)+" "+this.formatter.operator(t.operator)+" "+this.formatter.parameter(t.value)},r.prototype.whereExists=function(t){return this._not(t,"exists")+" ("+this.formatter.rawOrFn(t.value)+")"},r.prototype.whereWrapped=function(t){return"("+this.formatter.rawOrFn(t.value,"where").slice(6)+")"},r.prototype.whereBetween=function(t){return this.formatter.wrap(t.column)+" "+this._not(t,"between")+" "+n.map(t.value,this.formatter.parameter,this.formatter).join(" and ")},r.prototype.whereRaw=function(t){return this.formatter.checkRaw(t.value)},r.prototype.wrap=function(t){return"("!==t.charAt(0)?"("+t+")":t},r.prototype._not=function(t,e){return t.not?"not "+e:e},r.prototype._prepInsert=function(t){var e=this.formatter.rawOrFn(t);if(e)return e;var r,o,s=[];n.isArray(t)||(t=t?[t]:[]);for(var a=0,u=t.length;u>a;a++){var l=i.sortObject(t[a]);if(r=n.pluck(l,0),o=o||r,!n.isEqual(r,o))return this._prepInsert(this._normalizeInsert(t));s.push(n.pluck(l,1))}return{columns:r,values:s}},r.prototype._normalizeInsert=function(t){if(!n.isArray(t))return n.clone(t);var e=n.reduce(n.union.apply(n,n.map(t,function(t){return n.keys(t)})),function(t,e){return t[e]=void 0,t},{});return n.map(t,function(t){return n.defaults(t,e)})},r.prototype._prepUpdate=function(t){for(var e=[],r=i.sortObject(t),n=0,o=r.length;o>n;n++)e.push(this.formatter.wrap(r[n][0])+" = "+this.formatter.parameter(r[n][1]));return e},e.exports=r},{"../helpers":99,"../raw":108,lodash:130}],106:[function(t,e){"use strict";function r(t,e){this.table=t,this.joinType=e,this.clauses=[],this.and=this}r.prototype.grouping="join",r.prototype.on=function(t,e,r){var n;switch(arguments.length){case 1:n=["on",this._bool(),t];break;case 2:n=["on",this._bool(),t,"=",e];break;default:n=["on",this._bool(),t,e,r]}return this.clauses.push(n),this},r.prototype.using=function(t){return this.clauses.push(["using",this._bool(),t])},r.prototype.andOn=function(){return this.on.apply(this,arguments)},r.prototype.orOn=function(){return this._bool("or").on.apply(this,arguments)},r.prototype.type=function(t){return this.joinType=t,this},r.prototype._bool=function(t){if(1===arguments.length)return this._boolFlag=t,this;var e=this._boolFlag||"and";return this._boolFlag="and",e},Object.defineProperty(r.prototype,"or",{get:function(){return this._bool("or")}}),e.exports=r},{}],107:[function(t,e){"use strict";e.exports=["select","as","columns","column","from","into","table","distinct","join","joinRaw","innerJoin","leftJoin","leftOuterJoin","rightJoin","rightOuterJoin","outerJoin","fullOuterJoin","crossJoin","where","andWhere","orWhere","whereRaw","whereWrapped","orWhereRaw","whereExists","orWhereExists","whereNotExists","orWhereNotExists","whereIn","orWhereIn","whereNotIn","orWhereNotIn","whereNull","orWhereNull","whereNotNull","orWhereNotNull","whereBetween","whereNotBetween","orWhereBetween","orWhereNotBetween","groupBy","groupByRaw","orderBy","orderByRaw","union","unionAll","having","havingRaw","orHaving","orHavingRaw","offset","limit","count","min","max","sum","avg","increment","decrement","first","debug","pluck","insert","update","returning","del","delete","truncate","transacting","connection"]},{}],108:[function(t,e){"use strict";function r(t,e){if(t&&t.toSQL){var r=t.toSQL();t=r.sql,e=r.bindings}this.sql=t+"",this.bindings=n.isArray(e)?e:e?[e]:[],this.interpolateBindings(),this._debug=void 0,this._transacting=void 0}var n=t("lodash"),i=t("inherits"),o=t("events").EventEmitter;i(r,o),r.prototype.wrap=function(t,e){return this.sql=t+this.sql+e,this},r.prototype.toString=function(){return this.toQuery()},r.prototype.interpolateBindings=function(){var t=[];this.bindings=n.reduce(this.bindings,function(e,r,n){var i=[r];if(r&&r.toSQL){var o=this.splicer(r,n);i=o.bindings,t.push(o.replacer)}return e.concat(i)},[],this),this.sql=n.reduce(t.reverse(),function(t,e){return e(t)},this.sql.split("?")).join("?")},r.prototype.splicer=function(t,e){var r=t.toSQL(),n=function(t){return t[e]=t[e]+r.sql+t[e+1],t.splice(e+1,1),t};return{replacer:n,bindings:r.bindings}},r.prototype.toSQL=function(){return{sql:this.sql,method:"raw",bindings:this.bindings}},t("./interface")(r),e.exports=r},{"./interface":100,events:57,inherits:76,lodash:130}],109:[function(t,e){"use strict";function r(t){this.builder=t,this.queries=[],this.connection=void 0}var n=t("lodash"),i=t("./promise");r.prototype._beginTransaction="begin;",r.prototype._commitTransaction="commit;",r.prototype._rollbackTransaction="rollback;",r.prototype.run=i.method(function(){return this.builder._transacting?this.transactionQuery():i.bind(this).then(this.ensureConnection).then(function(t){this.connection=t,this.client.emit("start",this.builder);var e=this.builder.toSQL();return this.builder.emit("start",this.builder),n.isArray(e)?this.queryArray(e):this.query(e)}).catch(function(t){throw this.builder._events&&this.builder._events.error&&this.builder.emit("error",t),t}).tap(function(){this.builder.emit("end")}).finally(this.cleanupConnection)});var o;r.prototype.stream=function(e,r){1===arguments.length&&n.isFunction(e)&&(r=e,e={});var s=n.isFunction(r);o=o||t("readable-stream").PassThrough;var a=new o({objectMode:!0}),u=i.bind(this).then(this.ensureConnection).then(function(t){this.connection=t;var e=this.builder.toSQL(),r=new Error("The stream may only be used with a single query statement.");if(n.isArray(e)){if(s)throw r;a.emit("error",r)}return e}).then(function(t){return this._stream(t,a,e)}).finally(this.cleanupConnection);return s?(r(a),u):a},r.prototype.pipe=function(t){return this.stream().pipe(t)},r.prototype.query=i.method(function(t){if(!this.connection)throw new Error("There is an error with the database connection. Please check your config.");return t.__cid=this.connection.__cid,this.builder.emit("query",t),this.client.emit("query",t),this._query(t).bind(this).then(this.processResponse)}),r.prototype.queryArray=i.method(function(t){return 1===t.length?this.query(t[0]):i.bind(this).thenReturn(t).reduce(function(t,e){return this.query(e).then(function(e){return t.push(e),t})},[])}),r.prototype.ensureConnection=i.method(function(){return this.builder._connection?this.builder._connection:this.client.acquireConnection()}),r.prototype.debug=function(t){console.dir(n.extend({__cid:this.connection.__cid},t))},r.prototype.isDebugging=function(){return this.client.isDebugging===!0||this.builder._debug===!0},r.prototype.transactionQuery=i.method(function(){var t=this.builder._transacting._runner;if(!(t instanceof r))throw new Error("Invalid transaction object provided.");var e=this.builder.toSQL();return n.isArray(e)?t.queryArray(e):t.query(e)}),r.prototype.startTransaction=i.method(function(){return i.bind(this).then(this.ensureConnection).then(function(t){return this.connection=t,this.transaction=!0,this.beginTransaction()}).thenReturn(this)}),r.prototype.finishTransaction=i.method(function(t,e,r){var n,i=e.__dfd__;switch(t){case 0:n=this.commitTransaction();break;case 1:n=this.rollbackTransaction()}return n.then(function(e){switch(r=void 0===r?e:r,t){case 0:i.fulfill(r);break;case 1:i.reject(r)}}).catch(function(t){throw i.reject(t),t}).bind(this).finally(function(){return e._runner=void 0,this.cleanupConnection()})}),r.prototype.beginTransaction=function(){return this._beginTransaction&&this.query({sql:this._beginTransaction})},r.prototype.commitTransaction=function(){return this._commitTransaction&&this.query({sql:this._commitTransaction})},r.prototype.rollbackTransaction=function(){return this._rollbackTransaction&&this.query({sql:this._rollbackTransaction})},r.prototype.cleanupConnection=i.method(function(){return this.builder._connection||"undefined"==typeof this.connection?void 0:this.client.releaseConnection(this.connection)}),e.exports=r},{"./promise":103,lodash:130,"readable-stream":129}],110:[function(t,e){"use strict";function r(){this._sequence=[],this._errors=[]}var n=t("lodash"),i=t("inherits"),o=t("events").EventEmitter;i(r,o),n.each(["createTable","createTableIfNotExists","createSchema","createSchemaIfNotExists","dropSchema","dropSchemaIfExists","table","alterTable","hasTable","hasColumn","dropTable","renameTable","dropTableIfExists","raw","debug"],function(t){r.prototype[t]=function(){return"table"===t&&(t="alterTable"),this._sequence.push({method:t,args:n.toArray(arguments)}),this}}),r.prototype.toString=function(){return this.toQuery()},r.prototype.toSQL=function(){var t=this.client.SchemaCompiler;return new t(this).toSQL()},t("../interface")(r),e.exports=r},{"../interface":100,events:57,inherits:76,lodash:130}],111:[function(t,e){"use strict";function r(t,e,r){this._single={},this._modifiers={},this._statements=[],this._type=a[e]||e,this._args=r,this._tableBuilder=t,"alter"===t._method&&n.extend(this,i)}var n=t("lodash"),i={};i.drop=function(){return this._single.drop=!0,this},i.alterType=function(t){return this._statements.push({grouping:"alterType",value:t}),this};var o=["default","defaultsTo","defaultTo","unsigned","nullable","notNull","notNullable","first","after","comment"],s={"default":"defaultTo",defaultsTo:"defaultTo",notNull:"notNullable"},a={"float":"floating","enum":"enu","boolean":"bool",string:"varchar",bigint:"bigInteger"};n.each(o,function(t){r.prototype[t]=function(){return s[t]&&(t=s[t]),"notNullable"===t?this.nullable(!1):(this._modifiers[t]=n.toArray(arguments),this)}}),n.each(["index","primary","unique"],function(t){r.prototype[t]=function(){return-1===this._type.toLowerCase().indexOf("increments")&&this._tableBuilder[t].apply(this._tableBuilder,[this._args[0]].concat(n.toArray(arguments))),this}}),r.prototype.references=function(t){return this._tableBuilder.foreign.call(this._tableBuilder,this._args[0],this)._columnBuilder(this).references(t)},e.exports=r},{lodash:130}],112:[function(t,e){"use strict";function r(t,e){this.tableCompiler=t,this.columnBuilder=e,this.args=e._args,this.type=e._type.toLowerCase(),this.grouped=n.groupBy(e._statements,"grouping"),this.modified=e._modifiers,this.isIncrements=-1!==this.type.indexOf("increments"),this.initCompiler()}var n=t("lodash"),i=t("../raw");r.prototype.toSQL=function(){return this.pushQuery(this.compileColumn()),this.sequence.additional&&(this.sequence=this.sequence.concat(this.sequence.additional)),this.sequence},r.prototype.compileColumn=function(){return this.formatter.wrap(this.getColumnName())+" "+this.getColumnType()+this.getModifiers()},r.prototype.getColumnName=function(){var t=n.first(this.args);if(t)return t;if(this.isIncrements)return"id";throw new Error("You did not specify a column name for the "+this.type+"column.")},r.prototype.getColumnType=function(){var t=this[this.type];return n.isFunction(t)?t.apply(this,n.rest(this.args)):t},r.prototype.getModifiers=function(){var t=[];if(-1===this.type.indexOf("increments"))for(var e=0,r=this.modifiers.length;r>e;e++){var i=this.modifiers[e];if(n.has(this.modified,i)){var o=this[i].apply(this,this.modified[i]);o&&t.push(o)}}return t.length>0?" "+t.join(" "):""},r.prototype.increments="integer not null primary key autoincrement",r.prototype.bigincrements="integer not null primary key autoincrement",r.prototype.integer=r.prototype.smallint=r.prototype.mediumint="integer",r.prototype.biginteger="bigint",r.prototype.varchar=function(t){return"varchar("+this._num(t,255)+")"},r.prototype.text="text",r.prototype.tinyint="tinyint",r.prototype.floating=function(t,e){return"float("+this._num(t,8)+", "+this._num(e,2)+")"},r.prototype.decimal=function(t,e){return"decimal("+this._num(t,8)+", "+this._num(e,2)+")"},r.prototype.binary="blob",r.prototype.bool="boolean",r.prototype.date="date",r.prototype.datetime="datetime",r.prototype.time="time",r.prototype.timestamp="timestamp",r.prototype.enu="varchar",r.prototype.bit=r.prototype.json="text",r.prototype.uuid="char(36)",r.prototype.specifictype=function(t){return t},r.prototype.nullable=function(t){return t===!1?"not null":"null"},r.prototype.notNullable=function(){return this.nullable(!1)},r.prototype.defaultTo=function(t){if(void 0===t)return"";if(null===t)t="null";else if(t instanceof i)t=t.toQuery();else if("bool"===this.type)"false"===t&&(t=0),t="'"+(t?1:0)+"'";else{if("json"===this.type&&n.isObject(t))return JSON.stringify(t);t="'"+t+"'"}return"default "+t},r.prototype._num=function(t,e){if(void 0===t||null===t)return e;var r=parseInt(t,10);return isNaN(r)?e:r},e.exports=r},{"../raw":108,lodash:130}],113:[function(t,e){"use strict";function r(t){this.builder=t,this.initCompiler()}function n(t){return function(e,r){for(var n=this.client.TableBuilder,i=new n(t,e,r).toSQL(),o=0,s=i.length;s>o;o++)this.sequence.push(i[o])}}r.prototype.createTable=n("create"),r.prototype.createTableIfNotExists=n("createIfNot"),r.prototype.alterTable=n("alter"),r.prototype.dropTable=function(t){this.pushQuery("drop table "+this.formatter.wrap(t))},r.prototype.dropTableIfExists=function(t){this.pushQuery("drop table if exists "+this.formatter.wrap(t))},r.prototype.toSQL=function(){for(var t=this.builder._sequence,e=0,r=t.length;r>e;e++){var n=t[e];this[n.method].apply(this,n.args)}return this.sequence},r.prototype.raw=function(t,e){this.sequence.push(new this.client.Raw(t,e).toSQL())},e.exports=r},{}],114:[function(t,e){"use strict";var r=t("lodash"),n=t("./builder"),i=t("./compiler"),o=t("./tablebuilder"),s=t("./tablecompiler"),a=t("./columnbuilder"),u=t("./columncompiler");i.prototype.initCompiler=s.prototype.initCompiler=u.prototype.initCompiler=function(){this.formatter=new this.Formatter,this.sequence=[]},i.prototype.pushQuery=s.prototype.pushQuery=u.prototype.pushQuery=function(t){t&&(t=r.isString(t)?{sql:t}:t,t.bindings||(t.bindings=this.formatter.bindings),this.sequence.push(t),this.formatter=new this.Formatter)},u.prototype.pushAdditional=function(t){var e=new this.constructor(this.tableCompiler,this.columnBuilder);t.call(e,r.rest(arguments)),this.sequence.additional=(this.sequence.additional||[]).concat(e.sequence)},e.exports={Builder:n,Compiler:i,TableBuilder:o,TableCompiler:s,ColumnBuilder:a,ColumnCompiler:u}},{"./builder":110,"./columnbuilder":111,"./columncompiler":112,"./compiler":113,"./tablebuilder":115,"./tablecompiler":116,lodash:130}],115:[function(t,e){"use strict";function r(t,e,r){this._fn=r,this._method=t,this._tableName=e,this._statements=[],this._single={}}var n=t("lodash"),i=t("../helpers"),o={renameColumn:function(t,e){return this._statements.push({grouping:"alterTable",method:"renameColumn",args:[t,e]}),this},dropTimestamps:function(){return this.dropColumns(["created_at","updated_at"])}};o.dropColumn=o.dropColumns=function(){return this._statements.push({grouping:"alterTable",method:"dropColumn",args:n.toArray(arguments)}),this},r.prototype.toSQL=function(){"alter"===this._method&&n.extend(this,o),this._fn.call(this,this);var t=this.client.TableCompiler;return new t(this).toSQL()},n.each(["index","primary","unique","dropPrimary","dropUnique","dropIndex","dropForeign"],function(t){r.prototype[t]=function(){return this._statements.push({grouping:"alterTable",method:t,args:n.toArray(arguments)}),this}});var s=["engine","charset","collate"];n.each(s,function(t){r.prototype[t]=function(e){"alter"===this.__method&&i.warn("Knex does not support altering the "+t+" outside of the create table, please use knex.raw statement."),this._single[t]=e}});var a=["tinyint","smallint","mediumint","int","bigint","decimal","float","double","real","bit","boolean","serial","date","datetime","timestamp","time","year","char","varchar","tinytext","tinyText","text","mediumtext","mediumText","longtext","longText","binary","varbinary","tinyblob","tinyBlob","mediumblob","mediumBlob","blob","longblob","longBlob","enum","set","bool","dateTime","increments","bigincrements","bigIncrements","integer","biginteger","bigInteger","string","timestamps","json","uuid","enu","specificType"];n.each(a,function(t){r.prototype[t]=function(){var e=n.toArray(arguments);if("timestamps"===t)return void(e[0]===!0?(this.timestamp("created_at"),this.timestamp("updated_at")):(this.datetime("created_at"),this.datetime("updated_at")));var r=this.client.ColumnBuilder,i=new r(this,t,e);return this._statements.push({grouping:"columns",builder:i}),i}}),r.prototype.comment=function(t){this._single.comment=t},r.prototype.foreign=function(t){var e={column:t};this._statements.push({grouping:"alterTable",method:"foreign",args:[e]});var r={references:function(t){var i;return n.isString(t)&&(i=t.split(".")),i&&1!==i.length?(e.inTable=i[0],e.references=i[1],r):(e.references=i?i[0]:t,{on:function(t){return e.inTable=t,r},inTable:function(){return this.on.apply(this,arguments)}})},onUpdate:function(t){return e.onUpdate=t,r},onDelete:function(t){return e.onDelete=t,r},_columnBuilder:function(t){return n.extend(t,r),r=t,t}};return r},e.exports=r},{"../helpers":99,lodash:130}],116:[function(t,e){"use strict";function r(t){this.method=t._method,this.tableNameRaw=t._tableName,this.single=t._single,this.grouped=n.groupBy(t._statements,"grouping"),this.initCompiler()}var n=t("lodash"),i=t("../helpers");r.prototype.toSQL=function(){return this[this.method](),this.sequence},r.prototype.create=function(t){var e=this.getColumns(),r=this.getColumnTypes(e);this.createQuery(r,t),this.columnQueries(e),delete this.single.comment,this.alterTable()},r.prototype.createIfNot=function(){this.create(!0)},r.prototype.alter=function(){var t=this.getColumns(),e=this.getColumnTypes(t);this.addColumns(e),this.columnQueries(t),this.alterTable()},r.prototype.foreign=function(t){if(t.inTable&&t.references){var e=this._indexCommand("foreign",this.tableNameRaw,t.column),r=this.formatter.columnize(t.column),n=this.formatter.columnize(t.references),i=this.formatter.wrap(t.inTable),o=t.onUpdate?" on update "+t.onUpdate:"",s=t.onDelete?" on delete "+t.onDelete:"";this.pushQuery("alter table "+this.tableName()+" add constraint "+e+" foreign key ("+r+") references "+i+" ("+n+")"+o+s)}},r.prototype.getColumnTypes=function(t){return n.reduce(n.map(t,n.first),function(t,e){return t.sql.push(e.sql),t.bindings.concat(e.bindings),t},{sql:[],bindings:[]})},r.prototype.columnQueries=function(t){for(var e=n.reduce(n.map(t,n.rest),function(t,e){return n.isEmpty(e)?t:t.concat(e)},[]),r=0,i=e.length;i>r;r++)this.pushQuery(e[r])},r.prototype.addColumnsPrefix="add column ",r.prototype.addColumns=function(t){if(t.sql.length>0){var e=n.map(t.sql,function(t){return this.addColumnsPrefix+t},this);this.pushQuery({sql:"alter table "+this.tableName()+" "+e.join(", "),bindings:t.bindings})}},r.prototype.getColumns=function(){for(var t=[],e=this.grouped.columns||[],r=this.client.ColumnCompiler,n=0,i=e.length;i>n;n++)t.push(new r(this,e[n].builder).toSQL());return t},r.prototype.tableName=function(){return this.formatter.wrap(this.tableNameRaw)},r.prototype.alterTable=function(){for(var t=this.grouped.alterTable||[],e=0,r=t.length;r>e;e++){var i=t[e];this[i.method]?this[i.method].apply(this,i.args):console.error("Debug: "+i.method+" does not exist")}for(var o in this.single)n.isFunction(this[o])&&this[o](this.single[o])},r.prototype.dropIndex=function(t){this.pushQuery("drop index"+t)},r.prototype.dropUnique=r.prototype.dropForeign=function(){throw new Error("Method implemented in the dialect driver")},r.prototype.dropColumnPrefix="drop column ",r.prototype.dropColumn=function(){var t=i.normalizeArr.apply(null,arguments),e=n.map(n.isArray(t)?t:[t],function(t){return this.dropColumnPrefix+this.formatter.wrap(t)},this);this.pushQuery("alter table "+this.tableName()+" "+e.join(", "))},r.prototype._indexCommand=function(t,e,r){n.isArray(r)||(r=r?[r]:[]);var i=e.replace(/\.|-/g,"_");return(i+"_"+r.join("_")+"_"+t).toLowerCase()},e.exports=r},{"../helpers":99,lodash:130}],117:[function(t,e){(function(r,n){"use strict";function i(t){this.knex=t,this.config=this.setConfig(t.client.seedConfig)}var o=t("fs"),s=t("path"),a=t("lodash"),u=t("mkdirp"),l=t("../promise");i.prototype.run=l.method(function(t){return this.config=this.setConfig(t),this._seedData().bind(this).spread(function(t){return this._runSeeds(t)})}),i.prototype.make=function(t,e){return this.config=this.setConfig(e),t||l.rejected(new Error("A name must be specified for the generated seed")),this._ensureFolder(e).bind(this).then(this._generateStubTemplate).then(this._writeNewSeed(t))},i.prototype._listAll=l.method(function(t){return this.config=this.setConfig(t),l.promisify(o.readdir,o)(this._absoluteConfigDir()).bind(this).then(function(t){return a.filter(t,function(t){var e=s.extname(t);return a.contains([".co",".coffee",".iced",".js",".litcoffee",".ls"],e)}).sort()})}),i.prototype._seedData=function(){return l.join(this._listAll())},i.prototype._ensureFolder=function(){var t=this._absoluteConfigDir();return l.promisify(o.stat,o)(t).catch(function(){return l.promisify(u)(t)})},i.prototype._runSeeds=function(t){return l.all(a.map(t,this._validateSeedStructure,this)).bind(this).then(function(t){return l.bind(this).then(function(){return this._waterfallBatch(t)})})},i.prototype._validateSeedStructure=function(e){var r=t(s.join(this._absoluteConfigDir(),e));if(!a.isFunction(r.seed))throw new Error("Invalid seed file: "+e+" must have a seed function");return e},i.prototype._generateStubTemplate=function(){var t=this.config.stub||s.join(n,"stub",this.config.extension+".stub");return l.promisify(o.readFile,o)(t).then(function(t){return a.template(t.toString(),null,{variable:"d"})})},i.prototype._writeNewSeed=function(t){var e=this.config,r=this._absoluteConfigDir();return function(n){"-"===t[0]&&(t=t.slice(1));var i=t+"."+e.extension;return l.promisify(o.writeFile,o)(s.join(r,i),n(e.variables||{})).return(s.join(r,i))}},i.prototype._waterfallBatch=function(e){var r=this.knex,n=this._absoluteConfigDir(),i=l.bind({failed:!1,failedOn:0}),o=[];return a.each(e,function(e){var a=s.join(n,e);e=t(a),i=i.then(function(){return e.seed(r,l)}).then(function(){o.push(a)})}),i.thenReturn([o])},i.prototype._absoluteConfigDir=function(){return s.resolve(r.cwd(),this.config.directory)},i.prototype.setConfig=function(t){return a.extend({extension:"js",directory:"./seeds"},this.config||{},t)},e.exports=i}).call(this,t("_process"),"/node_modules/knex/lib/seed")},{"../promise":103,_process:60,fs:51,lodash:130,mkdirp:120,path:59}],118:[function(t,e){"use strict";function r(t){this.container=t}var n=t("./promise"),i=t("inherits"),o=t("events").EventEmitter;i(r,o),r.prototype.containerObject=function(e){var r=t("../knex"),n=r.initialize({__client__:this.client,__transactor__:{_runner:e}});return n.destroy=n.transaction=void 0,n.commit=function(t){e.finishTransaction(0,n,t)},n.rollback=function(t){e.finishTransaction(1,n,t)},n._runner=e,n},r.prototype.initiateDeferred=function(t){var e=t.__dfd__=n.pending(),r=this.container(t);return r&&r.then&&"function"==typeof r.then&&r.then(function(e){t.commit(e)}).catch(function(e){t.rollback(e)}),e.promise},t("./interface")(r),r.prototype.then=function(t,e){var r=this.client.Runner,n=this;return new r(this).startTransaction().then(function(t){return n.containerObject(t)}).then(function(t){return n.initiateDeferred(t)}).then(t,e)},e.exports=r},{"../knex":77,"./interface":100,"./promise":103,events:57,inherits:76}],119:[function(e,r,n){!function(t){"use strict";t(function(t,e,r){var n=function(t){this.slots=[],this.queueSize=Math.max(0|+t,1);for(var e=0;e<this.queueSize;e+=1)this.slots.push([])};n.prototype={total:null,size:function(){if(null===this.total){this.total=0;for(var t=0;t<this.queueSize;t+=1)this.total+=this.slots[t].length}return this.total},enqueue:function(t,e){if(e=e&&0|+e||0,this.total=null,e){(0>e||e>=this.queueSize)&&(e=this.size-1)}this.slots[e].push(t)},dequeue:function(){var t,e=null,r=this.slots.length;for(this.total=null,t=0;r>t;t+=1)if(this.slots[t].length){e=this.slots[t].shift();break}return e}};var i=function(t){if(!(this instanceof i))return new i(t);this.idleTimeoutMillis=t.idleTimeoutMillis||3e4,this.reapInterval=t.reapIntervalMillis||1e3,this.destroyHandler=t.destroy||function(){},this.refreshIdle="refreshIdle"in t?t.refreshIdle:!0,this.availableObjects=[],this.waitingClients=new n(t.priorityRange||1),this.create=t.create||function(){throw new Error("A create method must be defined for the connection pool.")}(),t.validate&&(this.validate=t.validate);var e=parseInt(t.max,10),r=parseInt(t.min,10);this.max=Math.max(isNaN(e)?1:e,1),this.min=Math.min(isNaN(r)?0:r,this.max-1),this.ensureMinimum()};i.prototype={count:0,draining:!1,removeIdleTimer:null,removeIdleScheduled:!1,validate:function(){return!0},acquire:function(t,e){return this.draining?t(new Error("Pool is draining and cannot accept work")):(this.waitingClients.enqueue(t,e),this.dispense(),this.count<this.max)},release:function(t,e){if(this.availableObjects.some(function(e){return e.obj===t}))return void(e&&e(new Error("Release called multiple times on the same object")));var r={obj:t,timeout:(new Date).getTime()+this.idleTimeoutMillis};this.availableObjects.push(r),this.dispense(),this.scheduleRemoveIdle(),e&&e(null)},dispense:function(){var t=null,e=null,r=null,n=this.waitingClients.size();if(n>0){for(;this.availableObjects.length>0;){t=this.availableObjects[0];{if(this.validate(t.obj))return this.availableObjects.shift(),(r=this.waitingClients.dequeue())(e,t.obj);this.destroy(t.obj)}}this.count<this.max&&this.createResource()}},drain:function(t){this.draining=!0;var e=this,r=function(){e.waitingClients.size()>0||e.availableObjects.length!=e.count?setTimeout(r,100):t&&t()};r()},destroyAllNow:function(t){var e=this.availableObjects;this.availableObjects=[];for(var r=e.shift();null!==r&&void 0!==r;)this.destroy(r.obj),r=e.shift();this.removeIdleScheduled=!1,clearTimeout(this.removeIdleTimer),t&&t()
},pooled:function(t,e){var r=this;return function(){var n=arguments,i=n[n.length-1],s="function"==typeof i;r.acquire(function(e,a){if(e)return void(s&&i(e,null));var u=[a].concat(o.call(n,0,s?-1:void 0));u.push(function(){r.release.call(r,a),s&&i.apply(null,arguments)}),t.apply(null,u)},e)}},destroy:function(t){this.count-=1,this.availableObjects=this.availableObjects.filter(function(e){return e.obj!==t}),this.destroyHandler(t),this.ensureMinimum()},removeIdle:function(){var t,e,r,n,i=[],o=(new Date).getTime();for(this.removeIdleScheduled=!1,t=0,e=this.availableObjects.length;e>t&&(this.refreshIdle||this.count-this.min>i.length);t+=1)n=this.availableObjects[t].timeout,o>=n&&i.push(this.availableObjects[t].obj);for(t=0,r=i.length;r>t;t+=1)this.destroy(i[t]);e=this.availableObjects.length,e>0&&this.scheduleRemoveIdle()},scheduleRemoveIdle:function(){if(!this.removeIdleScheduled){this.removeIdleScheduled=!0;var t=this;this.removeIdleTimer=setTimeout(function(){t.removeIdle.call(t)},this.reapInterval)}},createResource:function(){var t=this;this.count+=1,this.create(function(e,r){var n=t.waitingClients.dequeue();if(e)t.count-=1,n&&n(e,null),setTimeout(function(){t.dispense.call(t)},0);else{if(n)return n(null,r);t.release(r)}})},ensureMinimum:function(){var t,e;if(!this.draining&&this.count<this.min)for(e=this.min-this.count,t=0;e>t;t++)this.createResource()}};var o=Array.prototype.slice;r.exports={Pool:i,PriorityQueue:n}})}("function"==typeof t&&t.amd?t:function(t){t(e,n,r)})},{}],120:[function(t,e){(function(r){function n(t,e,s,a){"function"==typeof e?(s=e,e={}):e&&"object"==typeof e||(e={mode:e});var u=e.mode,l=e.fs||o;void 0===u&&(u=511&~r.umask()),a||(a=null);var c=s||function(){};t=i.resolve(t),l.mkdir(t,u,function(r){if(!r)return a=a||t,c(null,a);switch(r.code){case"ENOENT":n(i.dirname(t),e,function(r,i){r?c(r,i):n(t,e,c,i)});break;default:l.stat(t,function(t,e){t||!e.isDirectory()?c(r,a):c(null,a)})}})}var i=t("path"),o=t("fs");e.exports=n.mkdirp=n.mkdirP=n,n.sync=function s(t,e,n){e&&"object"==typeof e||(e={mode:e});var a=e.mode,u=e.fs||o;void 0===a&&(a=511&~r.umask()),n||(n=null),t=i.resolve(t);try{u.mkdirSync(t,a),n=n||t}catch(l){switch(l.code){case"ENOENT":n=s(i.dirname(t),e,n),s(t,e,n);break;default:var c;try{c=u.statSync(t)}catch(h){throw l}if(!c.isDirectory())throw l}}return n}}).call(this,t("_process"))},{_process:60,fs:51,path:59}],121:[function(t,e,r){arguments[4][62][0].apply(r,arguments)},{"./_stream_readable":123,"./_stream_writable":125,"/Users/tgriesser/Github/bookshelf/bookshelf/node_modules/browserify/node_modules/readable-stream/lib/_stream_duplex.js":62,_process:60,"core-util-is":126,inherits:76}],122:[function(t,e,r){arguments[4][63][0].apply(r,arguments)},{"./_stream_transform":124,"/Users/tgriesser/Github/bookshelf/bookshelf/node_modules/browserify/node_modules/readable-stream/lib/_stream_passthrough.js":63,"core-util-is":126,inherits:76}],123:[function(t,e){(function(r){function n(e,r){var n=t("./_stream_duplex");e=e||{};var i=e.highWaterMark,o=e.objectMode?16:16384;this.highWaterMark=i||0===i?i:o,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,r instanceof n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(A||(A=t("string_decoder/").StringDecoder),this.decoder=new A(e.encoding),this.encoding=e.encoding)}function i(e){t("./_stream_duplex");return this instanceof i?(this._readableState=new n(e,this),this.readable=!0,void T.call(this)):new i(e)}function o(t,e,r,n,i){var o=l(e,r);if(o)t.emit("error",o);else if(R.isNullOrUndefined(r))e.reading=!1,e.ended||c(t,e);else if(e.objectMode||r&&r.length>0)if(e.ended&&!i){var a=new Error("stream.push() after EOF");t.emit("error",a)}else if(e.endEmitted&&i){var a=new Error("stream.unshift() after end event");t.emit("error",a)}else!e.decoder||i||n||(r=e.decoder.write(r)),i||(e.reading=!1),e.flowing&&0===e.length&&!e.sync?(t.emit("data",r),t.read(0)):(e.length+=e.objectMode?1:r.length,i?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&h(t)),p(t,e);else i||(e.reading=!1);return s(e)}function s(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}function a(t){if(t>=S)t=S;else{t--;for(var e=1;32>e;e<<=1)t|=t>>e;t++}return t}function u(t,e){return 0===e.length&&e.ended?0:e.objectMode?0===t?0:1:isNaN(t)||R.isNull(t)?e.flowing&&e.buffer.length?e.buffer[0].length:e.length:0>=t?0:(t>e.highWaterMark&&(e.highWaterMark=a(t)),t>e.length?e.ended?e.length:(e.needReadable=!0,0):t)}function l(t,e){var r=null;return R.isBuffer(e)||R.isString(e)||R.isNullOrUndefined(e)||t.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}function c(t,e){if(e.decoder&&!e.ended){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,h(t)}function h(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(C("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?r.nextTick(function(){f(t)}):f(t))}function f(t){C("emit readable"),t.emit("readable"),y(t)}function p(t,e){e.readingMore||(e.readingMore=!0,r.nextTick(function(){d(t,e)}))}function d(t,e){for(var r=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(C("maybeReadMore read 0"),t.read(0),r!==e.length);)r=e.length;e.readingMore=!1}function g(t){return function(){var e=t._readableState;C("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&k.listenerCount(t,"data")&&(e.flowing=!0,y(t))}}function m(t,e){e.resumeScheduled||(e.resumeScheduled=!0,r.nextTick(function(){v(t,e)}))}function v(t,e){e.resumeScheduled=!1,t.emit("resume"),y(t),e.flowing&&!e.reading&&t.read(0)}function y(t){var e=t._readableState;if(C("flow",e.flowing),e.flowing)do var r=t.read();while(null!==r&&e.flowing)}function _(t,e){var r,n=e.buffer,i=e.length,o=!!e.decoder,s=!!e.objectMode;if(0===n.length)return null;if(0===i)r=null;else if(s)r=n.shift();else if(!t||t>=i)r=o?n.join(""):E.concat(n,i),n.length=0;else if(t<n[0].length){var a=n[0];r=a.slice(0,t),n[0]=a.slice(t)}else if(t===n[0].length)r=n.shift();else{r=o?"":new E(t);for(var u=0,l=0,c=n.length;c>l&&t>u;l++){var a=n[0],h=Math.min(t-u,a.length);o?r+=a.slice(0,h):a.copy(r,u,0,h),h<a.length?n[0]=a.slice(h):n.shift(),u+=h}}return r}function b(t){var e=t._readableState;if(e.length>0)throw new Error("endReadable called on non-empty stream");e.endEmitted||(e.ended=!0,r.nextTick(function(){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}))}function w(t,e){for(var r=0,n=t.length;n>r;r++)e(t[r],r)}function j(t,e){for(var r=0,n=t.length;n>r;r++)if(t[r]===e)return r;return-1}e.exports=i;var x=t("isarray"),E=t("buffer").Buffer;i.ReadableState=n;var k=t("events").EventEmitter;k.listenerCount||(k.listenerCount=function(t,e){return t.listeners(e).length});var T=t("stream"),R=t("core-util-is");R.inherits=t("inherits");var A,C=t("util");C=C&&C.debuglog?C.debuglog("stream"):function(){},R.inherits(i,T),i.prototype.push=function(t,e){var r=this._readableState;return R.isString(t)&&!r.objectMode&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=new E(t,e),e="")),o(this,r,t,e,!1)},i.prototype.unshift=function(t){var e=this._readableState;return o(this,e,t,"",!0)},i.prototype.setEncoding=function(e){return A||(A=t("string_decoder/").StringDecoder),this._readableState.decoder=new A(e),this._readableState.encoding=e,this};var S=8388608;i.prototype.read=function(t){C("read",t);var e=this._readableState,r=t;if((!R.isNumber(t)||t>0)&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return C("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?b(this):h(this),null;if(t=u(t,e),0===t&&e.ended)return 0===e.length&&b(this),null;var n=e.needReadable;C("need readable",n),(0===e.length||e.length-t<e.highWaterMark)&&(n=!0,C("length less than watermark",n)),(e.ended||e.reading)&&(n=!1,C("reading or ended",n)),n&&(C("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1),n&&!e.reading&&(t=u(r,e));var i;return i=t>0?_(t,e):null,R.isNull(i)&&(e.needReadable=!0,t=0),e.length-=t,0!==e.length||e.ended||(e.needReadable=!0),r!==t&&e.ended&&0===e.length&&b(this),R.isNull(i)||this.emit("data",i),i},i.prototype._read=function(){this.emit("error",new Error("not implemented"))},i.prototype.pipe=function(t,e){function n(t){C("onunpipe"),t===h&&o()}function i(){C("onend"),t.end()}function o(){C("cleanup"),t.removeListener("close",u),t.removeListener("finish",l),t.removeListener("drain",m),t.removeListener("error",a),t.removeListener("unpipe",n),h.removeListener("end",i),h.removeListener("end",o),h.removeListener("data",s),!f.awaitDrain||t._writableState&&!t._writableState.needDrain||m()}function s(e){C("ondata");var r=t.write(e);!1===r&&(C("false write response, pause",h._readableState.awaitDrain),h._readableState.awaitDrain++,h.pause())}function a(e){C("onerror",e),c(),t.removeListener("error",a),0===k.listenerCount(t,"error")&&t.emit("error",e)}function u(){t.removeListener("finish",l),c()}function l(){C("onfinish"),t.removeListener("close",u),c()}function c(){C("unpipe"),h.unpipe(t)}var h=this,f=this._readableState;switch(f.pipesCount){case 0:f.pipes=t;break;case 1:f.pipes=[f.pipes,t];break;default:f.pipes.push(t)}f.pipesCount+=1,C("pipe count=%d opts=%j",f.pipesCount,e);var p=(!e||e.end!==!1)&&t!==r.stdout&&t!==r.stderr,d=p?i:o;f.endEmitted?r.nextTick(d):h.once("end",d),t.on("unpipe",n);var m=g(h);return t.on("drain",m),h.on("data",s),t._events&&t._events.error?x(t._events.error)?t._events.error.unshift(a):t._events.error=[a,t._events.error]:t.on("error",a),t.once("close",u),t.once("finish",l),t.emit("pipe",h),f.flowing||(C("pipe resume"),h.resume()),t},i.prototype.unpipe=function(t){var e=this._readableState;if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this),this);if(!t){var r=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var i=0;n>i;i++)r[i].emit("unpipe",this);return this}var i=j(e.pipes,t);return-1===i?this:(e.pipes.splice(i,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this),this)},i.prototype.on=function(t,e){var n=T.prototype.on.call(this,t,e);if("data"===t&&!1!==this._readableState.flowing&&this.resume(),"readable"===t&&this.readable){var i=this._readableState;if(!i.readableListening)if(i.readableListening=!0,i.emittedReadable=!1,i.needReadable=!0,i.reading)i.length&&h(this,i);else{var o=this;r.nextTick(function(){C("readable nexttick read 0"),o.read(0)})}}return n},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){var t=this._readableState;return t.flowing||(C("resume"),t.flowing=!0,t.reading||(C("resume read 0"),this.read(0)),m(this,t)),this},i.prototype.pause=function(){return C("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(C("pause"),this._readableState.flowing=!1,this.emit("pause")),this},i.prototype.wrap=function(t){var e=this._readableState,r=!1,n=this;t.on("end",function(){if(C("wrapped end"),e.decoder&&!e.ended){var t=e.decoder.end();t&&t.length&&n.push(t)}n.push(null)}),t.on("data",function(i){if(C("wrapped data"),e.decoder&&(i=e.decoder.write(i)),i&&(e.objectMode||i.length)){var o=n.push(i);o||(r=!0,t.pause())}});for(var i in t)R.isFunction(t[i])&&R.isUndefined(this[i])&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));var o=["error","close","destroy","pause","resume"];return w(o,function(e){t.on(e,n.emit.bind(n,e))}),n._read=function(e){C("wrapped _read",e),r&&(r=!1,t.resume())},n},i._fromList=_}).call(this,t("_process"))},{"./_stream_duplex":121,_process:60,buffer:53,"core-util-is":126,events:57,inherits:76,isarray:127,stream:72,"string_decoder/":128,util:52}],124:[function(t,e){function r(t,e){this.afterTransform=function(t,r){return n(e,t,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function n(t,e,r){var n=t._transformState;n.transforming=!1;var i=n.writecb;if(!i)return t.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,a.isNullOrUndefined(r)||t.push(r),i&&i(e);var o=t._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&t._read(o.highWaterMark)}function i(t){if(!(this instanceof i))return new i(t);s.call(this,t),this._transformState=new r(t,this);var e=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){a.isFunction(this._flush)?this._flush(function(t){o(e,t)}):o(e)})}function o(t,e){if(e)return t.emit("error",e);var r=t._writableState,n=t._transformState;if(r.length)throw new Error("calling transform done when ws.length != 0");if(n.transforming)throw new Error("calling transform done when still transforming");return t.push(null)}e.exports=i;var s=t("./_stream_duplex"),a=t("core-util-is");a.inherits=t("inherits"),a.inherits(i,s),i.prototype.push=function(t,e){return this._transformState.needTransform=!1,s.prototype.push.call(this,t,e)},i.prototype._transform=function(){throw new Error("not implemented")},i.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},i.prototype._read=function(){var t=this._transformState;a.isNull(t.writechunk)||!t.writecb||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))}},{"./_stream_duplex":121,"core-util-is":126,inherits:76}],125:[function(t,e){(function(r){function n(t,e,r){this.chunk=t,this.encoding=e,this.callback=r}function i(e,r){var n=t("./_stream_duplex");e=e||{};var i=e.highWaterMark,o=e.objectMode?16:16384;this.highWaterMark=i||0===i?i:o,this.objectMode=!!e.objectMode,r instanceof n&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var s=e.decodeStrings===!1;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){p(r,t)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function o(e){var r=t("./_stream_duplex");return this instanceof o||this instanceof r?(this._writableState=new i(e,this),this.writable=!0,void x.call(this)):new o(e)}function s(t,e,n){var i=new Error("write after end");t.emit("error",i),r.nextTick(function(){n(i)})}function a(t,e,n,i){var o=!0;if(!(j.isBuffer(n)||j.isString(n)||j.isNullOrUndefined(n)||e.objectMode)){var s=new TypeError("Invalid non-string/buffer chunk");t.emit("error",s),r.nextTick(function(){i(s)}),o=!1}return o}function u(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&j.isString(e)&&(e=new w(e,r)),e}function l(t,e,r,i,o){r=u(e,r,i),j.isBuffer(r)&&(i="buffer");var s=e.objectMode?1:r.length;e.length+=s;var a=e.length<e.highWaterMark;return a||(e.needDrain=!0),e.writing||e.corked?e.buffer.push(new n(r,i,o)):c(t,e,!1,s,r,i,o),a}function c(t,e,r,n,i,o,s){e.writelen=n,e.writecb=s,e.writing=!0,e.sync=!0,r?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function h(t,e,n,i,o){n?r.nextTick(function(){e.pendingcb--,o(i)}):(e.pendingcb--,o(i)),t._writableState.errorEmitted=!0,t.emit("error",i)}function f(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function p(t,e){var n=t._writableState,i=n.sync,o=n.writecb;if(f(n),e)h(t,n,i,e,o);else{var s=v(t,n);s||n.corked||n.bufferProcessing||!n.buffer.length||m(t,n),i?r.nextTick(function(){d(t,n,s,o)}):d(t,n,s,o)}}function d(t,e,r,n){r||g(t,e),e.pendingcb--,n(),_(t,e)}function g(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function m(t,e){if(e.bufferProcessing=!0,t._writev&&e.buffer.length>1){for(var r=[],n=0;n<e.buffer.length;n++)r.push(e.buffer[n].callback);e.pendingcb++,c(t,e,!0,e.length,e.buffer,"",function(t){for(var n=0;n<r.length;n++)e.pendingcb--,r[n](t)}),e.buffer=[]}else{for(var n=0;n<e.buffer.length;n++){var i=e.buffer[n],o=i.chunk,s=i.encoding,a=i.callback,u=e.objectMode?1:o.length;if(c(t,e,!1,u,o,s,a),e.writing){n++;break}}n<e.buffer.length?e.buffer=e.buffer.slice(n):e.buffer.length=0}e.bufferProcessing=!1}function v(t,e){return e.ending&&0===e.length&&!e.finished&&!e.writing}function y(t,e){e.prefinished||(e.prefinished=!0,t.emit("prefinish"))}function _(t,e){var r=v(t,e);return r&&(0===e.pendingcb?(y(t,e),e.finished=!0,t.emit("finish")):y(t,e)),r}function b(t,e,n){e.ending=!0,_(t,e),n&&(e.finished?r.nextTick(n):t.once("finish",n)),e.ended=!0}e.exports=o;var w=t("buffer").Buffer;o.WritableState=i;var j=t("core-util-is");j.inherits=t("inherits");var x=t("stream");j.inherits(o,x),o.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},o.prototype.write=function(t,e,r){var n=this._writableState,i=!1;return j.isFunction(e)&&(r=e,e=null),j.isBuffer(t)?e="buffer":e||(e=n.defaultEncoding),j.isFunction(r)||(r=function(){}),n.ended?s(this,n,r):a(this,n,t,r)&&(n.pendingcb++,i=l(this,n,t,e,r)),i},o.prototype.cork=function(){var t=this._writableState;t.corked++},o.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.buffer.length||m(this,t))},o.prototype._write=function(t,e,r){r(new Error("not implemented"))},o.prototype._writev=null,o.prototype.end=function(t,e,r){var n=this._writableState;j.isFunction(t)?(r=t,t=null,e=null):j.isFunction(e)&&(r=e,e=null),j.isNullOrUndefined(t)||this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||b(this,n,r)}}).call(this,t("_process"))},{"./_stream_duplex":121,_process:60,buffer:53,"core-util-is":126,inherits:76,stream:72}],126:[function(t,e){e.exports=t(67)},{"/Users/tgriesser/Github/bookshelf/bookshelf/node_modules/browserify/node_modules/readable-stream/node_modules/core-util-is/lib/util.js":67,buffer:53}],127:[function(t,e){e.exports=t(58)},{"/Users/tgriesser/Github/bookshelf/bookshelf/node_modules/browserify/node_modules/isarray/index.js":58}],128:[function(t,e){e.exports=t(73)},{"/Users/tgriesser/Github/bookshelf/bookshelf/node_modules/browserify/node_modules/string_decoder/index.js":73,buffer:53}],129:[function(t,e,r){r=e.exports=t("./lib/_stream_readable.js"),r.Stream=t("stream"),r.Readable=r,r.Writable=t("./lib/_stream_writable.js"),r.Duplex=t("./lib/_stream_duplex.js"),r.Transform=t("./lib/_stream_transform.js"),r.PassThrough=t("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":121,"./lib/_stream_passthrough.js":122,"./lib/_stream_readable.js":123,"./lib/_stream_transform.js":124,"./lib/_stream_writable.js":125,stream:72}],130:[function(e,r,n){(function(e){(function(){function i(t,e,r){for(var n=(r||0)-1,i=t?t.length:0;++n<i;)if(t[n]===e)return n;return-1}function o(t,e){var r=typeof e;if(t=t.cache,"boolean"==r||null==e)return t[e]?0:-1;"number"!=r&&"string"!=r&&(r="object");var n="number"==r?e:w+e;return t=(t=t[r])&&t[n],"object"==r?t&&i(t,e)>-1?0:-1:t?0:-1}function s(t){var e=this.cache,r=typeof t;if("boolean"==r||null==t)e[t]=!0;else{"number"!=r&&"string"!=r&&(r="object");var n="number"==r?t:w+t,i=e[r]||(e[r]={});"object"==r?(i[n]||(i[n]=[])).push(t):i[n]=!0}}function a(t){return t.charCodeAt(0)}function u(t,e){for(var r=t.criteria,n=e.criteria,i=-1,o=r.length;++i<o;){var s=r[i],a=n[i];if(s!==a){if(s>a||"undefined"==typeof s)return 1;if(a>s||"undefined"==typeof a)return-1}}return t.index-e.index}function l(t){var e=-1,r=t.length,n=t[0],i=t[r/2|0],o=t[r-1];if(n&&"object"==typeof n&&i&&"object"==typeof i&&o&&"object"==typeof o)return!1;var a=f();a["false"]=a["null"]=a["true"]=a.undefined=!1;var u=f();for(u.array=t,u.cache=a,u.push=s;++e<r;)u.push(t[e]);return u}function c(t){return"\\"+G[t]}function h(){return y.pop()||[]}function f(){return _.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function p(t){t.length=0,y.length<x&&y.push(t)}function d(t){var e=t.cache;e&&d(e),t.array=t.cache=t.criteria=t.object=t.number=t.string=t.value=null,_.length<x&&_.push(t)}function g(t,e,r){e||(e=0),"undefined"==typeof r&&(r=t?t.length:0);for(var n=-1,i=r-e||0,o=Array(0>i?0:i);++n<i;)o[n]=t[e+n];return o}function m(t){function e(t){return t&&"object"==typeof t&&!Xn(t)&&In.call(t,"__wrapped__")?t:new r(t)}function r(t,e){this.__chain__=!!e,this.__wrapped__=t}function n(t){function e(){if(n){var t=g(n);Pn.apply(t,arguments)}if(this instanceof e){var o=y(r.prototype),s=r.apply(o,t||arguments);return Se(s)?s:o}return r.apply(i,t||arguments)}var r=t[0],n=t[2],i=t[4];return Gn(e,t),e}function s(t,e,r,n,i){if(r){var o=r(t);if("undefined"!=typeof o)return o}var a=Se(t);if(!a)return t;var u=Rn.call(t);if(!V[u])return t;var l=Jn[u];switch(u){case D:case $:return new l(+t);case z:case Q:return new l(t);case W:return o=l(t.source,C.exec(t)),o.lastIndex=t.lastIndex,o}var c=Xn(t);if(e){var f=!n;n||(n=h()),i||(i=h());for(var d=n.length;d--;)if(n[d]==t)return i[d];o=c?l(t.length):{}}else o=c?g(t):oi({},t);return c&&(In.call(t,"index")&&(o.index=t.index),In.call(t,"input")&&(o.input=t.input)),e?(n.push(t),i.push(o),(c?Ye:ui)(t,function(t,a){o[a]=s(t,e,r,n,i)}),f&&(p(n),p(i)),o):o}function y(t){return Se(t)?Dn(t):{}}function _(t,e,r){if("function"!=typeof t)return Gr;if("undefined"==typeof e||!("prototype"in t))return t;var n=t.__bindData__;if("undefined"==typeof n&&(Yn.funcNames&&(n=!t.name),n=n||!Yn.funcDecomp,!n)){var i=Nn.call(t);Yn.funcNames||(n=!S.test(i)),n||(n=I.test(i),Gn(t,n))}if(n===!1||n!==!0&&1&n[1])return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)};case 4:return function(r,n,i,o){return t.call(e,r,n,i,o)}}return Ir(t,e)}function x(t){function e(){var t=u?s:this;if(i){var p=g(i);Pn.apply(p,arguments)}if((o||c)&&(p||(p=g(arguments)),o&&Pn.apply(p,o),c&&p.length<a))return n|=16,x([r,h?n:-4&n,p,null,s,a]);if(p||(p=arguments),l&&(r=t[f]),this instanceof e){t=y(r.prototype);var d=r.apply(t,p);return Se(d)?d:t}return r.apply(t,p)}var r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=1&n,l=2&n,c=4&n,h=8&n,f=r;return Gn(e,t),e}function G(t,e){var r=-1,n=ue(),s=t?t.length:0,a=s>=j&&n===i,u=[];if(a){var c=l(e);c?(n=o,e=c):a=!1}for(;++r<s;){var h=t[r];n(e,h)<0&&u.push(h)}return a&&d(e),u}function Z(t,e,r,n){for(var i=(n||0)-1,o=t?t.length:0,s=[];++i<o;){var a=t[i];if(a&&"object"==typeof a&&"number"==typeof a.length&&(Xn(a)||fe(a))){e||(a=Z(a,e,r));var u=-1,l=a.length,c=s.length;for(s.length+=l;++u<l;)s[c++]=a[u]}else r||s.push(a)}return s}function te(t,e,r,n,i,o){if(r){var s=r(t,e);if("undefined"!=typeof s)return!!s}if(t===e)return 0!==t||1/t==1/e;var a=typeof t,u=typeof e;if(!(t!==t||t&&Y[a]||e&&Y[u]))return!1;if(null==t||null==e)return t===e;var l=Rn.call(t),c=Rn.call(e);if(l==L&&(l=H),c==L&&(c=H),l!=c)return!1;switch(l){case D:case $:return+t==+e;case z:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case W:case Q:return t==jn(e)}var f=l==B;if(!f){var d=In.call(t,"__wrapped__"),g=In.call(e,"__wrapped__");if(d||g)return te(d?t.__wrapped__:t,g?e.__wrapped__:e,r,n,i,o);if(l!=H)return!1;var m=t.constructor,v=e.constructor;if(m!=v&&!(Ce(m)&&m instanceof m&&Ce(v)&&v instanceof v)&&"constructor"in t&&"constructor"in e)return!1}var y=!i;i||(i=h()),o||(o=h());for(var _=i.length;_--;)if(i[_]==t)return o[_]==e;var b=0;if(s=!0,i.push(t),o.push(e),f){if(_=t.length,b=e.length,s=b==_,s||n)for(;b--;){var w=_,j=e[b];if(n)for(;w--&&!(s=te(t[w],j,r,n,i,o)););else if(!(s=te(t[b],j,r,n,i,o)))break}}else ai(e,function(e,a,u){return In.call(u,a)?(b++,s=In.call(t,a)&&te(t[a],e,r,n,i,o)):void 0}),s&&!n&&ai(t,function(t,e,r){return In.call(r,e)?s=--b>-1:void 0});return i.pop(),o.pop(),y&&(p(i),p(o)),s}function ee(t,e,r,n,i){(Xn(e)?Ye:ui)(e,function(e,o){var s,a,u=e,l=t[o];if(e&&((a=Xn(e))||li(e))){for(var c=n.length;c--;)if(s=n[c]==e){l=i[c];break}if(!s){var h;r&&(u=r(l,e),(h="undefined"!=typeof u)&&(l=u)),h||(l=a?Xn(l)?l:[]:li(l)?l:{}),n.push(e),i.push(l),h||ee(l,e,r,n,i)}}else r&&(u=r(l,e),"undefined"==typeof u&&(u=e)),"undefined"!=typeof u&&(l=u);t[o]=l})}function re(t,e){return t+Fn(Kn()*(e-t+1))}function ie(t,e,r){var n=-1,s=ue(),a=t?t.length:0,u=[],c=!e&&a>=j&&s===i,f=r||c?h():u;if(c){var g=l(f);s=o,f=g}for(;++n<a;){var m=t[n],v=r?r(m,n,t):m;(e?!n||f[f.length-1]!==v:s(f,v)<0)&&((r||c)&&f.push(v),u.push(m))}return c?(p(f.array),d(f)):r&&p(f),u}function oe(t){return function(r,n,i){var o={};n=e.createCallback(n,i,3);var s=-1,a=r?r.length:0;if("number"==typeof a)for(;++s<a;){var u=r[s];t(o,u,n(u,s,r),r)}else ui(r,function(e,r,i){t(o,e,n(e,r,i),i)});return o}}function se(t,e,r,i,o,s){var a=1&e,u=2&e,l=4&e,c=16&e,h=32&e;if(!u&&!Ce(t))throw new xn;c&&!r.length&&(e&=-17,c=r=!1),h&&!i.length&&(e&=-33,h=i=!1);var f=t&&t.__bindData__;if(f&&f!==!0)return f=g(f),f[2]&&(f[2]=g(f[2])),f[3]&&(f[3]=g(f[3])),!a||1&f[1]||(f[4]=o),!a&&1&f[1]&&(e|=8),!l||4&f[1]||(f[5]=s),c&&Pn.apply(f[2]||(f[2]=[]),r),h&&Ln.apply(f[3]||(f[3]=[]),i),f[1]|=e,se.apply(null,f);var p=1==e||17===e?n:x;return p([t,e,r,i,o,s])}function ae(t){return ei[t]}function ue(){var t=(t=e.indexOf)===vr?i:t;return t}function le(t){return"function"==typeof t&&An.test(t)}function ce(t){var e,r;return t&&Rn.call(t)==H&&(e=t.constructor,!Ce(e)||e instanceof e)?(ai(t,function(t,e){r=e}),"undefined"==typeof r||In.call(t,r)):!1}function he(t){return ri[t]}function fe(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Rn.call(t)==L||!1}function pe(t,e,r,n){return"boolean"!=typeof e&&null!=e&&(n=r,r=e,e=!1),s(t,e,"function"==typeof r&&_(r,n,1))}function de(t,e,r){return s(t,!0,"function"==typeof e&&_(e,r,1))}function ge(t,e){var r=y(t);return e?oi(r,e):r}function me(t,r,n){var i;return r=e.createCallback(r,n,3),ui(t,function(t,e,n){return r(t,e,n)?(i=e,!1):void 0}),i}function ve(t,r,n){var i;return r=e.createCallback(r,n,3),_e(t,function(t,e,n){return r(t,e,n)?(i=e,!1):void 0}),i}function ye(t,e,r){var n=[];ai(t,function(t,e){n.push(e,t)});var i=n.length;for(e=_(e,r,3);i--&&e(n[i--],n[i],t)!==!1;);return t}function _e(t,e,r){var n=ti(t),i=n.length;for(e=_(e,r,3);i--;){var o=n[i];if(e(t[o],o,t)===!1)break}return t}function be(t){var e=[];return ai(t,function(t,r){Ce(t)&&e.push(r)}),e.sort()}function we(t,e){return t?In.call(t,e):!1}function je(t){for(var e=-1,r=ti(t),n=r.length,i={};++e<n;){var o=r[e];i[t[o]]=o}return i}function xe(t){return t===!0||t===!1||t&&"object"==typeof t&&Rn.call(t)==D||!1}function Ee(t){return t&&"object"==typeof t&&Rn.call(t)==$||!1}function ke(t){return t&&1===t.nodeType||!1}function Te(t){var e=!0;if(!t)return e;var r=Rn.call(t),n=t.length;return r==B||r==Q||r==L||r==H&&"number"==typeof n&&Ce(t.splice)?!n:(ui(t,function(){return e=!1}),e)}function Re(t,e,r,n){return te(t,e,"function"==typeof r&&_(r,n,2))}function Ae(t){return Un(t)&&!zn(parseFloat(t))}function Ce(t){return"function"==typeof t}function Se(t){return!(!t||!Y[typeof t])}function Fe(t){return Oe(t)&&t!=+t}function Ne(t){return null===t}function Oe(t){return"number"==typeof t||t&&"object"==typeof t&&Rn.call(t)==z||!1}function Ie(t){return t&&"object"==typeof t&&Rn.call(t)==W||!1}function Pe(t){return"string"==typeof t||t&&"object"==typeof t&&Rn.call(t)==Q||!1}function qe(t){return"undefined"==typeof t}function Me(t,r,n){var i={};return r=e.createCallback(r,n,3),ui(t,function(t,e,n){i[e]=r(t,e,n)}),i}function Le(t){var e=arguments,r=2;if(!Se(t))return t;if("number"!=typeof e[2]&&(r=e.length),r>3&&"function"==typeof e[r-2])var n=_(e[--r-1],e[r--],2);else r>2&&"function"==typeof e[r-1]&&(n=e[--r]);for(var i=g(arguments,1,r),o=-1,s=h(),a=h();++o<r;)ee(t,i[o],n,s,a);return p(s),p(a),t}function Be(t,r,n){var i={};if("function"!=typeof r){var o=[];ai(t,function(t,e){o.push(e)}),o=G(o,Z(arguments,!0,!1,1));for(var s=-1,a=o.length;++s<a;){var u=o[s];i[u]=t[u]}}else r=e.createCallback(r,n,3),ai(t,function(t,e,n){r(t,e,n)||(i[e]=t)});return i}function De(t){for(var e=-1,r=ti(t),n=r.length,i=dn(n);++e<n;){var o=r[e];i[e]=[o,t[o]]}return i}function $e(t,r,n){var i={};if("function"!=typeof r)for(var o=-1,s=Z(arguments,!0,!1,1),a=Se(t)?s.length:0;++o<a;){var u=s[o];u in t&&(i[u]=t[u])}else r=e.createCallback(r,n,3),ai(t,function(t,e,n){r(t,e,n)&&(i[e]=t)});return i}function Ue(t,r,n,i){var o=Xn(t);if(null==n)if(o)n=[];else{var s=t&&t.constructor,a=s&&s.prototype;n=y(a)}return r&&(r=e.createCallback(r,i,4),(o?Ye:ui)(t,function(t,e,i){return r(n,t,e,i)})),n}function ze(t){for(var e=-1,r=ti(t),n=r.length,i=dn(n);++e<n;)i[e]=t[r[e]];return i}function He(t){for(var e=arguments,r=-1,n=Z(e,!0,!1,1),i=e[2]&&e[2][e[1]]===t?1:n.length,o=dn(i);++r<i;)o[r]=t[n[r]];return o}function We(t,e,r){var n=-1,i=ue(),o=t?t.length:0,s=!1;return r=(0>r?Wn(0,o+r):r)||0,Xn(t)?s=i(t,e,r)>-1:"number"==typeof o?s=(Pe(t)?t.indexOf(e,r):i(t,e,r))>-1:ui(t,function(t){return++n>=r?!(s=t===e):void 0}),s}function Qe(t,r,n){var i=!0;r=e.createCallback(r,n,3);var o=-1,s=t?t.length:0;if("number"==typeof s)for(;++o<s&&(i=!!r(t[o],o,t)););else ui(t,function(t,e,n){return i=!!r(t,e,n)});return i}function Ve(t,r,n){var i=[];r=e.createCallback(r,n,3);var o=-1,s=t?t.length:0;if("number"==typeof s)for(;++o<s;){var a=t[o];r(a,o,t)&&i.push(a)}else ui(t,function(t,e,n){r(t,e,n)&&i.push(t)});return i}function Ke(t,r,n){r=e.createCallback(r,n,3);var i=-1,o=t?t.length:0;if("number"!=typeof o){var s;return ui(t,function(t,e,n){return r(t,e,n)?(s=t,!1):void 0}),s}for(;++i<o;){var a=t[i];if(r(a,i,t))return a}}function Je(t,r,n){var i;return r=e.createCallback(r,n,3),Ge(t,function(t,e,n){return r(t,e,n)?(i=t,!1):void 0}),i}function Ye(t,e,r){var n=-1,i=t?t.length:0;if(e=e&&"undefined"==typeof r?e:_(e,r,3),"number"==typeof i)for(;++n<i&&e(t[n],n,t)!==!1;);else ui(t,e);return t}function Ge(t,e,r){var n=t?t.length:0;if(e=e&&"undefined"==typeof r?e:_(e,r,3),"number"==typeof n)for(;n--&&e(t[n],n,t)!==!1;);else{var i=ti(t);n=i.length,ui(t,function(t,r,o){return r=i?i[--n]:--n,e(o[r],r,o)})}return t}function Xe(t,e){var r=g(arguments,2),n=-1,i="function"==typeof e,o=t?t.length:0,s=dn("number"==typeof o?o:0);return Ye(t,function(t){s[++n]=(i?e:t[e]).apply(t,r)}),s}function Ze(t,r,n){var i=-1,o=t?t.length:0;if(r=e.createCallback(r,n,3),"number"==typeof o)for(var s=dn(o);++i<o;)s[i]=r(t[i],i,t);else s=[],ui(t,function(t,e,n){s[++i]=r(t,e,n)});return s}function tr(t,r,n){var i=-1/0,o=i;if("function"!=typeof r&&n&&n[r]===t&&(r=null),null==r&&Xn(t))for(var s=-1,u=t.length;++s<u;){var l=t[s];l>o&&(o=l)}else r=null==r&&Pe(t)?a:e.createCallback(r,n,3),Ye(t,function(t,e,n){var s=r(t,e,n);s>i&&(i=s,o=t)});return o}function er(t,r,n){var i=1/0,o=i;if("function"!=typeof r&&n&&n[r]===t&&(r=null),null==r&&Xn(t))for(var s=-1,u=t.length;++s<u;){var l=t[s];o>l&&(o=l)}else r=null==r&&Pe(t)?a:e.createCallback(r,n,3),Ye(t,function(t,e,n){var s=r(t,e,n);i>s&&(i=s,o=t)});return o}function rr(t,r,n,i){if(!t)return n;var o=arguments.length<3;r=e.createCallback(r,i,4);var s=-1,a=t.length;if("number"==typeof a)for(o&&(n=t[++s]);++s<a;)n=r(n,t[s],s,t);else ui(t,function(t,e,i){n=o?(o=!1,t):r(n,t,e,i)});return n}function nr(t,r,n,i){var o=arguments.length<3;return r=e.createCallback(r,i,4),Ge(t,function(t,e,i){n=o?(o=!1,t):r(n,t,e,i)}),n}function ir(t,r,n){return r=e.createCallback(r,n,3),Ve(t,function(t,e,n){return!r(t,e,n)})}function or(t,e,r){if(t&&"number"!=typeof t.length&&(t=ze(t)),null==e||r)return t?t[re(0,t.length-1)]:v;var n=sr(t);return n.length=Qn(Wn(0,e),n.length),n}function sr(t){var e=-1,r=t?t.length:0,n=dn("number"==typeof r?r:0);
return Ye(t,function(t){var r=re(0,++e);n[e]=n[r],n[r]=t}),n}function ar(t){var e=t?t.length:0;return"number"==typeof e?e:ti(t).length}function ur(t,r,n){var i;r=e.createCallback(r,n,3);var o=-1,s=t?t.length:0;if("number"==typeof s)for(;++o<s&&!(i=r(t[o],o,t)););else ui(t,function(t,e,n){return!(i=r(t,e,n))});return!!i}function lr(t,r,n){var i=-1,o=Xn(r),s=t?t.length:0,a=dn("number"==typeof s?s:0);for(o||(r=e.createCallback(r,n,3)),Ye(t,function(t,e,n){var s=a[++i]=f();o?s.criteria=Ze(r,function(e){return t[e]}):(s.criteria=h())[0]=r(t,e,n),s.index=i,s.value=t}),s=a.length,a.sort(u);s--;){var l=a[s];a[s]=l.value,o||p(l.criteria),d(l)}return a}function cr(t){return t&&"number"==typeof t.length?g(t):ze(t)}function hr(t){for(var e=-1,r=t?t.length:0,n=[];++e<r;){var i=t[e];i&&n.push(i)}return n}function fr(t){return G(t,Z(arguments,!0,!0,1))}function pr(t,r,n){var i=-1,o=t?t.length:0;for(r=e.createCallback(r,n,3);++i<o;)if(r(t[i],i,t))return i;return-1}function dr(t,r,n){var i=t?t.length:0;for(r=e.createCallback(r,n,3);i--;)if(r(t[i],i,t))return i;return-1}function gr(t,r,n){var i=0,o=t?t.length:0;if("number"!=typeof r&&null!=r){var s=-1;for(r=e.createCallback(r,n,3);++s<o&&r(t[s],s,t);)i++}else if(i=r,null==i||n)return t?t[0]:v;return g(t,0,Qn(Wn(0,i),o))}function mr(t,e,r,n){return"boolean"!=typeof e&&null!=e&&(n=r,r="function"!=typeof e&&n&&n[e]===t?null:e,e=!1),null!=r&&(t=Ze(t,r,n)),Z(t,e)}function vr(t,e,r){if("number"==typeof r){var n=t?t.length:0;r=0>r?Wn(0,n+r):r||0}else if(r){var o=Tr(t,e);return t[o]===e?o:-1}return i(t,e,r)}function yr(t,r,n){var i=0,o=t?t.length:0;if("number"!=typeof r&&null!=r){var s=o;for(r=e.createCallback(r,n,3);s--&&r(t[s],s,t);)i++}else i=null==r||n?1:r||i;return g(t,0,Qn(Wn(0,o-i),o))}function _r(){for(var t=[],e=-1,r=arguments.length,n=h(),s=ue(),a=s===i,u=h();++e<r;){var c=arguments[e];(Xn(c)||fe(c))&&(t.push(c),n.push(a&&c.length>=j&&l(e?t[e]:u)))}var f=t[0],g=-1,m=f?f.length:0,v=[];t:for(;++g<m;){var y=n[0];if(c=f[g],(y?o(y,c):s(u,c))<0){for(e=r,(y||u).push(c);--e;)if(y=n[e],(y?o(y,c):s(t[e],c))<0)continue t;v.push(c)}}for(;r--;)y=n[r],y&&d(y);return p(n),p(u),v}function br(t,r,n){var i=0,o=t?t.length:0;if("number"!=typeof r&&null!=r){var s=o;for(r=e.createCallback(r,n,3);s--&&r(t[s],s,t);)i++}else if(i=r,null==i||n)return t?t[o-1]:v;return g(t,Wn(0,o-i))}function wr(t,e,r){var n=t?t.length:0;for("number"==typeof r&&(n=(0>r?Wn(0,n+r):Qn(r,n-1))+1);n--;)if(t[n]===e)return n;return-1}function jr(t){for(var e=arguments,r=0,n=e.length,i=t?t.length:0;++r<n;)for(var o=-1,s=e[r];++o<i;)t[o]===s&&(Mn.call(t,o--,1),i--);return t}function xr(t,e,r){t=+t||0,r="number"==typeof r?r:+r||1,null==e&&(e=t,t=0);for(var n=-1,i=Wn(0,Cn((e-t)/(r||1))),o=dn(i);++n<i;)o[n]=t,t+=r;return o}function Er(t,r,n){var i=-1,o=t?t.length:0,s=[];for(r=e.createCallback(r,n,3);++i<o;){var a=t[i];r(a,i,t)&&(s.push(a),Mn.call(t,i--,1),o--)}return s}function kr(t,r,n){if("number"!=typeof r&&null!=r){var i=0,o=-1,s=t?t.length:0;for(r=e.createCallback(r,n,3);++o<s&&r(t[o],o,t);)i++}else i=null==r||n?1:Wn(0,r);return g(t,i)}function Tr(t,r,n,i){var o=0,s=t?t.length:o;for(n=n?e.createCallback(n,i,1):Gr,r=n(r);s>o;){var a=o+s>>>1;n(t[a])<r?o=a+1:s=a}return o}function Rr(){return ie(Z(arguments,!0,!0))}function Ar(t,r,n,i){return"boolean"!=typeof r&&null!=r&&(i=n,n="function"!=typeof r&&i&&i[r]===t?null:r,r=!1),null!=n&&(n=e.createCallback(n,i,3)),ie(t,r,n)}function Cr(t){return G(t,g(arguments,1))}function Sr(){for(var t=-1,e=arguments.length;++t<e;){var r=arguments[t];if(Xn(r)||fe(r))var n=n?ie(G(n,r).concat(G(r,n))):r}return n||[]}function Fr(){for(var t=arguments.length>1?arguments:arguments[0],e=-1,r=t?tr(pi(t,"length")):0,n=dn(0>r?0:r);++e<r;)n[e]=pi(t,e);return n}function Nr(t,e){var r=-1,n=t?t.length:0,i={};for(e||!n||Xn(t[0])||(e=[]);++r<n;){var o=t[r];e?i[o]=e[r]:o&&(i[o[0]]=o[1])}return i}function Or(t,e){if(!Ce(e))throw new xn;return function(){return--t<1?e.apply(this,arguments):void 0}}function Ir(t,e){return arguments.length>2?se(t,17,g(arguments,2),null,e):se(t,1,null,null,e)}function Pr(t){for(var e=arguments.length>1?Z(arguments,!0,!1,1):be(t),r=-1,n=e.length;++r<n;){var i=e[r];t[i]=se(t[i],1,null,null,t)}return t}function qr(t,e){return arguments.length>2?se(e,19,g(arguments,2),null,t):se(e,3,null,null,t)}function Mr(){for(var t=arguments,e=t.length;e--;)if(!Ce(t[e]))throw new xn;return function(){for(var e=arguments,r=t.length;r--;)e=[t[r].apply(this,e)];return e[0]}}function Lr(t,e){return e="number"==typeof e?e:+e||t.length,se(t,4,null,null,null,e)}function Br(t,e,r){var n,i,o,s,a,u,l,c=0,h=!1,f=!0;if(!Ce(t))throw new xn;if(e=Wn(0,e)||0,r===!0){var p=!0;f=!1}else Se(r)&&(p=r.leading,h="maxWait"in r&&(Wn(e,r.maxWait)||0),f="trailing"in r?r.trailing:f);var d=function(){var r=e-(gi()-s);if(0>=r){i&&Sn(i);var h=l;i=u=l=v,h&&(c=gi(),o=t.apply(a,n),u||i||(n=a=null))}else u=qn(d,r)},g=function(){u&&Sn(u),i=u=l=v,(f||h!==e)&&(c=gi(),o=t.apply(a,n),u||i||(n=a=null))};return function(){if(n=arguments,s=gi(),a=this,l=f&&(u||!p),h===!1)var r=p&&!u;else{i||p||(c=s);var m=h-(s-c),v=0>=m;v?(i&&(i=Sn(i)),c=s,o=t.apply(a,n)):i||(i=qn(g,m))}return v&&u?u=Sn(u):u||e===h||(u=qn(d,e)),r&&(v=!0,o=t.apply(a,n)),!v||u||i||(n=a=null),o}}function Dr(t){if(!Ce(t))throw new xn;var e=g(arguments,1);return qn(function(){t.apply(v,e)},1)}function $r(t,e){if(!Ce(t))throw new xn;var r=g(arguments,2);return qn(function(){t.apply(v,r)},e)}function Ur(t,e){if(!Ce(t))throw new xn;var r=function(){var n=r.cache,i=e?e.apply(this,arguments):w+arguments[0];return In.call(n,i)?n[i]:n[i]=t.apply(this,arguments)};return r.cache={},r}function zr(t){var e,r;if(!Ce(t))throw new xn;return function(){return e?r:(e=!0,r=t.apply(this,arguments),t=null,r)}}function Hr(t){return se(t,16,g(arguments,1))}function Wr(t){return se(t,32,null,g(arguments,1))}function Qr(t,e,r){var n=!0,i=!0;if(!Ce(t))throw new xn;return r===!1?n=!1:Se(r)&&(n="leading"in r?r.leading:n,i="trailing"in r?r.trailing:i),K.leading=n,K.maxWait=e,K.trailing=i,Br(t,e,K)}function Vr(t,e){return se(e,16,[t])}function Kr(t){return function(){return t}}function Jr(t,e,r){var n=typeof t;if(null==t||"function"==n)return _(t,e,r);if("object"!=n)return en(t);var i=ti(t),o=i[0],s=t[o];return 1!=i.length||s!==s||Se(s)?function(e){for(var r=i.length,n=!1;r--&&(n=te(e[i[r]],t[i[r]],null,!0)););return n}:function(t){var e=t[o];return s===e&&(0!==s||1/s==1/e)}}function Yr(t){return null==t?"":jn(t).replace(ii,ae)}function Gr(t){return t}function Xr(t,n,i){var o=!0,s=n&&be(n);n&&(i||s.length)||(null==i&&(i=n),a=r,n=t,t=e,s=be(n)),i===!1?o=!1:Se(i)&&"chain"in i&&(o=i.chain);var a=t,u=Ce(a);Ye(s,function(e){var r=t[e]=n[e];u&&(a.prototype[e]=function(){var e=this.__chain__,n=this.__wrapped__,i=[n];Pn.apply(i,arguments);var s=r.apply(t,i);if(o||e){if(n===s&&Se(s))return this;s=new a(s),s.__chain__=e}return s})})}function Zr(){return t._=Tn,this}function tn(){}function en(t){return function(e){return e[t]}}function rn(t,e,r){var n=null==t,i=null==e;if(null==r&&("boolean"==typeof t&&i?(r=t,t=1):i||"boolean"!=typeof e||(r=e,i=!0)),n&&i&&(e=1),t=+t||0,i?(e=t,t=0):e=+e||0,r||t%1||e%1){var o=Kn();return Qn(t+o*(e-t+parseFloat("1e-"+((o+"").length-1))),e)}return re(t,e)}function nn(t,e){if(t){var r=t[e];return Ce(r)?t[e]():r}}function on(t,r,n){var i=e.templateSettings;t=jn(t||""),n=si({},n,i);var o,s=si({},n.imports,i.imports),a=ti(s),u=ze(s),l=0,h=n.interpolate||O,f="__p += '",p=wn((n.escape||O).source+"|"+h.source+"|"+(h===F?A:O).source+"|"+(n.evaluate||O).source+"|$","g");t.replace(p,function(e,r,n,i,s,a){return n||(n=i),f+=t.slice(l,a).replace(P,c),r&&(f+="' +\n__e("+r+") +\n'"),s&&(o=!0,f+="';\n"+s+";\n__p += '"),n&&(f+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),l=a+e.length,e}),f+="';\n";var d=n.variable,g=d;g||(d="obj",f="with ("+d+") {\n"+f+"\n}\n"),f=(o?f.replace(k,""):f).replace(T,"$1").replace(R,"$1;"),f="function("+d+") {\n"+(g?"":d+" || ("+d+" = {});\n")+"var __t, __p = '', __e = _.escape"+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var m="\n/*\n//# sourceURL="+(n.sourceURL||"/lodash/template/source["+M++ +"]")+"\n*/";try{var y=vn(a,"return "+f+m).apply(v,u)}catch(_){throw _.source=f,_}return r?y(r):(y.source=f,y)}function sn(t,e,r){t=(t=+t)>-1?t:0;var n=-1,i=dn(t);for(e=_(e,r,1);++n<t;)i[n]=e(n);return i}function an(t){return null==t?"":jn(t).replace(ni,he)}function un(t){var e=++b;return jn(null==t?"":t)+e}function ln(t){return t=new r(t),t.__chain__=!0,t}function cn(t,e){return e(t),t}function hn(){return this.__chain__=!0,this}function fn(){return jn(this.__wrapped__)}function pn(){return this.__wrapped__}t=t?ne.defaults(X.Object(),t,ne.pick(X,q)):X;var dn=t.Array,gn=t.Boolean,mn=t.Date,vn=t.Function,yn=t.Math,_n=t.Number,bn=t.Object,wn=t.RegExp,jn=t.String,xn=t.TypeError,En=[],kn=bn.prototype,Tn=t._,Rn=kn.toString,An=wn("^"+jn(Rn).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Cn=yn.ceil,Sn=t.clearTimeout,Fn=yn.floor,Nn=vn.prototype.toString,On=le(On=bn.getPrototypeOf)&&On,In=kn.hasOwnProperty,Pn=En.push,qn=t.setTimeout,Mn=En.splice,Ln=En.unshift,Bn=function(){try{var t={},e=le(e=bn.defineProperty)&&e,r=e(t,t,t)&&e}catch(n){}return r}(),Dn=le(Dn=bn.create)&&Dn,$n=le($n=dn.isArray)&&$n,Un=t.isFinite,zn=t.isNaN,Hn=le(Hn=bn.keys)&&Hn,Wn=yn.max,Qn=yn.min,Vn=t.parseInt,Kn=yn.random,Jn={};Jn[B]=dn,Jn[D]=gn,Jn[$]=mn,Jn[U]=vn,Jn[H]=bn,Jn[z]=_n,Jn[W]=wn,Jn[Q]=jn,r.prototype=e.prototype;var Yn=e.support={};Yn.funcDecomp=!le(t.WinRTError)&&I.test(m),Yn.funcNames="string"==typeof vn.name,e.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:F,variable:"",imports:{_:e}},Dn||(y=function(){function e(){}return function(r){if(Se(r)){e.prototype=r;var n=new e;e.prototype=null}return n||t.Object()}}());var Gn=Bn?function(t,e){J.value=e,Bn(t,"__bindData__",J)}:tn,Xn=$n||function(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Rn.call(t)==B||!1},Zn=function(t){var e,r=t,n=[];if(!r)return n;if(!Y[typeof t])return n;for(e in r)In.call(r,e)&&n.push(e);return n},ti=Hn?function(t){return Se(t)?Hn(t):[]}:Zn,ei={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ri=je(ei),ni=wn("("+ti(ri).join("|")+")","g"),ii=wn("["+ti(ei).join("")+"]","g"),oi=function(t,e,r){var n,i=t,o=i;if(!i)return o;var s=arguments,a=0,u="number"==typeof r?2:s.length;if(u>3&&"function"==typeof s[u-2])var l=_(s[--u-1],s[u--],2);else u>2&&"function"==typeof s[u-1]&&(l=s[--u]);for(;++a<u;)if(i=s[a],i&&Y[typeof i])for(var c=-1,h=Y[typeof i]&&ti(i),f=h?h.length:0;++c<f;)n=h[c],o[n]=l?l(o[n],i[n]):i[n];return o},si=function(t,e,r){var n,i=t,o=i;if(!i)return o;for(var s=arguments,a=0,u="number"==typeof r?2:s.length;++a<u;)if(i=s[a],i&&Y[typeof i])for(var l=-1,c=Y[typeof i]&&ti(i),h=c?c.length:0;++l<h;)n=c[l],"undefined"==typeof o[n]&&(o[n]=i[n]);return o},ai=function(t,e,r){var n,i=t,o=i;if(!i)return o;if(!Y[typeof i])return o;e=e&&"undefined"==typeof r?e:_(e,r,3);for(n in i)if(e(i[n],n,t)===!1)return o;return o},ui=function(t,e,r){var n,i=t,o=i;if(!i)return o;if(!Y[typeof i])return o;e=e&&"undefined"==typeof r?e:_(e,r,3);for(var s=-1,a=Y[typeof i]&&ti(i),u=a?a.length:0;++s<u;)if(n=a[s],e(i[n],n,t)===!1)return o;return o},li=On?function(t){if(!t||Rn.call(t)!=H)return!1;var e=t.valueOf,r=le(e)&&(r=On(e))&&On(r);return r?t==r||On(t)==r:ce(t)}:ce,ci=oe(function(t,e,r){In.call(t,r)?t[r]++:t[r]=1}),hi=oe(function(t,e,r){(In.call(t,r)?t[r]:t[r]=[]).push(e)}),fi=oe(function(t,e,r){t[r]=e}),pi=Ze,di=Ve,gi=le(gi=mn.now)&&gi||function(){return(new mn).getTime()},mi=8==Vn(E+"08")?Vn:function(t,e){return Vn(Pe(t)?t.replace(N,""):t,e||0)};return e.after=Or,e.assign=oi,e.at=He,e.bind=Ir,e.bindAll=Pr,e.bindKey=qr,e.chain=ln,e.compact=hr,e.compose=Mr,e.constant=Kr,e.countBy=ci,e.create=ge,e.createCallback=Jr,e.curry=Lr,e.debounce=Br,e.defaults=si,e.defer=Dr,e.delay=$r,e.difference=fr,e.filter=Ve,e.flatten=mr,e.forEach=Ye,e.forEachRight=Ge,e.forIn=ai,e.forInRight=ye,e.forOwn=ui,e.forOwnRight=_e,e.functions=be,e.groupBy=hi,e.indexBy=fi,e.initial=yr,e.intersection=_r,e.invert=je,e.invoke=Xe,e.keys=ti,e.map=Ze,e.mapValues=Me,e.max=tr,e.memoize=Ur,e.merge=Le,e.min=er,e.omit=Be,e.once=zr,e.pairs=De,e.partial=Hr,e.partialRight=Wr,e.pick=$e,e.pluck=pi,e.property=en,e.pull=jr,e.range=xr,e.reject=ir,e.remove=Er,e.rest=kr,e.shuffle=sr,e.sortBy=lr,e.tap=cn,e.throttle=Qr,e.times=sn,e.toArray=cr,e.transform=Ue,e.union=Rr,e.uniq=Ar,e.values=ze,e.where=di,e.without=Cr,e.wrap=Vr,e.xor=Sr,e.zip=Fr,e.zipObject=Nr,e.collect=Ze,e.drop=kr,e.each=Ye,e.eachRight=Ge,e.extend=oi,e.methods=be,e.object=Nr,e.select=Ve,e.tail=kr,e.unique=Ar,e.unzip=Fr,Xr(e),e.clone=pe,e.cloneDeep=de,e.contains=We,e.escape=Yr,e.every=Qe,e.find=Ke,e.findIndex=pr,e.findKey=me,e.findLast=Je,e.findLastIndex=dr,e.findLastKey=ve,e.has=we,e.identity=Gr,e.indexOf=vr,e.isArguments=fe,e.isArray=Xn,e.isBoolean=xe,e.isDate=Ee,e.isElement=ke,e.isEmpty=Te,e.isEqual=Re,e.isFinite=Ae,e.isFunction=Ce,e.isNaN=Fe,e.isNull=Ne,e.isNumber=Oe,e.isObject=Se,e.isPlainObject=li,e.isRegExp=Ie,e.isString=Pe,e.isUndefined=qe,e.lastIndexOf=wr,e.mixin=Xr,e.noConflict=Zr,e.noop=tn,e.now=gi,e.parseInt=mi,e.random=rn,e.reduce=rr,e.reduceRight=nr,e.result=nn,e.runInContext=m,e.size=ar,e.some=ur,e.sortedIndex=Tr,e.template=on,e.unescape=an,e.uniqueId=un,e.all=Qe,e.any=ur,e.detect=Ke,e.findWhere=Ke,e.foldl=rr,e.foldr=nr,e.include=We,e.inject=rr,Xr(function(){var t={};return ui(e,function(r,n){e.prototype[n]||(t[n]=r)}),t}(),!1),e.first=gr,e.last=br,e.sample=or,e.take=gr,e.head=gr,ui(e,function(t,n){var i="sample"!==n;e.prototype[n]||(e.prototype[n]=function(e,n){var o=this.__chain__,s=t(this.__wrapped__,e,n);return o||null!=e&&(!n||i&&"function"==typeof e)?new r(s,o):s})}),e.VERSION="2.4.1",e.prototype.chain=hn,e.prototype.toString=fn,e.prototype.value=pn,e.prototype.valueOf=pn,Ye(["join","pop","shift"],function(t){var n=En[t];e.prototype[t]=function(){var t=this.__chain__,e=n.apply(this.__wrapped__,arguments);return t?new r(e,t):e}}),Ye(["push","reverse","sort","unshift"],function(t){var r=En[t];e.prototype[t]=function(){return r.apply(this.__wrapped__,arguments),this}}),Ye(["concat","slice","splice"],function(t){var n=En[t];e.prototype[t]=function(){return new r(n.apply(this.__wrapped__,arguments),this.__chain__)}}),e}var v,y=[],_=[],b=0,w=+new Date+"",j=75,x=40,E=" 	\f\n\r\u2028\u2029",k=/\b__p \+= '';/g,T=/\b(__p \+=) '' \+/g,R=/(__e\(.*?\)|\b__t\)) \+\n'';/g,A=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,C=/\w*$/,S=/^\s*function[ \n\r\t]+\w/,F=/<%=([\s\S]+?)%>/g,N=RegExp("^["+E+"]*0+(?=.$)"),O=/($^)/,I=/\bthis\b/,P=/['\n\r\t\u2028\u2029\\]/g,q=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],M=0,L="[object Arguments]",B="[object Array]",D="[object Boolean]",$="[object Date]",U="[object Function]",z="[object Number]",H="[object Object]",W="[object RegExp]",Q="[object String]",V={};V[U]=!1,V[L]=V[B]=V[D]=V[$]=V[z]=V[H]=V[W]=V[Q]=!0;var K={leading:!1,maxWait:0,trailing:!1},J={configurable:!1,enumerable:!1,value:null,writable:!1},Y={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},G={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},X=Y[typeof window]&&window||this,Z=Y[typeof n]&&n&&!n.nodeType&&n,te=Y[typeof r]&&r&&!r.nodeType&&r,ee=te&&te.exports===Z&&Z,re=Y[typeof e]&&e;!re||re.global!==re&&re.window!==re||(X=re);var ne=m();"function"==typeof t&&"object"==typeof t.amd&&t.amd?(X._=ne,t(function(){return ne})):Z&&te?ee?(te.exports=ne)._=ne:Z._=ne:X._=ne}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],131:[function(e,r,n){!function(e){function n(t,e){var r=e?U[oe]:U[re];return r.test(t)?new s(t,e):null}function i(t,e){var r=n(t,e);return r?r.version:null}function o(t,e){var r=n(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null}function s(t,e){if(t instanceof s){if(t.loose===e)return t;t=t.version}else if("string"!=typeof t)throw new TypeError("Invalid Version: "+t);if(!(this instanceof s))return new s(t,e);this.loose=e;var r=t.trim().match(e?U[oe]:U[re]);if(!r)throw new TypeError("Invalid Version: "+t);this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.prerelease=r[4]?r[4].split(".").map(function(t){return/^[0-9]+$/.test(t)?+t:t}):[],this.build=r[5]?r[5].split("."):[],this.format()}function a(t,e,r,n){"string"==typeof r&&(n=r,r=void 0);try{return new s(t,r).inc(e,n).version}catch(i){return null}}function u(t,e){var r=Fe.test(t),n=Fe.test(e);return r&&n&&(t=+t,e=+e),r&&!n?-1:n&&!r?1:e>t?-1:t>e?1:0}function l(t,e){return u(e,t)}function c(t,e,r){return new s(t,r).compare(e)}function h(t,e){return c(t,e,!0)}function f(t,e,r){return c(e,t,r)}function p(t,r){return t.sort(function(t,n){return e.compare(t,n,r)})}function d(t,r){return t.sort(function(t,n){return e.rcompare(t,n,r)})}function g(t,e,r){return c(t,e,r)>0}function m(t,e,r){return c(t,e,r)<0}function v(t,e,r){return 0===c(t,e,r)}function y(t,e,r){return 0!==c(t,e,r)}function _(t,e,r){return c(t,e,r)>=0}function b(t,e,r){return c(t,e,r)<=0}function w(t,e,r,n){var i;switch(e){case"===":"object"==typeof t&&(t=t.version),"object"==typeof r&&(r=r.version),i=t===r;break;case"!==":"object"==typeof t&&(t=t.version),"object"==typeof r&&(r=r.version),i=t!==r;break;case"":case"=":case"==":i=v(t,r,n);break;case"!=":i=y(t,r,n);break;case">":i=g(t,r,n);break;case">=":i=_(t,r,n);break;case"<":i=m(t,r,n);break;case"<=":i=b(t,r,n);break;default:throw new TypeError("Invalid operator: "+e)}return i}function j(t,e){if(t instanceof j){if(t.loose===e)return t;t=t.value}return this instanceof j?(this.loose=e,this.parse(t),void(this.value=this.semver===Ne?"":this.operator+this.semver.version)):new j(t,e)}function x(t,e){if(t instanceof x&&t.loose===e)return t;if(!(this instanceof x))return new x(t,e);if(this.loose=e,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(function(t){return this.parseRange(t.trim())},this).filter(function(t){return t.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+t);this.format()}function E(t,e){return new x(t,e).set.map(function(t){return t.map(function(t){return t.value}).join(" ").trim().split(" ")})}function k(t,e){return t=C(t,e),t=R(t,e),t=F(t,e),t=O(t,e)}function T(t){return!t||"x"===t.toLowerCase()||"*"===t}function R(t,e){return t.trim().split(/\s+/).map(function(t){return A(t,e)}).join(" ")}function A(t,e){var r=e?U[ve]:U[me];return t.replace(r,function(t,e,r,n,i){var o;return T(e)?o="":T(r)?o=">="+e+".0.0 <"+(+e+1)+".0.0":T(n)?o=">="+e+"."+r+".0 <"+e+"."+(+r+1)+".0":i?("-"!==i.charAt(0)&&(i="-"+i),o=">="+e+"."+r+"."+n+i+" <"+e+"."+(+r+1)+".0"):o=">="+e+"."+r+"."+n+" <"+e+"."+(+r+1)+".0",o})}function C(t,e){return t.trim().split(/\s+/).map(function(t){return S(t,e)}).join(" ")}function S(t,e){var r=e?U[je]:U[we];return t.replace(r,function(t,e,r,n,i){var o;return T(e)?o="":T(r)?o=">="+e+".0.0 <"+(+e+1)+".0.0":T(n)?o="0"===e?">="+e+"."+r+".0 <"+e+"."+(+r+1)+".0":">="+e+"."+r+".0 <"+(+e+1)+".0.0":i?("-"!==i.charAt(0)&&(i="-"+i),o="0"===e?"0"===r?">="+e+"."+r+"."+n+i+" <"+e+"."+r+"."+(+n+1):">="+e+"."+r+"."+n+i+" <"+e+"."+(+r+1)+".0":">="+e+"."+r+"."+n+i+" <"+(+e+1)+".0.0"):o="0"===e?"0"===r?">="+e+"."+r+"."+n+" <"+e+"."+r+"."+(+n+1):">="+e+"."+r+"."+n+" <"+e+"."+(+r+1)+".0":">="+e+"."+r+"."+n+" <"+(+e+1)+".0.0",o})}function F(t,e){return t.split(/\s+/).map(function(t){return N(t,e)}).join(" ")}function N(t,e){t=t.trim();var r=e?U[fe]:U[he];return t.replace(r,function(t,e,r,n,i){var o=T(r),s=o||T(n),a=s||T(i),u=a;return"="===e&&u&&(e=""),o?t=">"===e||"<"===e?"<0.0.0":"*":e&&u?(s&&(n=0),a&&(i=0),">"===e?(e=">=",s?(r=+r+1,n=0,i=0):a&&(n=+n+1,i=0)):"<="===e&&(e="<",s?r=+r+1:n=+n+1),t=e+r+"."+n+"."+i):s?t=">="+r+".0.0 <"+(+r+1)+".0.0":a&&(t=">="+r+"."+n+".0 <"+r+"."+(+n+1)+".0"),t})}function O(t){return t.trim().replace(U[Ce],"")}function I(t,e,r,n,i,o,s,a,u,l,c,h){return e=T(r)?"":T(n)?">="+r+".0.0":T(i)?">="+r+"."+n+".0":">="+e,a=T(u)?"":T(l)?"<"+(+u+1)+".0.0":T(c)?"<"+u+"."+(+l+1)+".0":h?"<="+u+"."+l+"."+c+"-"+h:"<="+a,(e+" "+a).trim()}function P(t,e){for(var r=0;r<t.length;r++)if(!t[r].test(e))return!1;if(e.prerelease.length){for(var r=0;r<t.length;r++){if(t[r].semver===Ne)return!0;if(t[r].semver.prerelease.length>0){var n=t[r].semver;if(n.major===e.major&&n.minor===e.minor&&n.patch===e.patch)return!0}}return!1}return!0}function q(t,e,r){try{e=new x(e,r)}catch(n){return!1}return e.test(t)}function M(t,e,r){return t.filter(function(t){return q(t,e,r)}).sort(function(t,e){return f(t,e,r)})[0]||null}function L(t,e){try{return new x(t,e).range||"*"}catch(r){return null}}function B(t,e,r){return $(t,e,"<",r)}function D(t,e,r){return $(t,e,">",r)}function $(t,e,r,n){t=new s(t,n),e=new x(e,n);var i,o,a,u,l;switch(r){case">":i=g,o=b,a=m,u=">",l=">=";break;case"<":i=m,o=_,a=g,u="<",l="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(q(t,e,n))return!1;for(var c=0;c<e.set.length;++c){var h=e.set[c],f=null,p=null;if(h.forEach(function(t){f=f||t,p=p||t,i(t.semver,f.semver,n)?f=t:a(t.semver,p.semver,n)&&(p=t)}),f.operator===u||f.operator===l)return!1;if((!p.operator||p.operator===u)&&o(t,p.semver))return!1;if(p.operator===l&&a(t,p.semver))return!1}return!0}"object"==typeof r&&r.exports===e&&(e=r.exports=s),e.SEMVER_SPEC_VERSION="2.0.0";var U=e.re=[],z=e.src=[],H=0,W=H++;z[W]="0|[1-9]\\d*";var Q=H++;z[Q]="[0-9]+";var V=H++;z[V]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var K=H++;z[K]="("+z[W]+")\\.("+z[W]+")\\.("+z[W]+")";var J=H++;z[J]="("+z[Q]+")\\.("+z[Q]+")\\.("+z[Q]+")";var Y=H++;z[Y]="(?:"+z[W]+"|"+z[V]+")";var G=H++;z[G]="(?:"+z[Q]+"|"+z[V]+")";var X=H++;z[X]="(?:-("+z[Y]+"(?:\\."+z[Y]+")*))";var Z=H++;z[Z]="(?:-?("+z[G]+"(?:\\."+z[G]+")*))";var te=H++;z[te]="[0-9A-Za-z-]+";var ee=H++;z[ee]="(?:\\+("+z[te]+"(?:\\."+z[te]+")*))";var re=H++,ne="v?"+z[K]+z[X]+"?"+z[ee]+"?";z[re]="^"+ne+"$";var ie="[v=\\s]*"+z[J]+z[Z]+"?"+z[ee]+"?",oe=H++;z[oe]="^"+ie+"$";var se=H++;z[se]="((?:<|>)?=?)";var ae=H++;z[ae]=z[Q]+"|x|X|\\*";var ue=H++;z[ue]=z[W]+"|x|X|\\*";var le=H++;z[le]="[v=\\s]*("+z[ue]+")(?:\\.("+z[ue]+")(?:\\.("+z[ue]+")(?:"+z[X]+")?"+z[ee]+"?)?)?";var ce=H++;z[ce]="[v=\\s]*("+z[ae]+")(?:\\.("+z[ae]+")(?:\\.("+z[ae]+")(?:"+z[Z]+")?"+z[ee]+"?)?)?";var he=H++;z[he]="^"+z[se]+"\\s*"+z[le]+"$";var fe=H++;z[fe]="^"+z[se]+"\\s*"+z[ce]+"$";var pe=H++;z[pe]="(?:~>?)";var de=H++;z[de]="(\\s*)"+z[pe]+"\\s+",U[de]=new RegExp(z[de],"g");var ge="$1~",me=H++;z[me]="^"+z[pe]+z[le]+"$";var ve=H++;z[ve]="^"+z[pe]+z[ce]+"$";var ye=H++;z[ye]="(?:\\^)";var _e=H++;z[_e]="(\\s*)"+z[ye]+"\\s+",U[_e]=new RegExp(z[_e],"g");var be="$1^",we=H++;z[we]="^"+z[ye]+z[le]+"$";var je=H++;z[je]="^"+z[ye]+z[ce]+"$";var xe=H++;z[xe]="^"+z[se]+"\\s*("+ie+")$|^$";var Ee=H++;z[Ee]="^"+z[se]+"\\s*("+ne+")$|^$";var ke=H++;z[ke]="(\\s*)"+z[se]+"\\s*("+ie+"|"+z[le]+")",U[ke]=new RegExp(z[ke],"g");var Te="$1$2$3",Re=H++;z[Re]="^\\s*("+z[le]+")\\s+-\\s+("+z[le]+")\\s*$";var Ae=H++;z[Ae]="^\\s*("+z[ce]+")\\s+-\\s+("+z[ce]+")\\s*$";var Ce=H++;z[Ce]="(<|>)?=?\\s*\\*";for(var Se=0;H>Se;Se++)U[Se]||(U[Se]=new RegExp(z[Se]));e.parse=n,e.valid=i,e.clean=o,e.SemVer=s,s.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},s.prototype.inspect=function(){return'<SemVer "'+this+'">'},s.prototype.toString=function(){return this.version},s.prototype.compare=function(t){return t instanceof s||(t=new s(t,this.loose)),this.compareMain(t)||this.comparePre(t)},s.prototype.compareMain=function(t){return t instanceof s||(t=new s(t,this.loose)),u(this.major,t.major)||u(this.minor,t.minor)||u(this.patch,t.patch)},s.prototype.comparePre=function(t){if(t instanceof s||(t=new s(t,this.loose)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var e=0;do{var r=this.prerelease[e],n=t.prerelease[e];if(void 0===r&&void 0===n)return 0;if(void 0===n)return 1;if(void 0===r)return-1;if(r!==n)return u(r,n)}while(++e)},s.prototype.inc=function(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",e),this.inc("pre",e);break;case"major":(0!==this.minor||0!==this.patch||0===this.prerelease.length)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(0!==this.patch||0===this.prerelease.length)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);-1===r&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+t)}return this.format(),this},e.inc=a,e.compareIdentifiers=u;var Fe=/^[0-9]+$/;e.rcompareIdentifiers=l,e.compare=c,e.compareLoose=h,e.rcompare=f,e.sort=p,e.rsort=d,e.gt=g,e.lt=m,e.eq=v,e.neq=y,e.gte=_,e.lte=b,e.cmp=w,e.Comparator=j;var Ne={};j.prototype.parse=function(t){var e=this.loose?U[xe]:U[Ee],r=t.match(e);if(!r)throw new TypeError("Invalid comparator: "+t);this.operator=r[1],"="===this.operator&&(this.operator=""),this.semver=r[2]?new s(r[2],this.loose):Ne},j.prototype.inspect=function(){return'<SemVer Comparator "'+this+'">'},j.prototype.toString=function(){return this.value},j.prototype.test=function(t){return this.semver===Ne?!0:("string"==typeof t&&(t=new s(t,this.loose)),w(t,this.operator,this.semver,this.loose))},e.Range=x,x.prototype.inspect=function(){return'<SemVer Range "'+this.range+'">'},x.prototype.format=function(){return this.range=this.set.map(function(t){return t.join(" ").trim()}).join("||").trim(),this.range},x.prototype.toString=function(){return this.range},x.prototype.parseRange=function(t){var e=this.loose;t=t.trim();var r=e?U[Ae]:U[Re];t=t.replace(r,I),t=t.replace(U[ke],Te),t=t.replace(U[de],ge),t=t.replace(U[_e],be),t=t.split(/\s+/).join(" ");var n=e?U[xe]:U[Ee],i=t.split(" ").map(function(t){return k(t,e)}).join(" ").split(/\s+/);return this.loose&&(i=i.filter(function(t){return!!t.match(n)})),i=i.map(function(t){return new j(t,e)})},e.toComparators=E,x.prototype.test=function(t){if(!t)return!1;"string"==typeof t&&(t=new s(t,this.loose));for(var e=0;e<this.set.length;e++)if(P(this.set[e],t))return!0;return!1},e.satisfies=q,e.maxSatisfying=M,e.validRange=L,e.ltr=B,e.gtr=D,e.outside=$,"function"==typeof t&&t.amd&&t(e)}("object"==typeof n?n:"function"==typeof t&&t.amd?{}:semver={})},{}],132:[function(t,e){var r=t("lodash"),n=function(){};e.exports=function(t,e){var i,o=this;return i=t&&t.hasOwnProperty("constructor")?t.constructor:function(){o.apply(this,arguments)},r.extend(i,o),n.prototype=o.prototype,i.prototype=new n,t&&r.extend(i.prototype,t),e&&r.extend(i,e),i.prototype.constructor=i,"function"==typeof o.extended&&o.extended(i),i.__super__=o.prototype,i}},{lodash:130}],133:[function(e,r,n){!function(e,i){"object"==typeof n?r.exports=i:"function"==typeof t&&t.amd?t("trigger-then",[],function(){return i}):e["trigger-then"]=i}(this,function(t,e){var r=t.Events,n=Array.prototype.push,i=Array.prototype.slice,o=/\s+/,s=function(t,e){var r,n=-1,i=t.length,o=e[0],s=e[1],a=e[2],u=[];switch(e.length){case 0:for(;++n<i;)u.push((r=t[n]).callback.call(r.ctx));return u;case 1:for(;++n<i;)u.push((r=t[n]).callback.call(r.ctx,o));return u;case 2:for(;++n<i;)u.push((r=t[n]).callback.call(r.ctx,o,s));return u;case 3:for(;++n<i;)u.push((r=t[n]).callback.call(r.ctx,o,s,a));return u;default:for(;++n<i;)u.push((r=t[n]).callback.apply(r.ctx,e));return u}},a=r.triggerThen=function(t){if(!this._events)return e.all([]);var r,u=i.call(arguments,1),l=[];if(o.test(t)){for(var c=t.split(o),h=0,f=c.length;f>h;h++)n.call(l,a.apply(this,[c[h]].concat(u)));return e.all(l)}r=this._events[t];var p=this._events.all;try{r&&n.apply(l,s(r,u)),p&&n.apply(l,s(p,arguments))}catch(d){return e.reject(d)}return e.all(l)};t.triggerThen=a;for(var u=["Model","Collection","Router","View","History"],l=0,c=u.length;c>l;l++)t[u[l]].prototype.triggerThen=a})},{}]},{},[1])(1)});